<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>发布 CodeLab Adapter 3.2 - 某行人</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="种瓜" /><meta name="description" content=" Playful Programming Centre
 前言 距离 CodeLab Adapter 3.0 发布过去了 3 周有余，期间收到许多用户的邮件反馈，大家热心给出了改进建议和 bug 报告。
这段期间，根据大家的反馈迭代了若干个小版本，也为一些用户单独构建了一些版本，以服务于他们独特的用途。
3.2 是一个大版本，汇集了我们这段时间来的所有改进。
" /><meta name="keywords" content="education, programming, Technology" />






<meta name="generator" content="Hugo 0.56.3 with theme even" />


<link rel="canonical" href="https://blog.just4fun.site/post/%E9%9A%8F%E7%AC%94/codelab-adapter-3-2/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="发布 CodeLab Adapter 3.2" />
<meta property="og:description" content="


Playful Programming Centre


前言

距离 CodeLab Adapter 3.0 发布过去了 3 周有余，期间收到许多用户的邮件反馈，大家热心给出了改进建议和 bug 报告。

这段期间，根据大家的反馈迭代了若干个小版本，也为一些用户单独构建了一些版本，以服务于他们独特的用途。

3.2 是一个大版本，汇集了我们这段时间来的所有改进。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.just4fun.site/post/%E9%9A%8F%E7%AC%94/codelab-adapter-3-2/" />
<meta property="article:published_time" content="2020-05-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-05-10T00:00:00+00:00" />
<meta itemprop="name" content="发布 CodeLab Adapter 3.2">
<meta itemprop="description" content="


Playful Programming Centre


前言

距离 CodeLab Adapter 3.0 发布过去了 3 周有余，期间收到许多用户的邮件反馈，大家热心给出了改进建议和 bug 报告。

这段期间，根据大家的反馈迭代了若干个小版本，也为一些用户单独构建了一些版本，以服务于他们独特的用途。

3.2 是一个大版本，汇集了我们这段时间来的所有改进。">


<meta itemprop="datePublished" content="2020-05-10T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-05-10T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="4021">



<meta itemprop="keywords" content="codelab," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="发布 CodeLab Adapter 3.2"/>
<meta name="twitter:description" content="


Playful Programming Centre


前言

距离 CodeLab Adapter 3.0 发布过去了 3 周有余，期间收到许多用户的邮件反馈，大家热心给出了改进建议和 bug 报告。

这段期间，根据大家的反馈迭代了若干个小版本，也为一些用户单独构建了一些版本，以服务于他们独特的用途。

3.2 是一个大版本，汇集了我们这段时间来的所有改进。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">某行人</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/post/%E9%9A%8F%E7%AC%94/aboutme/">
        <li class="mobile-menu-item">About-Me</li>
      </a><a href="/post/%E9%9A%8F%E7%AC%94/join-us/">
        <li class="mobile-menu-item">Join-Us</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">某行人</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/%E9%9A%8F%E7%AC%94/aboutme/">About-Me</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/%E9%9A%8F%E7%AC%94/join-us/">Join-Us</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">发布 CodeLab Adapter 3.2</h1>

      <div class="post-meta">
        <span class="post-time"> 2020-05-10 </span>
        <div class="post-category">
            <a href="/categories/codelab/"> codelab </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
<ul>
<li><a href="#前言">前言</a></li>
<li><a href="#先睹为快">先睹为快</a>
<ul>
<li><a href="#新增扩展">新增扩展</a>
<ul>
<li><a href="#stage-https-adapter-codelab-club-extension-guide-stage"><a href="https://adapter.codelab.club/extension_guide/stage/">Stage</a></a></li>
<li><a href="#raspberrypi-gpio-https-adapter-codelab-club-extension-guide-rpi-gpio"><a href="https://adapter.codelab.club/extension_guide/rpi_gpio/">RaspberryPi GPIO</a></a></li>
<li><a href="#minecraft-https-adapter-codelab-club-extension-guide-minecraft"><a href="https://adapter.codelab.club/extension_guide/minecraft/">Minecraft</a></a></li>
<li><a href="#mqtt-broker-https-adapter-codelab-club-extension-guide-mqtt-broker"><a href="https://adapter.codelab.club/extension_guide/MQTT_Broker/">MQTT Broker</a></a></li>
<li><a href="#mqtt-adapter-https-adapter-codelab-club-extension-guide-mqtt-adapter"><a href="https://adapter.codelab.club/extension_guide/MQTT_adapter/">MQTT Adapter</a></a></li>
<li><a href="#calypso-https-adapter-codelab-club-extension-guide-calypso"><a href="https://adapter.codelab.club/extension_guide/Calypso/">Calypso</a></a></li>
</ul></li>
<li><a href="#让连接无处不在">让连接无处不在</a></li>
<li><a href="#提升-windows-平台的使用体验">提升 Windows 平台的使用体验</a></li>
<li><a href="#增加自省能力">增加自省能力</a></li>
<li><a href="#完善插件体系">完善插件体系</a>
<ul>
<li><a href="#插件市场">插件市场</a></li>
<li><a href="#可扩展的插件-meta-信息">可扩展的插件 Meta 信息</a></li>
</ul></li>
</ul></li>
<li><a href="#其他改进">其他改进</a></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><img src="https://adapter.codelab.club/img/42b96f90be7f9884c9702fc5cd5279fb.png" alt="" /></p>

<blockquote>
<p>Playful Programming Centre</p>
</blockquote>

<h1 id="前言">前言</h1>

<p>距离 <a href="https://www.codelab.club/blog/3-release/">CodeLab Adapter 3.0 发布</a>过去了 3 周有余，期间收到许多用户的邮件反馈，大家热心给出了改进建议和 bug 报告。</p>

<p>这段期间，根据大家的反馈迭代了若干个小版本，也为一些用户单独构建了一些版本，以服务于他们独特的用途。</p>

<p>3.2 是一个大版本，汇集了我们这段时间来的所有改进。</p>

<p>今后，每当发布大版本，我们会在博客里发一篇文章说明重大变更。(沿袭 <a href="https://open.edx.org/">Open edX</a> 社区类似的做法。)</p>

<p>至于常规版本的迭代日志，可参考<a href="https://adapter.codelab.club/changelog/">changelog</a>。</p>

<h1 id="先睹为快">先睹为快</h1>

<p>CodeLab Adapter 3.2 的改进，主要围绕以下方面:</p>

<ul>
<li><strong>新增扩展</strong></li>
<li><strong>让连接无处不在</strong></li>
<li><strong>提升 Windows 平台的使用体验</strong></li>
<li><strong>增强自省能力</strong></li>
<li><strong>完善插件体系</strong></li>
</ul>

<p>以下逐条陈述。</p>

<h2 id="新增扩展">新增扩展</h2>

<p>CodeLab Adapter v3 是一个高度可扩展的开放系统。将一个新的体系接入 CodeLab Adapter， 有时只需几分钟时间！</p>

<p>在 3.2 中，新增了以下扩展:</p>

<ul>
<li><a href="https://adapter.codelab.club/extension_guide/stage/">Stage</a></li>
<li><a href="https://adapter.codelab.club/extension_guide/rpi_gpio/">RaspberryPi GPIO</a></li>
<li><a href="https://adapter.codelab.club/extension_guide/minecraft/">Minecraft</a></li>
<li><a href="https://adapter.codelab.club/extension_guide/sonicPi/">Sonic Pi</a></li>
<li><a href="https://adapter.codelab.club/extension_guide/MQTT_Broker/">MQTT Broker</a></li>
<li><a href="https://adapter.codelab.club/extension_guide/MQTT_adapter/">MQTT Adapter</a></li>
<li><a href="https://adapter.codelab.club/extension_guide/Calypso/">Calypso</a></li>
</ul>

<p>其中 RaspberryPi，Minecraft，Sonic Pi 拥有巨大生态，用户社区从千万到百万级别不等。</p>

<h3 id="stage-https-adapter-codelab-club-extension-guide-stage"><a href="https://adapter.codelab.club/extension_guide/stage/">Stage</a></h3>

<p>Stage 指 Scratch 的舞台区。</p>

<p><img src="https://adapter.codelab.club/img/307a089f4fc36348702fe4d98958ce30.png" alt="" /></p>

<p>Adapter/Scratch Stage 插件允许将 Scratch 舞台区的图像（舞台或者摄像头图像）以 base64 的格式发往 Adapter。如此一来，你就可以构建 Adapter node/extension ，用作自定义图像处理程序！可以使用 神经网络 / OpenCV &hellip; 来处理舞台区的内容，一切都由你决定，识别的结果将返回给 Scratch。</p>

<p>其他的用例，包括构建一个自动保存舞台状态的插件；或者构建自拍/美颜插件：）</p>

<p>需要配合 Scratch <code>图像识别</code> 插件中的积木一起使用。</p>

<p><img src="https://adapter.codelab.club/img/999e46633d51f05d58c863c698fcb109.png" alt="" /></p>

<h3 id="raspberrypi-gpio-https-adapter-codelab-club-extension-guide-rpi-gpio"><a href="https://adapter.codelab.club/extension_guide/rpi_gpio/">RaspberryPi GPIO</a></h3>

<p><img src="https://adapter.codelab.club/img/cb459aec0fc8b001c8f1f9e32b10d8f2.png" alt="" /></p>

<p>树莓派是全球最流行的开源硬件之一，在疫情期间，更是被广泛使用，哥伦比亚将其用于制作呼吸机，有些硬件黑客则使用树莓派 DIY 口罩制作机，将自动生产的口罩赠送给附近医院。</p>

<p>树莓派通过 GPIO 引脚驱动物理/电器设备，所以 DIY 经常会用到 GPIO 。操作树莓派 GPIO 的工具里，<a href="https://gpiozero.readthedocs.io/en/stable/index.html">gpiozero</a>尤为出色，因其具有很好的可理解性（图形化未必意味着更好的可理解性），Python 之父也是 gpiozero 的粉丝。</p>

<p>为了充分利用 gpiozero，我们只对它做一层薄薄的包装(REPL), 使其在 Scratch 中可用，更多的自由度则留给了你。</p>

<p>树莓派高度灵活，难以积木化它的所有特性，那样并不会提高可理解性。 我们希望用户灵活使用 Python 去增强 Scratch ，更好的扩展模式可以参考<a href="https://adapter.codelab.club/extension_guide/extension_python_kernel/">Python eval kernel</a>。</p>

<p>当然， 一些功能是可以积木化的，期待你来提交 PR。</p>

<h3 id="minecraft-https-adapter-codelab-club-extension-guide-minecraft"><a href="https://adapter.codelab.club/extension_guide/minecraft/">Minecraft</a></h3>

<p><img src="https://adapter.codelab.club/img/WechatIMG1431.jpeg" alt="" /></p>

<p>Minecraft（我的世界）是一款开放世界沙盒游戏，拥有惊人的自由度，它是有史以来最畅销的电子游戏，在儿童中尤其流行。</p>

<p>由于 COVID-19，提前结束这个学期后，MIT 学生在 Minecraft 上重建了 MIT 整个校园。校方还<a href="http://news.mit.edu/2020/building-and-reconnecting-mit-minecraft-0407">报道了这事</a>。</p>

<p><img src="https://adapter.codelab.club/img/ba660a0566b0e83a643e88da376f3140.png" alt="" />.</p>

<p>Minecraft 插件将 Minecraft 接入 Adapter ，使游戏中的世界可以与现实世界随意互动！ 可以将 Scratch、乐高、 AI、 实物，以及任何你喜欢的东西都接入到游戏中，与游戏角色互动。</p>

<p>我们制作了一个入门 Demo:<a href="https://scratch3v3.codelab.club?sb3url=https://adapter.codelab.club/sb3/Scratch-mcTurtle.sb3">Scratch-mcTurtle</a>， 你可以从这里起步。它是一个运行在 Minecraft 世界里的 Turtle，将出现在主角周围， 推荐你飞到空中(空格)去看它的运行轨迹。</p>

<video src="https://adapter.codelab.club/video/1588665494072465.mp4" controls="controls"></video>

<p>如果你想做更多有趣的事，建议阅读<a href="stuffaboutcode.com/p/minecraft.html">minecraft</a>, 我们鼓励你去修改<a href="https://github.com/CodeLabClub/codelab_adapter_extensions/blob/master/nodes_v3/node_minecraft.py">插件源码</a>，去支持更多的对象。欢迎把你的修改结果提交到 CodeLab 源码仓库，分享给社区里的其他人用。</p>

<h3 id="mqtt-broker-https-adapter-codelab-club-extension-guide-mqtt-broker"><a href="https://adapter.codelab.club/extension_guide/MQTT_Broker/">MQTT Broker</a></h3>

<p>@云天 在 国内最大的 maker 社区 &ndash; dfrobot 社区里分享了十来篇采用 CodeLab Adapter 构建项目的案例, 一些有趣的案例如:</p>

<video src="https://adapter.codelab.club/video/1589111397669473.mp4" controls="controls"></video>

<p>将 OpenCV 接入 CodeLab Adapter，与家居互动，挥手时显示运动区域的光晕，颇有钢铁侠的味道。</p>

<video src="https://adapter.codelab.club/video/1589111360787294.mp4" controls="controls"></video>

<p>使用 CodeLab Adapter 连接 Google Teachable Machine 和 Microbit，训练了一个口哨汤勺开关</p>

<p>他在 懒人系列之视控灯 项目里写道:</p>

<blockquote>
<p>CodeLab Scratch3+CodeLab Adapter+Python 完美搭配。以前我要实现类似功能，要通过一个中间者 MQTT，比如本地的像 Siot。</p>
</blockquote>

<p>CodeLab Adapter 的典型用途之一确实是 构建复杂连接的项目时，部分替代 MQTT。</p>

<p>但 MQTT 有其独特的价值，所以在 Adapter 3.2 中，有两个插件围绕 MQTT 。</p>

<p>MQTT Broker 插件允许你在本地轻松启动一个轻量级 MQTT Broker，这是一颗强劲的心脏。 轻量级，却高性能，采用 Adapter 内置的 <a href="https://hbmqtt.readthedocs.io/en/latest/index.html">hbmqtt</a>， 基于协程的并发能力，足以让你在树莓派上支撑起整个学校的物联网。</p>

<p>一个典型的使用场景是将各类支持 mqtt client 的硬件，接入 Adapter（你需要写一个 extension, 不过我们已经构建了一个:<a href="https://adapter.codelab.club/extension_guide/MQTT_adapter/">MQTT_adapter</a> ），方便你将 esp32、esp8266、掌控板等设备接入 Adapter 。</p>

<h3 id="mqtt-adapter-https-adapter-codelab-club-extension-guide-mqtt-adapter"><a href="https://adapter.codelab.club/extension_guide/MQTT_adapter/">MQTT Adapter</a></h3>

<p>MQTT Adapter 插件负责桥接 mqtt 与 Scratch/Adapter， 它展示我们在易用性上所做的努力。</p>

<p>原理很简单，它将来自 mqtt 的消息(mqtt topic:<code>to_scratch</code>)，转发到 eim 中，将 eim 中的消息转发到 mqtt(mqtt topic:<code>from_scratch</code>)。</p>

<h3 id="calypso-https-adapter-codelab-club-extension-guide-calypso"><a href="https://adapter.codelab.club/extension_guide/Calypso/">Calypso</a></h3>

<p><img src="https://adapter.codelab.club/img/5e2d27904616c6f685c439d933fa2ced.png" alt="" /></p>

<p><a href="https://calypso.software/">Calypso</a> 是 CMU 大学七年来对儿童如何学习基于规则的机器人编程的研究成果。由<a href="https://en.wikipedia.org/wiki/David_S._Touretzky">David S. Touretzky</a>博士构建，他是 CMU 计算机科学和神经认知基础中心的研究教授。此外，Touretzky 一直活跃在互联网，主张言论自由。</p>

<p><a href="https://calypso.software/">Calypso</a>目前用于为 Cozmo 编程。被广泛用于 AI 教育项目.</p>

<video src="https://adapter.codelab.club/video/1589111342575217.mp4" controls="controls"></video>

<p>当 Cozmo 看到我表情悲伤时，将帮我升起窗帘: &ldquo;Give you some sunshine&rdquo;。</p>

<p>Cozmo 说 oh you are sad ，give you some sunshine。《Give Me Some Sunshine》是《三傻大闹宝莱坞》里的插曲。</p>

<p>这个例子很好展示了 设备与环境的互动。这种与环境的连接能力，允许大量有想象力且有温度的事情发生。更多理念，参考<a href="https://www.codelab.club/blog/design-principles-behind-neverland/">CodeLab 可编程空间 背后的理念与设计原则</a>。</p>

<h2 id="让连接无处不在">让连接无处不在</h2>

<p>Adapter 3.0 拥有强大的连接能力。</p>

<p>v3.2 在连接方面的主要工作是使其高度易用。</p>

<p><a href="https://adapter.codelab.club/dev_guide/Adapter-Node/">Adapter Node</a> 虽然能够将整个 Python 生态 接入到 Adapter 中， 但对于许多入门者，却可能缺乏 Python 相关的技能。</p>

<p>v3.2 使连接开箱可用，对于入门者，Ta 可以快速将自己感兴趣的系统，接入 Adapter 中；对于高阶用户，推荐使用<a href="https://adapter.codelab.club/dev_guide/Adapter-Node/">Adapter Node</a>，几乎拥有无限的自由。</p>

<blockquote>
<p>让简单的事情保持简单，让困难的事情变得可能 &ndash; Alan Kay</p>
</blockquote>

<p>v3.2 中 Adapter 默认接收 EIM 消息请求，请求地址为:</p>

<p><code>https://codelab-adapter.codelab.club:12358/api/message/eim?message=hi</code></p>

<p>它只是简单 HTTP 请求，可以从任何地方发起！拥有和 web 生态一样的简单性。这个简单的接口带来了类似 IFTTT 的简单和灵活。你可以将任何 event 通知给 Adapter。</p>

<p>前边有两个案例，是基于这个接口做的：</p>

<p><a href="https://adapter.codelab.club/extension_guide/Calypso/">Calypso</a> 以及 Kano 魔杖。以下是 Kano 魔杖的案例：</p>

<video src="https://adapter.codelab.club/video/1576905337206766.mp4" controls="controls"></video>

<p>更有想象力的事情是，使用 Ngrok 之类的工具，将该接口暴露到公共互联网，如此一来，我们甚至可以在教学直播中，让远方的学生与演播厅的整个可编程空间互动，可以是多人！</p>

<p>前边的场景不过也是一种<strong>连接</strong>罢了，虽然可能跨越半个地球。</p>

<p>Adapter 专注在连接，并使其简易。</p>

<p>尤其值得一提的是，我们充分考虑了安全性，即便暴露到公共网络，它也是安全的！</p>

<h2 id="提升-windows-平台的使用体验">提升 Windows 平台的使用体验</h2>

<p>由于许多用户在使用 Windows 平台，而我自己则主要在用 MacOS 和 Linux，之前忽视了 Windows 平台下的使用体验。</p>

<p>@Hanson 同学在使用 CodeLab Adapter 过程中，不只在班级博客中写了推荐文章:<a href="https://rcfclass7.wordpress.com/2020/04/24/%e4%bd%bf%e7%94%a8codelab-adapter%e6%89%a9%e5%b1%95scratch/">使用 Codelab-Adapter 扩展 Scratch</a>（文章中对 Adapter 架构的理解非常精确），还给出了许多反馈和建议, 这些改进建议，多数在 3.2 中付诸实施。</p>

<p>其中最大的一项改进是:</p>

<blockquote>
<p>HCI 运行时启动的 python 命令行程序可以改为.pyw 的隐藏程序</p>
</blockquote>

<p>将 Node 作为隐藏程序，不只是 @Hanson 同学提出，其他用户也多次提出，在 3.2 中，这项工作已完成。</p>

<p>容我吐槽下 Windows，忍无可忍，在源码注释中竖了中指 🖕️，不准备删除：） Windows 拙劣得惊人。 在其中编程，仿若在泥塘与巨兽搏斗。推荐大家使用 Ubuntu系统，Ubuntu 是免费的，不需要重新购买计算机，直接安装 Ubuntu 即可使用。</p>

<h2 id="增加自省能力">增加自省能力</h2>

<p>我们在<a href="https://www.codelab.club/blog/3-release/">发布 CodeLab Adapter 3.0</a> 讨论<strong>自省</strong>时说到</p>

<blockquote>
<p>自省的意思是说事物理解它自身的状态，当我们说一个事物 智能 的时候，很多时候和它的自省能力有关。</p>
</blockquote>

<p>3.2 进一步增强 Adapter 的自省能力，于是我们可以做到一些智能的行为，诸如在程序启动时，自动更新最新的 Adapter Client，这样使用 Adapter Node 时，无需再操心环境依赖问题。</p>

<p>这也是 3.2 对易用性的最大改进之一。</p>

<p>导致这项改进的背景是，Cozmo 社区的许多用户，是没有技术背景的奶爸，他们使用 CodeLab Adapter 来驱动孩子们喜欢的 Cozmo，让他们在 Scratch 里同时驱动 Cozmo 和 Vector:</p>

<video src="https://adapter.codelab.club/video/where-did-the-human-go.mp4" controls="controls"></video>

<p>但他们经常会对文档中一些我们(工程师们)认为非常基础的概念产生疑惑，诸如 pip 是什么，命令行怎么打开，他们给我发邮件，他们感到困惑的地方，让我有点惊讶。</p>

<p>但我们要承认，对创造感兴趣的并非都是工程师，如何让非技术背景的用户更加易于使用，是我们不断增强 Adapter 自省能力的原因。通过增加自省能力，来自动化完成一些需要手动操作的技术活。</p>

<h2 id="完善插件体系">完善插件体系</h2>

<p>3.2 中，对插件体系有 2 大改进：</p>

<h3 id="插件市场">插件市场</h3>

<p><img src="https://adapter.codelab.club/img/57c8980da375649292ff3fc158e71bae.png" alt="" /></p>

<p>插件市场现在同时支持 Node 和 Extension，用户可以将自己创建的插件，分享给社区用户。而且我们允许 Node 托管在互联网的任何区域！</p>

<h3 id="可扩展的插件-meta-信息">可扩展的插件 Meta 信息</h3>

<p>3.2 中，我们使用静态分析(ast) 从 Node/Extension 中动态提取 meta 信息。这些信息用于为插件排序，以及为 UI 提供插件附属信息。其中关于添加图标和描述信息的想法，来自Longan团队的产品经理@yuchen，目前3.2中已经实现。</p>

<p><img src="https://adapter.codelab.club/img/a884c24a566089e8d87ce339fab0efdd.png" alt="" /></p>

<p>此外， 第三方公司在构建自己的扩展时，可以随意自定义信息给自定义的前端 UI 使用，这样一来具有极高的灵活度。</p>

<p>这是我第一次写静态分析相关的代码。把代码当数据来操控的想法实在太有意思了！它给人一种无所不能的快乐。</p>

<p>把代码当数据来操控的想法在 LISP 社区很盛行，但在学习 LISP 的时候（《SICP》和《The Little Schemer》）围绕这个话题读了不少资料，却总有一种隔阂感，后来 Seymour 和蒙台梭利关于“实践”的论点打动我，便习惯了 learning by doing。由于近期希望在代码运行之前提取 Meta 信息，如此一来对代码的静态分析，就成为眼前事，那些能够方便解析和操控静态代码的工具和语言(hylang)，像 ast，之前觉得复杂而冗长，这两天却呈现出前所未有的趣味。</p>

<p>ast 模块的 api 惊人地优美。这些 api 在我之前看来，是一堆与我无关的结构，只能凭借记忆和无聊的练习去反复适应它。当我最近试着手动处理代码结构，处处碰壁，再次看到 ast，惊为天人。这时，理解只是轻松的副产物。或许可以作为 seymour 关于“建构主义”所做讨论的案例注脚。</p>

<h1 id="其他改进">其他改进</h1>

<p>其他的改进，如:</p>

<ul>
<li>日志滚动存放 30 天，逾期清除，避免占用太多计算机存储空间</li>
<li>Adapter退出时，UI 弹出(alert)提醒，而不是显示断开加载中(之前有几位用户对此感到困惑)</li>
<li>软件启动时，使用线程自动检查环境信息，并提取到全局</li>
<li>将一些辅助函数移往 adapter client，使得构建 Node 更为容易。</li>
<li>&hellip;</li>
</ul>

<p>不在此一一列出，我们近期将一起更新到changelog里。</p>
    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">种瓜</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2020-05-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/codelab/">codelab</a>
          </div>
      <nav class="post-nav">
        
        <a class="next" href="/post/%E8%AF%97%E8%AF%8D/houlang/">
            <span class="next-text nav-default">后浪</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:wuwenjie718@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="mailto:wuwenjie718@gmail.com" class="iconfont icon-out-me" title="out-me"></a>
      <a href="https://github.com/wwj718" class="iconfont icon-github" title="github"></a>
  <a href="https://blog.just4fun.site/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span><a target="_blank" href="https://blog.just4fun.site/post/%E9%9A%8F%E7%AC%94/join-us/">加入我们</a></span>
  <span class="division">|</span>
  <span><a target="_blank" href="https://cn.bing.com/search?q=site%3Ablog.just4fun.site%20%20codelab-adapter">搜索本站</a></span>
  <span class="division">|</span>
  <span><a target="_blank" href="https://blog.just4fun.site/index.xml">RSS订阅</a></span>
  <span class="division">|</span>
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span><a target="_blank" href="http://www.beian.miit.gov.cn">苏ICP备18043473号</a></span>
  <span class="division">|</span>
  <span>枕戈待白昼</span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2013 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">种瓜</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>

<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?18db4b662c04fbd6cc2851d246c51b3f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>






</body>
</html>
