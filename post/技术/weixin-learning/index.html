<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>微信小结 - 爱自由</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Alan Russell" /><meta name="description" content="上个月搭了一个微信公众平台，后台用的是python（之前用bootle,现在改用django），当然用什么语言是无关紧要的。 近期服务器环境从" /><meta name="keywords" content="education, programming, Technology" />






<meta name="generator" content="Hugo 0.56.3 with theme even" />


<link rel="canonical" href="https://blog.just4fun.site/post/%E6%8A%80%E6%9C%AF/weixin-learning/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="微信小结" />
<meta property="og:description" content="上个月搭了一个微信公众平台，后台用的是python（之前用bootle,现在改用django），当然用什么语言是无关紧要的。 近期服务器环境从" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.just4fun.site/post/%E6%8A%80%E6%9C%AF/weixin-learning/" />
<meta property="article:published_time" content="2014-01-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2014-01-07T00:00:00+00:00" />
<meta itemprop="name" content="微信小结">
<meta itemprop="description" content="上个月搭了一个微信公众平台，后台用的是python（之前用bootle,现在改用django），当然用什么语言是无关紧要的。 近期服务器环境从">


<meta itemprop="datePublished" content="2014-01-07T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2014-01-07T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="3198">



<meta itemprop="keywords" content=" web," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="微信小结"/>
<meta name="twitter:description" content="上个月搭了一个微信公众平台，后台用的是python（之前用bootle,现在改用django），当然用什么语言是无关紧要的。 近期服务器环境从"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">某行人</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/post/%E9%9A%8F%E7%AC%94/aboutme/">
        <li class="mobile-menu-item">About-Me</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">某行人</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/%E9%9A%8F%E7%AC%94/aboutme/">About-Me</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">微信小结</h1>

      <div class="post-meta">
        <span class="post-time"> 2014-01-07 </span>
        <div class="post-category">
            <a href="/categories/%E6%8A%80%E6%9C%AF/"> 技术 </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    
  </div>
</div>
    <div class="post-content">
      <p>上个月搭了一个微信公众平台，后台用的是<code>python</code>（之前用<code>bootle</code>,现在改用<code>django</code>），当然用什么语言是无关紧要的。</p>

<p>近期服务器环境从<code>bae</code>迁回本地环境（学校给了个服务器），bae上调试不方便，而且稳定性没有保障，变动频繁。当然国内的开放平台基本这样，bae相对算是不错的，似乎由于开源潮流势不可挡的缘故，各家公司不情愿地做个开放平台，深怕被对手甩下，至少在舆论上不落后，又不理解开放的意义，只能做得很蹩脚。当然如果练手的话，bae还是挺不错的。</p>

<p>之所以换用django，主要是为了后期的功能加强考虑，之后涉及到session，数据库之类的问题的话，用django熟悉些，扩展起来可能会容易些。</p>

<p>如果在<code>bae/sae</code>之类的云环境下部署的话，推荐使用bootle，django配置起来麻烦些。bootle很小巧便捷，仅是一个文件而已，不会出现依赖问题，极其适合练手。<a href="http://article.yeeyan.org/view/35282/123019">bootle入门</a>。bae上需要注意一下第三库的配置，就是说你在这里不能使用pip，得自行打包依赖的库，一并上传，之后添加到系统路径里就行。如果在bae下具体可参考<a href="http://git.oschina.net/397667796/bae_django/tree/master/1">here</a> 。模仿这个项目布局就行，deps里放置第三方库。 在index.py里加上</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">deps_path = os.path.join(os.path.split(os.path.realpath(__file__))[0],&#39;deps&#39;)
if deps_path not in sys.path:
        sys.path.insert(0, deps_path)</pre></td></tr></table>
</div>
</div>
<p>实际上写一个微信公众平台要比开发一个网站简单得多。不需要前台，不需要美工，后台的逻辑也极其简单。</p>

<p>###关于微信
waiting&hellip;<br />
重要的部分其实和使用什么语言写后台无关，重在熟悉微信的<code>api</code>，数据格式之类</p>

<p>###基本思路
先说说基本的思路。理解了之后，至于用什么语言作后台来实现，都是细节问题。之后我会演示使用bootle和django来实现（初学者推荐使用bootle。）</p>

<p>你需要有以下以下东西：</p>

<ul>
<li>一个公网ip</li>
<li>服务器使用80端口</li>
<li>分配一个url给微信使用</li>
<li>申请公众帐号，为了获得token（之后会用到）</li>
</ul>

<p>that&rsquo;s all</p>

<p>那么我们来看看，从用户发送消息，到收到公众帐号的回应，期间发生了什么。</p>

<p><img src="img/weixin.jpeg" alt="图片" /></p>

<p>可以看出，微信扮演中介的角色。</p>

<p>waiting&hellip;</p>

<p>###与微信通信</p>

<p>首先登录你的公众账户，绑定url</p>

<p>如上图所示，我们站在服务器的角度，我们需处理接收微信发送过来的请求，请求分两种，一种是get，一种是post。我么大多时间在处理post过来的数据。这里需要学习的东西主要是数据的格式，参考微信的开发者文档。</p>

<p>在服务器与微信公众帐号建立关联的时候，微信会验证服务器是否合格。技术上的细节是微信会get请求绑定的url，我们需要按要求返回数据，这样就能通过微信的认证。直接上代码：</p>

<p><code>bootle</code>里这样写：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python">	<span class="c1">#-*- coding:utf-8 -*-</span>
	<span class="c1">#! /usr/bin/env python</span>
	<span class="kn">from</span> <span class="nn">bottle</span> <span class="kn">import</span> <span class="o">*</span>
	<span class="kn">import</span> <span class="nn">hashlib</span>

	<span class="nd">@get</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">checkSignature</span><span class="p">():</span>
		    <span class="n">token</span> <span class="o">=</span> <span class="s2">&#34;your token&#34;</span>  <span class="c1">#登录你的微信公众平台，里面可以查到  </span>
		    <span class="n">signature</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;signature&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
		    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
		    <span class="n">nonce</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nonce&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
		    <span class="n">echostr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;echostr&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
		    <span class="n">tmpList</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">nonce</span><span class="p">]</span>
		    <span class="n">tmpList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
		    <span class="n">tmpstr</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">%s%s%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">tmpList</span><span class="p">)</span>
		    <span class="n">hashstr</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">tmpstr</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
		    <span class="k">if</span> <span class="n">hashstr</span> <span class="o">==</span> <span class="n">signature</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">echostr</span>
		    <span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">None</span></code></pre></td></tr></table>
</div>
</div>
<p><code>django</code>里这样写</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python">	<span class="c1"># -*- coding: utf-8 -*-  </span>
	<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>  
	<span class="kn">import</span> <span class="nn">hashlib</span>  
 
	<span class="k">def</span> <span class="nf">handleRequest</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>  
	    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>  
	        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">checkSignature</span><span class="p">(</span><span class="n">request</span><span class="p">),</span><span class="n">content_type</span><span class="o">=</span><span class="s2">&#34;text/plain&#34;</span><span class="p">)</span>  
	        <span class="k">return</span> <span class="n">response</span>  
	    <span class="k">else</span><span class="p">:</span>  
	        <span class="k">return</span> <span class="bp">None</span>  
  
	<span class="k">def</span> <span class="nf">checkSignature</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>  
	    <span class="n">TOKEN</span> <span class="o">=</span> <span class="s2">&#34;your token&#34;</span> 
	    <span class="n">signature</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;signature&#34;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>  
	    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;timestamp&#34;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>  
	    <span class="n">nonce</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;nonce&#34;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>  
	    <span class="n">echoStr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;echostr&#34;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>  
  
	    <span class="n">token</span> <span class="o">=</span> <span class="n">TOKEN</span>  
	    <span class="n">tmpList</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="p">,</span><span class="n">timestamp</span><span class="p">,</span><span class="n">nonce</span><span class="p">]</span>  
	    <span class="n">tmpList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>  
	    <span class="n">tmpstr</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">%s%s%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">tmpList</span><span class="p">)</span>  
	    <span class="n">tmpstr</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">tmpstr</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>  
	    <span class="k">if</span> <span class="n">tmpstr</span> <span class="o">==</span> <span class="n">signature</span><span class="p">:</span>  
	        <span class="k">return</span> <span class="n">echoStr</span>  
	    <span class="k">else</span><span class="p">:</span>  
	        <span class="k">return</span> <span class="bp">None</span> </code></pre></td></tr></table>
</div>
</div>
<p>你如果用的是django的话，我假设你已经熟悉它了，那么urls.py之类常规配置就不介绍了。</p>

<p>好～<br />
这样一来，我们的服务器就通过微信的认证了。<br />
下面进入真正有趣的地方。处理用户的请求，并给予答复。<br />
###案例学习，自动作诗
我对诗词比较感兴趣，那我们就来写一个自动作诗的微信公众号吧。一旦你熟悉的其中的逻辑，你可以发挥你的想象力，写个你自己感兴趣的公众号，思路和大多细节都是基本一样的。
直接上代码：(<code>bae</code>环境下基于<code>bootle</code>)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python">	<span class="c1">#! /usr/bin/env python</span>
	<span class="c1"># coding=utf-8</span>
	<span class="c1">#自动作诗</span>
	<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;wwj&#39;</span>
	<span class="kn">from</span> <span class="nn">bottle</span> <span class="kn">import</span> <span class="o">*</span>
	<span class="kn">import</span> <span class="nn">hashlib</span>
	<span class="c1">#解析xml</span>
	<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="kn">as</span> <span class="nn">ET</span>
	<span class="c1">#解析json，给客户端发送数据，用json格式</span>
	<span class="kn">import</span> <span class="nn">json</span>
	<span class="kn">import</span> <span class="nn">requests</span>  <span class="c1">#第三方库</span>
	<span class="kn">from</span> <span class="nn">BeautifulSoup</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>  <span class="c1">#第三方库，bae下自带    </span>


	<span class="n">app</span> <span class="o">=</span> <span class="n">Bottle</span><span class="p">()</span>
	 
	<span class="nd">@app.get</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
	<span class="c1">#url接口，接收微信的消息</span>
	<span class="k">def</span> <span class="nf">check_signature</span><span class="p">():</span>
	    <span class="c1">#检验token，如果没有这个的话，该服务器会被微信验证失败</span>
	    <span class="n">token</span> <span class="o">=</span> <span class="s2">&#34;your token&#34;</span> <span class="c1">#set your token here</span>
	    <span class="n">signature</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;signature&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>  
	    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
	    <span class="n">nonce</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nonce&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
	    <span class="n">echostr</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;echostr&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
	    <span class="n">tmpList</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">nonce</span><span class="p">]</span>
	    <span class="n">tmpList</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
	    <span class="n">tmpstr</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">%s%s%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">tmpList</span><span class="p">)</span>
	    <span class="n">hashstr</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">(</span><span class="n">tmpstr</span><span class="p">)</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
	    <span class="k">if</span> <span class="n">hashstr</span> <span class="o">==</span> <span class="n">signature</span><span class="p">:</span>
	        <span class="k">return</span> <span class="n">echostr</span>
	    <span class="k">else</span><span class="p">:</span>
	        <span class="k">return</span> <span class="bp">None</span>
	 
	<span class="k">def</span> <span class="nf">parse_msg</span><span class="p">():</span>
	    <span class="c1">#解析来自微信的请求，request用于传递请求信息，这是bootle的知识，与微信无关，核心只是普通的url get部分内容</span>
	    <span class="n">recvmsg</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  
	    <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">recvmsg</span><span class="p">)</span>
	    <span class="n">msg</span> <span class="o">=</span> <span class="p">{}</span>
	    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>
	        <span class="n">msg</span><span class="p">[</span><span class="n">child</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">text</span>
	    <span class="k">return</span> <span class="n">msg</span>
	 
	<span class="k">def</span> <span class="nf">set_content</span><span class="p">():</span>
	    <span class="n">content</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;添加自动作诗模块，输入&#34;诗词#登山&#34;自动写作主题为登山的诗词,目前仅支持平水韵五绝，之后会添加其他体裁&#39;&#39;&#39;</span>
	    <span class="k">return</span> <span class="n">content</span>
	 

	<span class="k">def</span> <span class="nf">writepoetry</span><span class="p">(</span><span class="n">yb</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="n">tc</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="n">mt</span><span class="o">=</span><span class="sa">u</span><span class="s2">&#34;无题&#34;</span><span class="p">):</span>
		<span class="c1">#yb是韵部，tc是体裁，mt是命题</span>
	    <span class="c1">#mt必须是u</span>
		<span class="n">cleanmt</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;GBK&#34;</span><span class="p">)</span>
		<span class="nb">input</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;yb&#39;</span><span class="p">:</span><span class="n">yb</span><span class="p">,</span> <span class="s2">&#34;tc&#34;</span><span class="p">:</span><span class="n">tc</span><span class="p">,</span><span class="s1">&#39;mt&#39;</span><span class="p">:</span><span class="n">cleanmt</span><span class="p">}</span>
		<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://www.poeming.com/web/main.asp&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nb">input</span><span class="p">)</span>
		<span class="n">cleandate</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;GBK&#34;</span><span class="p">)</span> <span class="c1">#现在是utf-8，在程序中保持为unicode,直到输出才化为utf-8</span>
		<span class="n">outdate</span><span class="o">=</span><span class="p">(</span><span class="n">cleandate</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
		<span class="c1">#print outdate</span>
		<span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">outdate</span><span class="p">)</span> 
		<span class="n">p</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
		<span class="c1">#p是list</span>
		<span class="c1">#p[1]是主要内容</span>
		<span class="n">p_text</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> 
		<span class="k">return</span> <span class="n">p_text</span>
		<span class="c1">##成功后的内容</span>
		<span class="c1">#p_list=p_text.split(u&#34;。&#34;)#使用句号分割取出</span>
		<span class="c1">#print &#39;&#39;.join(p_list[1:])</span>
		<span class="c1">#Out[8]: {&#39;confidence&#39;: 0.99, &#39;encoding&#39;: &#39;GB2312&#39;}</span>
		<span class="c1">#mypoetry=writepoetry(yb=&#34;2&#34;,tc=&#34;1&#34;,mt=u&#34;无题&#34;)</span>


	  
	  
	<span class="nd">@app.post</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">response_msg</span><span class="p">():</span>
		<span class="c1">#返回消息到客户端	</span>
	    <span class="n">msg</span> <span class="o">=</span> <span class="n">parse_msg</span><span class="p">()</span> 
	    <span class="c1">#解析接收到的用户消息</span>
	    <span class="c1">#处理文本消息，注意必须按照微信接口要求的格式，图片消息的话应该给出图片url,多参考别人的源码</span>
	    <span class="n">textTpl</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&lt;xml&gt;
</span><span class="s2">	             &lt;ToUserName&gt;&lt;![CDATA[</span><span class="si">%s</span><span class="s2">]]&gt;&lt;/ToUserName&gt;
</span><span class="s2">	             &lt;FromUserName&gt;&lt;![CDATA[</span><span class="si">%s</span><span class="s2">]]&gt;&lt;/FromUserName&gt;
</span><span class="s2">	             &lt;CreateTime&gt;</span><span class="si">%s</span><span class="s2">&lt;/CreateTime&gt;
</span><span class="s2">	             &lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;
</span><span class="s2">	             &lt;Content&gt;&lt;![CDATA[</span><span class="si">%s</span><span class="s2">]]&gt;&lt;/Content&gt;
</span><span class="s2">	             &lt;FuncFlag&gt;0&lt;/FuncFlag&gt;
</span><span class="s2">	             &lt;/xml&gt;&#34;&#34;&#34;</span>  
	    <span class="c1">#&lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;  这里不用%s才能显示关注？？</span>
	    <span class="c1">#图片模板</span>
	    <span class="n">pictextTpl</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;&lt;xml&gt;
</span><span class="s2">				&lt;ToUserName&gt;&lt;![CDATA[</span><span class="si">%s</span><span class="s2">]]&gt;&lt;/ToUserName&gt;
</span><span class="s2">				&lt;FromUserName&gt;&lt;![CDATA[</span><span class="si">%s</span><span class="s2">]]&gt;&lt;/FromUserName&gt;
</span><span class="s2">				&lt;CreateTime&gt;</span><span class="si">%s</span><span class="s2">&lt;/CreateTime&gt;
</span><span class="s2">				&lt;MsgType&gt;&lt;![CDATA[news]]&gt;&lt;/MsgType&gt;
</span><span class="s2">				&lt;ArticleCount&gt;1&lt;/ArticleCount&gt;
</span><span class="s2">				&lt;Articles&gt;
</span><span class="s2">				&lt;item&gt;
</span><span class="s2">				&lt;Title&gt;&lt;![CDATA[</span><span class="si">%s</span><span class="s2">]]&gt;&lt;/Title&gt;
</span><span class="s2">				&lt;Description&gt;&lt;![CDATA[</span><span class="si">%s</span><span class="s2">]]&gt;&lt;/Description&gt;
</span><span class="s2">				&lt;PicUrl&gt;&lt;![CDATA[</span><span class="si">%s</span><span class="s2">]]&gt;&lt;/PicUrl&gt;
</span><span class="s2">				&lt;Url&gt;&lt;![CDATA[</span><span class="si">%s</span><span class="s2">]]&gt;&lt;/Url&gt;
</span><span class="s2">				&lt;/item&gt;
</span><span class="s2">				&lt;/Articles&gt;
</span><span class="s2">				&lt;FuncFlag&gt;1&lt;/FuncFlag&gt;
</span><span class="s2">				&lt;/xml&gt; &#34;&#34;&#34;</span>
	    
	    <span class="n">content</span> <span class="o">=</span> <span class="n">set_content</span><span class="p">()</span>
	    <span class="c1">#处理关注事件</span>
	    <span class="c1">#调试成功，技巧：控制变量，从最少元素开始，逐步增加</span>
	    <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="s2">&#34;MsgType&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;event&#34;</span><span class="p">:</span>
	        <span class="n">echostr</span> <span class="o">=</span> <span class="n">textTpl</span> <span class="o">%</span> <span class="p">(</span>
	            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;FromUserName&#39;</span><span class="p">],</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;ToUserName&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())),</span> 
	            <span class="s1">&#39;&#39;&#39;添加自动作诗模块，输入&#34;诗词#登山&#34;自动写作主题为登山的诗词,目前仅支持平水韵五绝，之后会添加其他体裁&#39;&#39;&#39;</span><span class="p">)</span>
	        <span class="k">return</span> <span class="n">echostr</span>
	    
	    <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;hi&#34;</span><span class="p">:</span>

	      <span class="c1">#msg[&#39;Content&#39;]用户消息，汉语还是很好解析的，没有乱七八糟编码问题</span>
	      <span class="n">echostr</span> <span class="o">=</span> <span class="n">textTpl</span> <span class="o">%</span> <span class="p">(</span>
	                           <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;FromUserName&#39;</span><span class="p">],</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;ToUserName&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())),</span>
	                           <span class="s2">&#34;hi&#34;</span><span class="p">)</span>  <span class="c1">#填充内容</span>
	      <span class="k">return</span> <span class="n">echostr</span>
	    
	    <span class="k">elif</span> <span class="s2">&#34;诗词&#34;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]:</span> <span class="c1">#“#”只能用中文</span>
	      <span class="k">try</span><span class="p">:</span>
	      	<span class="n">content</span><span class="o">=</span><span class="n">msg</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;#&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	      <span class="k">except</span><span class="p">:</span>
	      	<span class="n">content</span><span class="o">=</span><span class="n">msg</span><span class="p">[</span><span class="s1">&#39;Content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;#&#34;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	      <span class="c1">#content=&#34;怀&#34;</span>
	      <span class="n">mypoetry</span><span class="o">=</span><span class="n">writepoetry</span><span class="p">(</span><span class="n">yb</span><span class="o">=</span><span class="s2">&#34;2&#34;</span><span class="p">,</span><span class="n">tc</span><span class="o">=</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="n">mt</span><span class="o">=</span><span class="n">content</span><span class="p">)</span>
	      <span class="c1">#msg[&#39;Content&#39;]用户消息，汉语还是很好解析的，没有乱七八糟编码问题</span>
	      <span class="n">echostr</span> <span class="o">=</span> <span class="n">textTpl</span> <span class="o">%</span> <span class="p">(</span>
	                           <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;FromUserName&#39;</span><span class="p">],</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;ToUserName&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())),</span>
	                           <span class="n">mypoetry</span><span class="p">)</span>  <span class="c1">#填充内容</span>
	      <span class="k">return</span> <span class="n">echostr</span>

	    <span class="k">else</span><span class="p">:</span>
	      <span class="n">echostr</span> <span class="o">=</span> <span class="n">textTpl</span> <span class="o">%</span> <span class="p">(</span>
	                           <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;FromUserName&#39;</span><span class="p">],</span> <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;ToUserName&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())),</span>
	                           <span class="n">content</span><span class="p">)</span>  
	      <span class="k">return</span> <span class="n">echostr</span>
	    
	      
	 
	<span class="c1">#call bae serive</span>
	<span class="kn">from</span> <span class="nn">bae.core.wsgi</span> <span class="kn">import</span> <span class="n">WSGIApplication</span>
	<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os.path</span>
	<span class="n">deps_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;deps&#39;</span><span class="p">)</span>
	<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">deps_path</span><span class="p">)</span>


	<span class="c1">#create application</span>
	<span class="n">application</span> <span class="o">=</span> <span class="n">WSGIApplication</span><span class="p">(</span><span class="n">app</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>自动作诗的数据，来自稻香老农的网络版自动作诗机，解析数据时注意一下编码问题就行。具体见代码。另外目前只能自动写绝句，其他功能有空添加。</p>

<p>推荐使用案例驱动式的学习方法，一开始就埋头到文档里，无趣且乏味，可以先看几个成功的案例，试着模仿，运行，修修改改，先跑起来,至于案例的来源，博客和github是个巨大的宝库，我闲来比较喜欢逛逛github，总有意外的收获。</p>

<p>###后记
案例中有趣的地方是，我们借用requests来访问其他网站，这样一来我们可以轻易使用混搭开发模式(mashup),这是个很有趣的话题，也是我一直关注的一个方向。开源与开放平台是未来。
发挥你的想象力吧，想象力是你在数字世界的唯一边界。借用requests，可以做许多有趣的工作，比如写一个根据输入的电影名称，去豆瓣抓取电影资讯的工作平台;或者根据输入的学号，去获取学生的成绩/课程表之类;再或者根据输入的照片，识别人脸,建立人群关系（使用face++）.<br />
 这里我们可以抽象出一个共性，我们的后台实际也在扮演中介角色，或者理解为入口，从广泛的网络里获取用户需要的内容，至于可以干什么，这里的唯一限制是你的想象力^_^</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">Alan Russell</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2014-01-07
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/web/"> web</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E6%8A%80%E6%9C%AF/learning-python-2/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">python算法学习之推荐系统</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/%E9%9A%8F%E7%AC%94/2013-1/">
            <span class="next-text nav-default">2013</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:wuwenjie718@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="mailto:wuwenjie718@gmail.com" class="iconfont icon-out-me" title="out-me"></a>
      <a href="https://github.com/wwj718" class="iconfont icon-github" title="github"></a>
  <a href="https://blog.just4fun.site/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span><a target="_blank" href="#/post/">加入我们</a></span>
  <span class="division">|</span>
  <span><a target="_blank" href="https://cn.bing.com/search?q=site%3Ablog.just4fun.site%20%20codelab-adapter">搜索本站</a></span>
  <span class="division">|</span>
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2013 - 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Alan Russell</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>

<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?18db4b662c04fbd6cc2851d246c51b3f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>






</body>
</html>
