<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>在 dotPack 上制造「雪崩」的 N 种方法 - 夜行人</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="种瓜" /><meta name="description" content="前言 我们在 MicroBlocks 编程案例: dotPack 讨论了如何使用 MicroBlocks 在 dotPack 上制造&amp;quot;雪崩&amp;quot;。 本文将展示在 dotPack 上制造&amp;quot;雪崩&amp;quot;的各种方法:" /><meta name="keywords" content="education, programming, Technology" />






<meta name="generator" content="Hugo 0.96.0 with theme even" />


<link rel="canonical" href="http://wwj718.github.io/post/%E7%BC%96%E7%A8%8B/dotpack-snow-crash/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.69e0bbe2419d9b0efbdcc1d3b4338bba03a6f6789ae2832bc1af58e5b2757470.css" rel="stylesheet">
<link rel="stylesheet" href="/post/img/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="在 dotPack 上制造「雪崩」的 N 种方法" />
<meta property="og:description" content="前言 我们在 MicroBlocks 编程案例: dotPack 讨论了如何使用 MicroBlocks 在 dotPack 上制造&quot;雪崩&quot;。 本文将展示在 dotPack 上制造&quot;雪崩&quot;的各种方法:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://wwj718.github.io/post/%E7%BC%96%E7%A8%8B/dotpack-snow-crash/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-05-28T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-05-28T00:00:00+00:00" />

<meta itemprop="name" content="在 dotPack 上制造「雪崩」的 N 种方法">
<meta itemprop="description" content="前言 我们在 MicroBlocks 编程案例: dotPack 讨论了如何使用 MicroBlocks 在 dotPack 上制造&quot;雪崩&quot;。 本文将展示在 dotPack 上制造&quot;雪崩&quot;的各种方法:"><meta itemprop="datePublished" content="2022-05-28T00:00:00+00:00" />
<meta itemprop="dateModified" content="2022-05-28T00:00:00+00:00" />
<meta itemprop="wordCount" content="2307">
<meta itemprop="keywords" content="MicroBlocks," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="在 dotPack 上制造「雪崩」的 N 种方法"/>
<meta name="twitter:description" content="前言 我们在 MicroBlocks 编程案例: dotPack 讨论了如何使用 MicroBlocks 在 dotPack 上制造&quot;雪崩&quot;。 本文将展示在 dotPack 上制造&quot;雪崩&quot;的各种方法:"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">夜行人</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/post/%E9%9A%8F%E7%AC%94/aboutme/">
        <li class="mobile-menu-item">About-Me</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">夜行人</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/%E9%9A%8F%E7%AC%94/aboutme/">About-Me</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">在 dotPack 上制造「雪崩」的 N 种方法</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-05-28 </span>
        <div class="post-category">
            <a href="/categories/%E7%BC%96%E7%A8%8B/"> 编程 </a>
            </div>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#前言">前言</a>
      <ul>
        <li><a href="#在硬件层面了解-dotpack">在硬件层面了解 dotPack</a></li>
      </ul>
    </li>
    <li><a href="#制造雪崩的-n-种方法">制造&quot;雪崩&quot;的 N 种方法</a>
      <ul>
        <li><a href="#microblocks">MicroBlocks</a>
          <ul>
            <li><a href="#刷入固件">刷入固件</a></li>
            <li><a href="#方法-1-内置的-neopixel-库-一维坐标">方法 1: 内置的 NeoPixel 库: 一维坐标</a></li>
            <li><a href="#方法-2-内置的-neopanel-库">方法 2: 内置的 NeoPanel 库</a></li>
          </ul>
        </li>
        <li><a href="#方法-3-ccarduino">方法 3: C/C++/Arduino</a></li>
        <li><a href="#方法-4-micropython">方法 4: MicroPython</a></li>
        <li><a href="#方法-5-microblocks-固件--python-客户端">方法 5: MicroBlocks 固件 + Python 客户端</a></li>
        <li><a href="#方法-5-官方固件--python-客户端">方法 5: 官方固件 + Python 客户端</a>
          <ul>
            <li><a href="#toit">Toit</a></li>
            <li><a href="#lispulisp">LISP(ulisp)</a></li>
            <li><a href="#javascript">JavaScript</a></li>
            <li><a href="#devicescript">DeviceScript</a></li>
            <li><a href="#ruby">Ruby</a></li>
            <li><a href="#lua">Lua</a></li>
            <li><a href="#forth">Forth</a></li>
            <li><a href="#prolog">Prolog</a></li>
            <li><a href="#rust">Rust</a></li>
            <li><a href="#nim">Nim</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><img src="/post/img/dotPack-homepage.png" alt=""></p>
<h1 id="前言">前言</h1>
<p>我们在 <a href="/post/%E7%BC%96%E7%A8%8B/microblocks-dotpack/">MicroBlocks 编程案例: dotPack</a> 讨论了<a href="/post/%E7%BC%96%E7%A8%8B/microblocks-dotpack/#%E9%9B%AA%E5%B4%A9snow-crash">如何使用 MicroBlocks 在 dotPack 上制造&quot;雪崩&quot;</a>。</p>
<p>本文将展示在 <a href="https://dotpack.fun/">dotPack</a> 上制造&quot;雪崩&quot;的各种方法:</p>
<ul>
<li>MicroBlocks</li>
<li>C/C++/Arduino</li>
<li>MicroPython/CircuitPython</li>
<li>MicroBlocks 固件 + Python 客户端</li>
<li>官方固件 + Python 客户端</li>
<li>官方固件 + Scratch</li>
<li>官方固件 + 浏览器里的 JavaScript</li>
<li>官方固件 + 浏览器中的 Python(PyScript/Pyodide）</li>
<li>MicroBlocks 固件 + Squeak(Smalltalk) 客户端</li>
<li>待定&hellip;
<ul>
<li>LISP(ulisp)</li>
<li>Javascript</li>
<li>DeviceScript</li>
<li>Lua</li>
<li>Rust</li>
<li>Ruby</li>
<li>Toit</li>
<li>Prolog</li>
<li>Forth</li>
<li>Nim</li>
</ul>
</li>
</ul>
<h2 id="在硬件层面了解-dotpack">在硬件层面了解 dotPack</h2>
<p>为了在不同的编程语言中对 dotPack 进行编程，我们有必要在硬件层面了解一下 dotPack。</p>
<p>就可编程部分来说， dotPack 是一个由 ESP32 驱动的 16x16 NeoPixel 点阵屏, 控制引脚(Pin)为 <code>12</code>。</p>
<p>NeoPixel 点阵屏采用 S 形走线方式。</p>
<p><img src="/post/img/12e4e816fcd717bd190663b442f364ab.jpg" alt=""></p>
<p>在硬件层面，这个看起来像二维平面的点阵屏，实际是一条一维的 S 形 NeoPixel 灯带。如果你打算自己写底层固件，则一维坐标到二维平面坐标(x,y)的转化，需要自己完成。若使用官方固件，它已经为你完成了这个工作。</p>
<h1 id="制造雪崩的-n-种方法">制造&quot;雪崩&quot;的 N 种方法</h1>
<h2 id="microblocks">MicroBlocks</h2>
<p>接下来，我们将使用 2 种不同的积木库，在 dotPack 上制造雪崩。</p>
<ul>
<li>内置的 NeoPixel 库: 一维坐标</li>
<li>内置的 NeoPanel 库: 二维坐标, 完全在 MicroBlocks 中实现, 底层基于 NeoPixel 库</li>
</ul>
<p>在开始制造雪崩之前，我们需要做些准备工作，将 dotPack 接入到 MicroBlocks 编程平台上。</p>
<h3 id="刷入固件">刷入固件</h3>
<p>为了使用 MicroBlocks 对 dotPack 编程，首先需要为 dotPack 刷入新的固件， 替代内置的官方固件。</p>
<p>这一过程十分简单，在 MicroBlocks 编程环境里(浏览器)即可完成所有操作:</p>
<ul>
<li>将 dotPack 连接到计算机(如果无法发现设备端口, 则需要安装 <a href="https://learn.sparkfun.com/tutorials/how-to-install-ch340-drivers/all">CH340 驱动</a>)</li>
<li>点击左上角设置按钮(齿轮 ⚙️ 图标)</li>
<li>点击<code>升级主板固件</code></li>
<li>点击 ESP32</li>
<li>等待完成。
<ul>
<li>提醒: 使用 MicroBlocks 网页刷入 ESP32 固件时，请确保网页处于工作状态，耐心等待完成，不要切换到其他页面，否则会导致刷入的固件不完整。</li>
</ul>
</li>
</ul>
<p><img src="/post/img/dotpack-snow-crash2.png" alt=""></p>
<p>完成之后，点击页面上方的 USB 图标，点击书包的串口地址，即可将 dotPack 接入硬件编程平台。</p>
<p>如果遇到问题，可以重新插拔下 dotPack 的 usb 线，并刷新下编程页面。</p>
<p>接下来就可以开始制造雪崩了！</p>
<h3 id="方法-1-内置的-neopixel-库-一维坐标">方法 1: 内置的 NeoPixel 库: 一维坐标</h3>
<p>首先打开内置的 NeoPixel 库</p>
<p><img src="/post/img/dotpack-snow-crash3.png" alt=""></p>
<p>开始编程:</p>
<p><img src="/post/img/dotpack-snow-crash4.png" alt=""></p>
<p><a href="https://microblocksfun.cn/run/microblocks.html#project=projectName%20%27%27%0A%0Amodule%20main%0Aauthor%20unknown%0Aversion%201%200%20%0Adescription%20%27%27%0A%0A%20%20spec%20%27%20%27%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%0A%0Ato%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%7B%0A%20%20for%20i%20%2816%20%2A%2016%29%20%7B%0A%20%20%20%20if%20%28%28random%201%202%29%20%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20setNeoPixelColor%20i%20%28colorSwatch%20255%20255%20255%20255%29%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20setNeoPixelColor%20i%20%28colorSwatch%200%200%200%20255%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ascript%2051%2040%20%7B%0AneoPixelAttach%20256%2012%0Aforever%20%7B%0A%20%20waitMillis%20100%0A%20%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%0A%7D%0A%7D%0A%0Ascript%2060%20160%20%7B%0Ato%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%7B%7D%0A%7D%0A%0A%0Amodule%20NeoPixel%20Output%0Aauthor%20MicroBlocks%0Aversion%201%205%20%0Adescription%20%27Control%20NeoPixel%20%28WS2812%29%20RGB%20LED%20strips%20and%20rings.%0A%27%0Avariables%20_np_pixels%20%0A%0A%20%20spec%20%27%20%27%20%27neoPixelAttach%27%20%27attach%20_%20LED%20NeoPixel%20strip%20to%20pin%20_%20%3A%20has%20white%20_%27%20%27num%20auto%20bool%27%2010%20%27%27%20false%0A%20%20spec%20%27%20%27%20%27setNeoPixelColors10%27%20%27set%20NeoPixels%20_%20_%20_%20_%20_%20_%20_%20_%20_%20_%27%20%27color%20color%20color%20color%20color%20color%20color%20color%20color%20color%27%0A%20%20spec%20%27%20%27%20%27clearNeoPixels%27%20%27clear%20NeoPixels%27%0A%20%20spec%20%27%20%27%20%27neoPixelSetAllToColor%27%20%27set%20all%20NeoPixels%20color%20_%27%20%27color%27%0A%20%20spec%20%27%20%27%20%27setNeoPixelColor%27%20%27set%20NeoPixel%20_%20color%20_%27%20%27num%20color%27%201%0A%20%20space%0A%20%20spec%20%27r%27%20%27colorFromRGB%27%20%27color%20r%20_%20g%20_%20b%20_%20%280-255%29%27%20%27num%20num%20num%27%200%20100%20100%0A%20%20spec%20%27r%27%20%27randomColor%27%20%27random%20color%27%0A%20%20space%0A%20%20spec%20%27%20%27%20%27rotateNeoPixelsBy%27%20%27rotate%20NeoPixels%20by%20_%27%20%27auto%27%201%0A%20%20spec%20%27%20%27%20%27NeoPixel_brighten%27%20%27brighten%20NeoPixel%20_%20by%20_%27%20%27num%20num%27%201%2010%0A%20%20spec%20%27%20%27%20%27NeoPixel_brighten_all%27%20%27brighten%20all%20NeoPixels%20by%20_%27%20%27num%27%2010%0A%20%20space%0A%20%20spec%20%27%20%27%20%27_NeoPixel_ensureInitialized%27%20%27_NeoPixel_ensureInitialized%27%0A%20%20spec%20%27%20%27%20%27_NeoPixel_increaseRGB%27%20%27_NeoPixel_increaseRGB%20of%20_%20by%20_%27%20%27num%20num%27%201%2010%0A%20%20spec%20%27%20%27%20%27_NeoPixel_rotate%27%20%27_NeoPixel_rotate_left%20_%27%20%27bool%27%20true%0A%20%20spec%20%27%20%27%20%27_NeoPixel_update%27%20%27_NeoPixel_update%27%0A%0Ato%20NeoPixel_brighten%20i%20delta%20%7B%0A%20%20%27_NeoPixel_increaseRGB%27%20i%20delta%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20NeoPixel_brighten_all%20delta%20%7B%0A%20%20for%20i%20%28size%20_np_pixels%29%20%7B%0A%20%20%20%20%27_NeoPixel_increaseRGB%27%20i%20delta%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20%27_NeoPixel_ensureInitialized%27%20%7B%0A%20%20if%20%28_np_pixels%20%3D%3D%200%29%20%7Bif%20%28%28boardType%29%20%3D%3D%20%27M5Atom-Matrix%27%29%20%7B%0A%20%20%20%20neoPixelAttach%2025%20%27%27%20false%0A%20%20%7D%20%28%28boardType%29%20%3D%3D%20%27D1-Mini%27%29%20%7B%0A%20%20%20%20comment%20%27D1%20mini%20kit%27%0A%20%20%20%20neoPixelAttach%207%2015%20false%0A%20%20%7D%20%28%28boardType%29%20%3D%3D%20%27Mbits%27%29%20%7B%0A%20%20%20%20neoPixelAttach%2025%20%27%27%20false%0A%20%20%7D%20else%20%7B%0A%20%20%20%20neoPixelAttach%2010%20%27%27%20false%0A%20%20%7D%7D%0A%7D%0A%0Ato%20%27_NeoPixel_increaseRGB%27%20i%20delta%20%7B%0A%20%20if%20%28or%20%28i%20%3C%201%29%20%28i%20%3E%20%28size%20_np_pixels%29%29%29%20%7Breturn%7D%0A%20%20local%20%27rgb%27%20%28at%20i%20_np_pixels%29%0A%20%20if%20%28rgb%20%21%3D%200%29%20%7B%0A%20%20%20%20local%20%27r%27%20%28%28rgb%20%3E%3E%2016%29%20%26%20255%29%0A%20%20%20%20local%20%27g%27%20%28%28rgb%20%3E%3E%208%29%20%26%20255%29%0A%20%20%20%20local%20%27b%27%20%28rgb%20%26%20255%29%0A%20%20%20%20r%20%3D%20%28maximum%200%20%28minimum%20%28r%20%2B%20delta%29%20255%29%29%0A%20%20%20%20g%20%3D%20%28maximum%200%20%28minimum%20%28g%20%2B%20delta%29%20255%29%29%0A%20%20%20%20b%20%3D%20%28maximum%200%20%28minimum%20%28b%20%2B%20delta%29%20255%29%29%0A%20%20%20%20atPut%20i%20_np_pixels%20%28colorFromRGB%20r%20g%20b%29%0A%20%20%7D%0A%7D%0A%0Ato%20%27_NeoPixel_rotate%27%20left%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20local%20%27length%27%20%28size%20_np_pixels%29%0A%20%20if%20left%20%7B%0A%20%20%20%20local%20%27first%27%20%28at%201%20_np_pixels%29%0A%20%20%20%20for%20i%20%28length%20-%201%29%20%7B%0A%20%20%20%20%20%20atPut%20i%20_np_pixels%20%28at%20%28i%20%2B%201%29%20_np_pixels%29%0A%20%20%20%20%7D%0A%20%20%20%20atPut%20length%20_np_pixels%20first%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27last%27%20%28at%20length%20_np_pixels%29%0A%20%20%20%20for%20i%20%28length%20-%201%29%20%7B%0A%20%20%20%20%20%20atPut%20%28%28length%20-%20i%29%20%2B%201%29%20_np_pixels%20%28at%20%28length%20-%20i%29%20_np_pixels%29%0A%20%20%20%20%7D%0A%20%20%20%20atPut%201%20_np_pixels%20last%0A%20%20%7D%0A%7D%0A%0Ato%20%27_NeoPixel_update%27%20%7B%0A%20%20%27%5Bdisplay%3AneoPixelSend%5D%27%20_np_pixels%0A%20%20waitMicros%20100%0A%7D%0A%0Ato%20clearNeoPixels%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20fillList%20_np_pixels%200%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20colorFromRGB%20r%20g%20b%20%7B%0A%20%20r%20%3D%20%28maximum%200%20%28minimum%20r%20255%29%29%0A%20%20g%20%3D%20%28maximum%200%20%28minimum%20g%20255%29%29%0A%20%20b%20%3D%20%28maximum%200%20%28minimum%20b%20255%29%29%0A%20%20return%20%28%28%28r%20%3C%3C%2016%29%20%7C%20%28g%20%3C%3C%208%29%29%20%7C%20b%29%0A%7D%0A%0Ato%20neoPixelAttach%20number%20pinNumber%20optionalHasWhite%20%7B%0A%20%20hasWhite%20%3D%20false%0A%20%20if%20%28%28pushArgCount%29%20%3E%202%29%20%7B%0A%20%20%20%20hasWhite%20%3D%20optionalHasWhite%0A%20%20%7D%0A%20%20if%20%28or%20%28_np_pixels%20%3D%3D%200%29%20%28number%20%21%3D%20%28size%20_np_pixels%29%29%29%20%7B%0A%20%20%20%20_np_pixels%20%3D%20%28newList%20number%29%0A%20%20%7D%0A%20%20fillList%20_np_pixels%200%0A%20%20%27%5Bdisplay%3AneoPixelSetPin%5D%27%20pinNumber%20hasWhite%0A%7D%0A%0Ato%20neoPixelSetAllToColor%20color%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20fillList%20_np_pixels%20color%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20randomColor%20%7B%0A%20%20local%20%27n1%27%20%28random%20100%20200%29%0A%20%20local%20%27n2%27%20%28random%200%20100%29%0A%20%20if%20%281%20%3D%3D%20%28random%201%203%29%29%20%7B%0A%20%20%20%20return%20%28%28n1%20%3C%3C%2016%29%20%7C%20%28n2%20%3C%3C%208%29%29%0A%20%20%7D%20%281%20%3D%3D%20%28random%201%202%29%29%20%7B%0A%20%20%20%20return%20%28%28n2%20%3C%3C%2016%29%20%7C%20n1%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20%28%28n1%20%3C%3C%208%29%20%7C%20n2%29%0A%20%20%7D%0A%7D%0A%0Ato%20rotateNeoPixelsBy%20n%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20repeat%20%28absoluteValue%20n%29%20%7B%0A%20%20%20%20%27_NeoPixel_rotate%27%20%28n%20%3E%200%29%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20setNeoPixelColor%20i%20color%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20if%20%28and%20%281%20%3C%3D%20i%29%20%28i%20%3C%3D%20%28size%20_np_pixels%29%29%29%20%7B%0A%20%20%20%20atPut%20i%20_np_pixels%20color%0A%20%20%7D%0A%7D%0A%0Ato%20setNeoPixelColors10%20c1%20c2%20c3%20c4%20c5%20c6%20c7%20c8%20c9%20c10%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%201%29%20%7B%0A%20%20%20%20atPut%201%20_np_pixels%20c1%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%202%29%20%7B%0A%20%20%20%20atPut%202%20_np_pixels%20c2%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%203%29%20%7B%0A%20%20%20%20atPut%203%20_np_pixels%20c3%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%204%29%20%7B%0A%20%20%20%20atPut%204%20_np_pixels%20c4%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%205%29%20%7B%0A%20%20%20%20atPut%205%20_np_pixels%20c5%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%206%29%20%7B%0A%20%20%20%20atPut%206%20_np_pixels%20c6%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%207%29%20%7B%0A%20%20%20%20atPut%207%20_np_pixels%20c7%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%208%29%20%7B%0A%20%20%20%20atPut%208%20_np_pixels%20c8%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%209%29%20%7B%0A%20%20%20%20atPut%209%20_np_pixels%20c9%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%2010%29%20%7B%0A%20%20%20%20atPut%2010%20_np_pixels%20c10%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0A">查看/编辑 程序</a></p>
<h3 id="方法-2-内置的-neopanel-库">方法 2: 内置的 NeoPanel 库</h3>
<p><img src="/post/img/dotpack-snow-crash6-2.png" alt=""></p>
<p><a href="https://microblocksfun.cn/run/microblocks.html#project=projectName%20%27%27%0A%0Amodule%20main%0Aauthor%20unknown%0Aversion%201%200%20%0Adescription%20%27%27%0A%0A%20%20spec%20%27%20%27%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%0A%0Ato%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%7B%0A%20%20for%20i%2016%20%7B%0A%20%20%20%20for%20j%2016%20%7B%0A%20%20%20%20%20%20if%20%28%28random%201%202%29%20%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20comment%20%27%E4%BF%AE%E6%94%B9%E4%BA%86%E5%86%85%E9%83%A8%E7%A7%AF%E6%9C%A8%E7%9A%84%E5%AE%9A%E4%B9%89%3A%20%E4%B8%8D%E8%87%AA%E5%8A%A8%E5%88%B7%E6%96%B0%27%0A%20%20%20%20%20%20%20%20neoPanel_drawPixel%20i%20j%20%28colorSwatch%20100%20100%20100%20255%29%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20neoPanel_drawPixel%20i%20j%20%28colorSwatch%200%200%200%20255%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ascript%2045%2040%20%7B%0AneoPanel_attach%2016%2016%2012%0Aforever%20%7B%0A%20%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%0A%20%20waitMillis%20100%0A%7D%0A%7D%0A%0Ascript%2042%20161%20%7B%0Ato%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%7B%7D%0A%7D%0A%0A%0Amodule%20BMP%20Output%0Aauthor%20%27Jos%C3%A9%20Garc%C3%ADa%20Yeste%27%0Aversion%202%202%20%0Adepends%20TFT%20Files%20%0Adescription%20%27Display%20BMP%20files%20on%20a%20TFT%20screen.%0A%0ABMP%20files%20can%20be%20transferred%20to%20and%20from%20boards%20with%20a%20file%20systems%20using%20the%20put%2Fget%20commands%20in%20the%20IDE%20file%20menu%20%28available%20in%20%22show%20advanced%20blocks%22%20mode%29.%0A%0ADragging%20a%20BMP%20file%20over%20microBlocks%20also%20loads%20the%20file%20into%20the%20file%20system.%0A%0AThis%20library%20works%20with%20uncompressed%20BMP%20files%20with%201%2C%204%2C%208%2C%2016%2C%2024%20and%2032%20bits%20per%20pixel.%20v2.0%20supports%204%20and%208%20bit%20RLE%20compressed%20files.%0A%0ATested%20with%20GIMP%2C%20online-convert.com%20and%20convert.io%20generated%20files.%0A%0A%27%0Avariables%20_bmpPalette%20_bmpIsRGB565%20_bmpPixelsOffset%20_bmpWidth%20_bmpHeight%20_bmpBPP%20_bmpCompression%20_bmpLine%20%0A%0A%20%20spec%20%27%20%27%20%27drawBMPfile%27%20%27display%20BMP%20file%20_%20at%20x%20_%20y%20_%27%20%27str%20num%20num%27%20%27image.bmp%27%200%200%0A%20%20space%0A%20%20spec%20%27r%27%20%27_bmp_readHeader%27%20%27_bmp_readHeader%20file%20_%27%20%27str%27%20%27%27%0A%20%20spec%20%27%20%27%20%27_bmp_drawBMP%27%20%27_bmp_drawBMP%20file%20_%20x%20_%20y%20_%27%20%27str%20num%20num%27%20%27%27%200%200%0A%20%20spec%20%27%20%27%20%27_bmp_drawBMPPixels%27%20%27_bmp_drawBMPPixels%20file%20_%20x%20_%20y%20_%20with%20function%20_%27%20%27str%20num%20num%20str%27%20%27%27%200%200%20%27%5Btft%3AsetPixel%5D%27%0A%20%20space%0A%20%20spec%20%27r%27%20%27_bmp_readPixelLine%27%20%27_bmp_readPixelLine%20file%20_%27%20%27str%27%20%27%27%0A%20%20spec%20%27r%27%20%27_bmp_16BitPixel%27%20%27_bmp_16BitPixel%20from%20_%20starting%20at%20_%27%20%27str%20num%27%20%27%27%201%0A%20%20spec%20%27r%27%20%27_bmp_24BitPixel%27%20%27_bmp_24BitPixel%20from%20_%20starting%20at%20_%27%20%27str%20num%27%20%27%27%201%0A%20%20spec%20%27%20%27%20%27_bmp_readPalette%27%20%27_bmp_readPalette%20file%20_%27%20%27auto%27%20%27%27%0A%20%20spec%20%27%20%27%20%27_bmp_readLine%27%20%27_bmp_readLine%20file%20_%27%20%27auto%27%20%27%27%0A%20%20spec%20%27r%27%20%27_bmp_line2indexes%27%20%27_bmp_line2indexes%27%0A%20%20spec%20%27r%27%20%27_bmp_RLEline%27%20%27_bmp_readRLELine%20file%20_%27%20%27auto%27%20%27%27%0A%20%20space%0A%20%20spec%20%27r%27%20%27_bmp_readInt16%27%20%27_bmp%20read%20int16%20file%20_%27%20%27str%27%20%27%27%0A%20%20spec%20%27r%27%20%27_bmp_readInt32%27%20%27_bmp%20read%20int32%20file%20_%27%20%27str%27%20%27%27%0A%20%20spec%20%27%20%27%20%27_bmp_alignLineData%27%20%27_bmp_alignLineData%20file%20_%27%20%27auto%27%20%27%27%0A%0Ato%20%27_bmp_16BitPixel%27%20data%20i%20%7B%0A%20%20local%20%27pixel%27%20%28%28%28at%20%28i%20%2B%201%29%20data%29%20%3C%3C%208%29%20%7C%20%28at%20i%20data%29%29%0A%20%20if%20_bmpIsRGB565%20%7B%0A%20%20%20%20local%20%27r%27%20%28%28pixel%20%3E%3E%208%29%20%26%20248%29%0A%20%20%20%20local%20%27g%27%20%28%28pixel%20%3E%3E%203%29%20%26%20248%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27r%27%20%28%28pixel%20%3E%3E%207%29%20%26%20248%29%0A%20%20%20%20local%20%27g%27%20%28%28pixel%20%3E%3E%202%29%20%26%20248%29%0A%20%20%7D%0A%20%20local%20%27b%27%20%28%28pixel%20%26%2031%29%20%3C%3C%203%29%0A%20%20return%20%28%28r%20%3C%3C%2016%29%20%7C%20%28%28g%20%3C%3C%208%29%20%7C%20b%29%29%0A%7D%0A%0Ato%20%27_bmp_24BitPixel%27%20data%20i%20%7B%0A%20%20return%20%28%28%28%28at%20%28i%20%2B%202%29%20data%29%20%3C%3C%2016%29%20%7C%20%28%28at%20%28i%20%2B%201%29%20data%29%20%3C%3C%208%29%29%20%7C%20%28at%20i%20data%29%29%0A%7D%0A%0Ato%20%27_bmp_RLEline%27%20filename%20%7B%0A%20%20local%20%27result%27%20%28%27%5Bdata%3AnewByteArray%5D%27%200%29%0A%20%20forever%20%7B%0A%20%20%20%20if%20%28%28%28%27%5Bfile%3AreadPosition%5D%27%20filename%29%20%26%201%29%20%3D%3D%201%29%20%7Bfile_SkipBytes%201%20filename%7D%0A%20%20%20%20local%20%27rle%27%20%28%27%5Bfile%3AreadBytes%5D%27%202%20filename%29%0A%20%20%20%20if%20%28%28at%201%20rle%29%20%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20if%20%28%28at%202%20rle%29%20%3E%202%29%20%7B%0A%20%20%20%20%20%20%20%20comment%20%27odd%20numbers%20for%20RL4%3F%27%0A%20%20%20%20%20%20%20%20result%20%3D%20%28%27%5Bdata%3Ajoin%5D%27%20result%20%28%27%5Bfile%3AreadBytes%5D%27%20%28%28%28%28at%202%20rle%29%20%2A%20_bmpBPP%29%20%2B%207%29%20%2F%208%29%20filename%29%29%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20return%20result%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20result%20%3D%20%28%27%5Bdata%3Ajoin%5D%27%20result%20%28%27%5Bdata%3AnewByteArray%5D%27%20%28%28%28%28at%201%20rle%29%20%2A%20_bmpBPP%29%20%2B%207%29%20%2F%208%29%20%28at%202%20rle%29%29%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Ato%20%27_bmp_alignLineData%27%20filename%20%7B%0A%20%20if%20%28and%20%28_bmpCompression%20%21%3D%201%29%20%28_bmpCompression%20%21%3D%202%29%29%20%7B%0A%20%20%20%20local%20%27padding%27%20%28%28%2832%20-%20%28%28_bmpWidth%20%2A%20_bmpBPP%29%20%25%2032%29%29%20%2F%208%29%20%25%204%29%0A%20%20%20%20if%20%28padding%20%3E%200%29%20%7B%0A%20%20%20%20%20%20file_SkipBytes%20padding%20filename%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Ato%20%27_bmp_drawBMP%27%20filename%20originX%20originY%20%7B%0A%20%20%27%5Bfile%3AsetReadPosition%5D%27%20_bmpPixelsOffset%20filename%0A%20%20if%20%28_bmpHeight%20%3E%3D%200%29%20%7B%0A%20%20%20%20local%20%27y%27%20%28%28originY%20%2B%20_bmpHeight%29%20-%201%29%0A%20%20%20%20local%20%27yIncrement%27%20-1%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27y%27%20originY%0A%20%20%20%20local%20%27yIncrement%27%201%0A%20%20%7D%0A%20%20local%20%27optimize%27%20%28%28boardType%29%20%21%3D%20%27Boardie%27%29%0A%20%20repeat%20%28absoluteValue%20_bmpHeight%29%20%7B%0A%20%20%20%20local%20%27line%27%20%28%27_bmp_readPixelLine%27%20filename%29%0A%20%20%20%20if%20optimize%20%7B%0A%20%20%20%20%20%20local%20%27rep%27%201%0A%20%20%20%20%20%20local%20%27lastColor%27%20%28at%201%20line%29%0A%20%20%20%20%20%20for%20x%20%28size%20line%29%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%28at%20x%20line%29%20%21%3D%20lastColor%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%27%5Btft%3Aline%5D%27%20%28%28x%20-%20rep%29%20%2B%20originX%29%20y%20%28%28x%20-%201%29%20%2B%20originX%29%20y%20lastColor%0A%20%20%20%20%20%20%20%20%20%20lastColor%20%3D%20%28at%20x%20line%29%0A%20%20%20%20%20%20%20%20%20%20rep%20%3D%201%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20rep%20%2B%3D%201%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%27%5Btft%3Aline%5D%27%20%28%28x%20-%20rep%29%20%2B%20originX%29%20y%20%28%28x%20-%201%29%20%2B%20originX%29%20y%20lastColor%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20for%20x%20%28size%20line%29%20%7B%0A%20%20%20%20%20%20%20%20%27%5Btft%3AsetPixel%5D%27%20%28%28x%20-%201%29%20%2B%20originX%29%20y%20%28at%20x%20line%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20y%20%2B%3D%20yIncrement%0A%20%20%7D%0A%7D%0A%0Ato%20%27_bmp_drawBMPPixels%27%20filename%20originX%20originY%20setPixelFunction%20%7B%0A%20%20comment%20%27Much%20slower%20than%20_bmp_drawBMP%20but%20allows%20client%20to%20supply%0Aa%20setPixelFunction%2C%20so%20it%20can%20be%20used%20to%20draw%20a%20BMP%20file%0Afile%20onto%20other%20devices%20such%20as%20a%20NeoPixel%20panel.%27%0A%20%20%27%5Bfile%3AsetReadPosition%5D%27%20_bmpPixelsOffset%20filename%0A%20%20if%20%28_bmpHeight%20%3E%3D%200%29%20%7B%0A%20%20%20%20local%20%27y%27%20%28%28originY%20%2B%20_bmpHeight%29%20-%201%29%0A%20%20%20%20local%20%27yIncrement%27%20-1%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27y%27%20originY%0A%20%20%20%20local%20%27yIncrement%27%201%0A%20%20%7D%0A%20%20local%20%27parameters%27%20%28newList%203%29%0A%20%20repeat%20%28absoluteValue%20_bmpHeight%29%20%7B%0A%20%20%20%20local%20%27line%27%20%28%27_bmp_readPixelLine%27%20filename%29%0A%20%20%20%20for%20x%20%28size%20line%29%20%7B%0A%20%20%20%20%20%20atPut%201%20parameters%20%28originX%20%2B%20%28x%20-%201%29%29%0A%20%20%20%20%20%20atPut%202%20parameters%20y%0A%20%20%20%20%20%20atPut%203%20parameters%20%28at%20x%20line%29%0A%20%20%20%20%20%20callCustomCommand%20setPixelFunction%20parameters%0A%20%20%20%20%7D%0A%20%20%20%20y%20%2B%3D%20yIncrement%0A%20%20%7D%0A%7D%0A%0Ato%20%27_bmp_line2indexes%27%20%7B%0A%20%20local%20%27mask%27%20%28%281%20%3C%3C%20_bmpBPP%29%20-%201%29%0A%20%20local%20%27result%27%20%28%27%5Bdata%3AnewByteArray%5D%27%200%29%0A%20%20local%20%27i%27%201%0A%20%20repeatUntil%20%28%28size%20result%29%20%3D%3D%20_bmpWidth%29%20%7B%0A%20%20%20%20local%20%27byte%27%20%28at%20i%20_bmpLine%29%0A%20%20%20%20local%20%27b%27%20%288%20%2F%20_bmpBPP%29%0A%20%20%20%20repeatUntil%20%28or%20%28b%20%3C%201%29%20%28%28size%20result%29%20%3D%3D%20_bmpWidth%29%29%20%7B%0A%20%20%20%20%20%20b%20%2B%3D%20-1%0A%20%20%20%20%20%20result%20%3D%20%28%27%5Bdata%3Ajoin%5D%27%20result%20%28%27%5Bdata%3AasByteArray%5D%27%20%28%28byte%20%3E%3E%20%28_bmpBPP%20%2A%20b%29%29%20%26%20mask%29%29%29%0A%20%20%20%20%7D%0A%20%20%20%20i%20%2B%3D%201%0A%20%20%7D%0A%20%20return%20result%0A%7D%0A%0Ato%20%27_bmp_readHeader%27%20filename%20%7B%0A%20%20if%20%28%28%27%5Bfile%3AfileSize%5D%27%20filename%29%20%3C%200%29%20%7B%0A%20%20%20%20sayIt%20%27File%20not%20found%3A%20%27%20filename%0A%20%20%20%20return%20%27false%27%0A%20%20%7D%0A%20%20%27%5Bfile%3Aopen%5D%27%20filename%0A%20%20if%20%28or%20%28%28%27%5Bfile%3AfileSize%5D%27%20filename%29%20%3C%2054%29%20%28%27BM%27%20%21%3D%20%28%27%5Bdata%3Ajoin%5D%27%20%27%27%20%28%27%5Bfile%3AreadBytes%5D%27%202%20filename%29%29%29%29%20%7B%0A%20%20%20%20sayIt%20%27Not%20a%20BMP%20file%3A%20%27%20filename%0A%20%20%20%20return%20false%0A%20%20%7D%0A%20%20file_SkipBytes%208%20filename%0A%20%20_bmpPixelsOffset%20%3D%20%28%27_bmp_readInt32%27%20filename%29%0A%20%20local%20%27headerSize%27%20%28%27_bmp_readInt32%27%20filename%29%0A%20%20_bmpWidth%20%3D%20%28%27_bmp_readInt32%27%20filename%29%0A%20%20_bmpHeight%20%3D%20%28%27_bmp_readInt32%27%20filename%29%0A%20%20file_SkipBytes%202%20filename%0A%20%20_bmpBPP%20%3D%20%28%27_bmp_readInt16%27%20filename%29%0A%20%20_bmpCompression%20%3D%20%28%27_bmp_readInt32%27%20filename%29%0A%20%20if%20%28_bmpCompression%20%3E%203%29%20%7B%0A%20%20%20%20sayIt%20%28%27%5Bdata%3Ajoin%5D%27%20%27Unsupported%20compression%20method%3A%20%27%20_bmpCompression%29%0A%20%20%20%20return%20false%0A%20%20%7D%0A%20%20_bmpPalette%20%3D%200%0A%20%20if%20%28_bmpBPP%20%3C%3D%208%29%20%7B%0A%20%20%20%20file_SkipBytes%2012%20filename%0A%20%20%20%20local%20%27palSize%27%20%28%27_bmp_readInt16%27%20filename%29%0A%20%20%20%20if%20%28palSize%20%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20palSize%20%3D%20%281%20%3C%3C%20_bmpBPP%29%0A%20%20%20%20%7D%0A%20%20%20%20_bmpPalette%20%3D%20%28newList%20palSize%29%0A%20%20%20%20file_SkipBytes%20%28headerSize%20-%2034%29%20filename%0A%20%20%20%20%27_bmp_readPalette%27%20filename%0A%20%20%7D%20else%20%7B%0A%20%20%20%20_bmpIsRGB565%20%3D%20%28booleanConstant%20false%29%0A%20%20%20%20if%20%28_bmpCompression%20%3D%3D%203%29%20%7B%0A%20%20%20%20%20%20file_SkipBytes%2020%20filename%0A%20%20%20%20%20%20comment%20%27BITFIELD%20%20Red%27%0A%20%20%20%20%20%20_bmpIsRGB565%20%3D%20%28%28%27_bmp_readInt32%27%20filename%29%20%3D%3D%20%28hexToInt%20%27F800%27%29%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20return%20true%0A%7D%0A%0Ato%20%27_bmp_readInt16%27%20filename%20%7B%0A%20%20local%20%27data%27%20%28%27%5Bfile%3AreadBytes%5D%27%202%20filename%29%0A%20%20return%20%28%28%28at%202%20data%29%20%3C%3C%208%29%20%7C%20%28at%201%20data%29%29%0A%7D%0A%0Ato%20%27_bmp_readInt32%27%20filename%20%7B%0A%20%20local%20%27data%27%20%28%27%5Bfile%3AreadBytes%5D%27%204%20filename%29%0A%20%20return%20%28%28%28%28at%204%20data%29%20%3C%3C%2024%29%20%7C%20%28%28at%203%20data%29%20%3C%3C%2016%29%29%20%7C%20%28%28%28at%202%20data%29%20%3C%3C%208%29%20%7C%20%28at%201%20data%29%29%29%0A%7D%0A%0Ato%20%27_bmp_readLine%27%20filename%20%7B%0A%20%20if%20%28or%20%28_bmpCompression%20%3D%3D%201%29%20%28_bmpCompression%20%3D%3D%202%29%29%20%7B%0A%20%20%20%20_bmpLine%20%3D%20%28%27_bmp_RLEline%27%20filename%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20_bmpLine%20%3D%20%28%27%5Bfile%3AreadBytes%5D%27%20%28%28%28_bmpWidth%20%2A%20_bmpBPP%29%20%2B%207%29%20%2F%208%29%20filename%29%0A%20%20%7D%0A%20%20if%20%28_bmpBPP%20%3C%208%29%20%7B%0A%20%20%20%20local%20%27indexes%27%20%28%27_bmp_line2indexes%27%29%0A%20%20%20%20_bmpLine%20%3D%20indexes%0A%20%20%7D%0A%7D%0A%0Ato%20%27_bmp_readPalette%27%20filename%20%7B%0A%20%20for%20i%20%28size%20_bmpPalette%29%20%7B%0A%20%20%20%20local%20%27data%27%20%28%27%5Bfile%3AreadBytes%5D%27%204%20filename%29%0A%20%20%20%20local%20%27color%27%20%28%28%28at%203%20data%29%20%3C%3C%2016%29%20%7C%20%28%28%28at%202%20data%29%20%3C%3C%208%29%20%7C%20%28at%201%20data%29%29%29%0A%20%20%20%20atPut%20i%20_bmpPalette%20color%0A%20%20%7D%0A%7D%0A%0Ato%20%27_bmp_readPixelLine%27%20filename%20%7B%0A%20%20local%20%27result%27%20%28%27%5Bdata%3AmakeList%5D%27%29%0A%20%20%27_bmp_readLine%27%20filename%0A%20%20if%20%28_bmpBPP%20%3C%3D%208%29%20%7B%0A%20%20%20%20for%20i%20_bmpLine%20%7B%0A%20%20%20%20%20%20%27%5Bdata%3AaddLast%5D%27%20%28at%20%28i%20%2B%201%29%20_bmpPalette%29%20result%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27i%27%201%0A%20%20%20%20repeatUntil%20%28%28size%20result%29%20%3D%3D%20_bmpWidth%29%20%7B%0A%20%20%20%20%20%20if%20%28_bmpBPP%20%3D%3D%2016%29%20%7B%0A%20%20%20%20%20%20%20%20%27%5Bdata%3AaddLast%5D%27%20%28%27_bmp_16BitPixel%27%20_bmpLine%20i%29%20result%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%27%5Bdata%3AaddLast%5D%27%20%28%27_bmp_24BitPixel%27%20_bmpLine%20i%29%20result%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20i%20%2B%3D%20%28maximum%20%28_bmpBPP%20%2F%208%29%201%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%27_bmp_alignLineData%27%20filename%0A%20%20return%20result%0A%7D%0A%0Ato%20drawBMPfile%20filename%20originX%20originY%20%7B%0A%20%20if%20%28%27_bmp_readHeader%27%20filename%29%20%7B%0A%20%20%20%20%27_bmp_drawBMP%27%20filename%20originX%20originY%0A%20%20%20%20%27%5Bfile%3Aclose%5D%27%20filename%0A%20%20%7D%0A%7D%0A%0A%0Amodule%20Files%20Data%0Aauthor%20MicroBlocks%0Aversion%201%203%20%0Adescription%20%27Flash%20file%20system%20operations.%20Currently%20supports%20the%20LittleFS%20file%20system%20on%20ESP8266%20and%20ESP32%20boards.%20The%20GnuBlocks%20virtual%20machine%20%28Linux%20and%20Raspberry%20Pi%29%20supports%20the%20native%20system.%27%0A%0A%20%20spec%20%27%20%27%20%27%5Bfile%3Aopen%5D%27%20%27open%20file%20_%27%20%27str%27%0A%20%20spec%20%27%20%27%20%27%5Bfile%3Aclose%5D%27%20%27close%20file%20_%27%20%27str%27%0A%20%20spec%20%27%20%27%20%27%5Bfile%3Adelete%5D%27%20%27delete%20file%20_%27%20%27str%27%0A%20%20space%0A%20%20spec%20%27%20%27%20%27%5Bfile%3AappendLine%5D%27%20%27append%20line%20_%20to%20file%20_%27%20%27str%20str%27%0A%20%20spec%20%27%20%27%20%27%5Bfile%3AappendBytes%5D%27%20%27append%20bytes%20_%20to%20file%20_%27%20%27str%20str%27%0A%20%20space%0A%20%20spec%20%27r%27%20%27%5Bfile%3AendOfFile%5D%27%20%27end%20of%20file%20_%27%20%27str%27%0A%20%20spec%20%27r%27%20%27%5Bfile%3AreadLine%5D%27%20%27next%20line%20of%20file%20_%27%20%27str%27%0A%20%20spec%20%27r%27%20%27%5Bfile%3AreadBytes%5D%27%20%27next%20_%20bytes%20of%20file%20_%20%3A%20starting%20at%20_%27%20%27num%20str%20num%27%20100%20%27%27%200%0A%20%20spec%20%27r%27%20%27%5Bfile%3AreadInto%5D%27%20%27read%20into%20_%20from%20file%20_%27%20%27str%20str%27%20%27a%20ByteArray%27%20%27%27%0A%20%20space%0A%20%20spec%20%27r%27%20%27%5Bfile%3AreadPosition%5D%27%20%27read%20position%20of%20file%20_%27%20%27str%27%0A%20%20spec%20%27%20%27%20%27%5Bfile%3AsetReadPosition%5D%27%20%27set%20read%20position%20_%20of%20file%20_%27%20%27num%20str%27%200%20%27%27%0A%20%20spec%20%27%20%27%20%27file_SkipBytes%27%20%27skip%20_%20bytes%20of%20file%20_%27%20%27num%20str%27%204%20%27%27%0A%20%20space%0A%20%20spec%20%27r%27%20%27file%20names%27%20%27file%20names%20%3A%20in%20directory%20_%27%20%27str%27%0A%20%20spec%20%27r%27%20%27%5Bfile%3AfileSize%5D%27%20%27size%20of%20file%20_%27%20%27str%27%0A%20%20spec%20%27r%27%20%27%5Bfile%3AsystemInfo%5D%27%20%27file%20system%20info%27%0A%0Ato%20%27file%20names%27%20dir%20%7B%0A%20%20%27%5Bfile%3AstartList%5D%27%20dir%0A%20%20local%20%27result%27%20%28%27%5Bdata%3AmakeList%5D%27%29%0A%20%20local%20%27fileName%27%20%28%27%5Bfile%3AnextInList%5D%27%29%0A%20%20repeatUntil%20%28fileName%20%3D%3D%20%27%27%29%20%7B%0A%20%20%20%20%27%5Bdata%3AaddLast%5D%27%20fileName%20result%0A%20%20%20%20fileName%20%3D%20%28%27%5Bfile%3AnextInList%5D%27%29%0A%20%20%7D%0A%20%20return%20result%0A%7D%0A%0Ato%20file_SkipBytes%20offset%20file%20%7B%0A%20%20local%20%27newPosition%27%20%28%28%27%5Bfile%3AreadPosition%5D%27%20file%29%20%2B%20offset%29%0A%20%20%27%5Bfile%3AsetReadPosition%5D%27%20newPosition%20file%0A%7D%0A%0A%0Amodule%20NeoPanel%20Output%0Aauthor%20%27Jos%C3%A9%20Garc%C3%ADa%20Yeste%20%26%20V%C3%ADctor%20Casado%27%0Aversion%201%201%20%0Adepends%20NeoPixel%20BMP%20%0Adescription%20%27Draw%20lines%2C%20rectangles%2C%20text%2C%20and%20images%20on%20a%20NeoPixel%20panels%20%28e.g.%208x8%2C%2016x16%20or%2032x8%29%20in%20either%20horizontal%20or%20vertical%20orientation.%20Panels%20can%20be%20daisy-chained%20to%20create%20larger%20displays%20if%20there%20is%20sufficient%20power%20to%20drive%20them.%0ASee%3A%20https%3A%2F%2Fwww.btf-lighting.com%2Fcollections%2Fled-matrix-display%2Fproducts%2Fws2812b-panel-screen-8-8-16-16-8-32-pixel-256-pixels-digital-flexible-led-programmed-individually-addressable-full-color-dc5v%23%0A%27%0Avariables%20_neoPanel_width%20_neoPanel_height%20_neoPanel_isHorizontal%20%0A%0A%20%20spec%20%27%20%27%20%27neoPanel_attach%27%20%27attach%20NeoPixel%20panel%20width%20_%20height%20_%20at%20pin%20_%27%20%27num%20num%20num%27%208%208%201%0A%20%20space%0A%20%20spec%20%27%20%27%20%27neoPanel_drawPixel%27%20%27NeoPanel%20set%20x%20_%20y%20_%20color%20_%27%20%27num%20num%20color%27%201%201%0A%20%20spec%20%27%20%27%20%27neoPanel_drawVerticalLine%27%20%27NeoPanel%20fill%20column%20_%20color%20_%27%20%27num%20color%27%201%0A%20%20spec%20%27%20%27%20%27neoPanel_drawHorizontalLine%27%20%27NeoPanel%20fill%20row%20_%20color%20_%27%20%27num%20color%27%201%0A%20%20spec%20%27%20%27%20%27neoPanel_fillRectangle%27%20%27NeoPanel%20fill%20rectangle%20x%20_%20y%20_%20width%20_%20height%20_%20color%20_%27%20%27num%20num%20num%20num%20color%27%201%201%204%204%0A%20%20space%0A%20%20spec%20%27%20%27%20%27neoPanel_drawText%27%20%27NeoPanel%20draw%20text%20_%20at%20x%20_%20y%20_%20color%20_%27%20%27str%20num%20num%20color%27%20%27HELLO%27%201%201%0A%20%20spec%20%27%20%27%20%27neoPanel_drawBMP%27%20%27NeoPanel%20draw%20BMP%20file%20_%20at%20x%20_%20y%20_%27%20%27str%20num%20num%27%20%27%27%201%201%0A%20%20space%0A%20%20spec%20%27r%27%20%27_neoPanel_indexForXY%27%20%27_neoPanel_index%20for%20x%20_%20y%20_%27%20%27num%20num%27%201%201%0A%0Ato%20%27_neoPanel_indexForXY%27%20x%20y%20%7B%0A%20%20if%20%28or%20%28x%20%3C%201%29%20%28y%20%3C%201%29%29%20%7Breturn%200%7D%0A%20%20if%20%28or%20%28x%20%3E%20_neoPanel_width%29%20%28y%20%3E%20_neoPanel_height%29%29%20%7Breturn%200%7D%0A%20%20if%20_neoPanel_isHorizontal%20%7B%0A%20%20%20%20if%20%28%28x%20%26%201%29%20%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20return%20%28%28%28x%20-%201%29%20%2A%20_neoPanel_height%29%20%2B%20%28%28_neoPanel_height%20-%20y%29%20%2B%201%29%29%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20%28%28%28x%20-%201%29%20%2A%20_neoPanel_height%29%20%2B%20y%29%0A%20%20%20%20%7D%0A%20%20%7D%20else%20%7B%0A%20%20%20%20if%20%28%28y%20%26%201%29%20%3D%3D%200%29%20%7B%0A%20%20%20%20%20%20return%20%28%28%28y%20-%201%29%20%2A%20_neoPanel_width%29%20%2B%20x%29%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20return%20%28%28%28y%20-%201%29%20%2A%20_neoPanel_width%29%20%2B%20%28%28_neoPanel_width%20-%20x%29%20%2B%201%29%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Ato%20neoPanel_attach%20width%20height%20pin%20%7B%0A%20%20_neoPanel_width%20%3D%20width%0A%20%20_neoPanel_height%20%3D%20height%0A%20%20_neoPanel_isHorizontal%20%3D%20%28width%20%3E%3D%20height%29%0A%20%20neoPixelAttach%20%28_neoPanel_width%20%2A%20_neoPanel_height%29%20pin%0A%7D%0A%0Ato%20neoPanel_drawBMP%20filename%20originX%20originY%20%7B%0A%20%20if%20%28not%20%28%27_bmp_readHeader%27%20filename%29%29%20%7Breturn%7D%0A%20%20%27%5Bfile%3AsetReadPosition%5D%27%20_bmpPixelsOffset%20filename%0A%20%20if%20%28_bmpHeight%20%3E%3D%200%29%20%7B%0A%20%20%20%20local%20%27y%27%20%28%28originY%20%2B%20_bmpHeight%29%20-%201%29%0A%20%20%20%20local%20%27yIncrement%27%20-1%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27y%27%20originY%0A%20%20%20%20local%20%27yIncrement%27%201%0A%20%20%7D%0A%20%20repeat%20%28absoluteValue%20_bmpHeight%29%20%7B%0A%20%20%20%20local%20%27line%27%20%28%27_bmp_readPixelLine%27%20filename%29%0A%20%20%20%20for%20x%20%28size%20line%29%20%7B%0A%20%20%20%20%20%20local%20%27pixel%27%20%28%27_neoPanel_indexForXY%27%20%28originX%20%2B%20%28x%20-%201%29%29%20y%29%0A%20%20%20%20%20%20if%20%28pixel%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20atPut%20pixel%20_np_pixels%20%28at%20x%20line%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20y%20%2B%3D%20yIncrement%0A%20%20%7D%0A%20%20%27%5Bfile%3Aclose%5D%27%20filename%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20neoPanel_drawHorizontalLine%20y%20color%20%7B%0A%20%20if%20%28and%20%28y%20%3E%200%29%20%28y%20%3C%3D%20_neoPanel_width%29%29%20%7B%0A%20%20%20%20if%20_neoPanel_isHorizontal%20%7B%0A%20%20%20%20%20%20local%20%27index%27%20%28%28%28y%20-%201%29%20%2A%20_neoPanel_height%29%20%2B%201%29%0A%20%20%20%20%20%20repeat%20_neoPanel_height%20%7B%0A%20%20%20%20%20%20%20%20atPut%20index%20_np_pixels%20color%0A%20%20%20%20%20%20%20%20index%20%2B%3D%201%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20local%20%27index%27%20%28%28_neoPanel_width%20-%20y%29%20%2B%201%29%0A%20%20%20%20%20%20repeat%20%28_neoPanel_height%20%2F%202%29%20%7B%0A%20%20%20%20%20%20%20%20atPut%20index%20_np_pixels%20color%0A%20%20%20%20%20%20%20%20index%20%2B%3D%20%28%28%28y%20-%201%29%20%2A%202%29%20%2B%201%29%0A%20%20%20%20%20%20%20%20atPut%20index%20_np_pixels%20color%0A%20%20%20%20%20%20%20%20index%20%2B%3D%20%28%28%28%28_neoPanel_width%20-%20y%29%20%2B%201%29%20%2A%202%29%20-%201%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20%27_NeoPixel_update%27%0A%20%20%7D%0A%7D%0A%0Ato%20neoPanel_drawPixel%20x%20y%20color%20%7B%0A%20%20setNeoPixelColor%20%28%27_neoPanel_indexForXY%27%20x%20y%29%20color%0A%7D%0A%0Ato%20neoPanel_drawText%20text%20x0%20y0%20color%20%7B%0A%20%20for%20letter%20text%20%7B%0A%20%20%20%20local%20%27shape%27%20%28%27%5Bdisplay%3AmbShapeForLetter%5D%27%20letter%29%0A%20%20%20%20local%20%27mask%27%201%0A%20%20%20%20local%20%27x%27%20%28x0%20-%201%29%0A%20%20%20%20local%20%27y%27%20%28y0%20-%201%29%0A%20%20%20%20for%20c%205%20%7B%0A%20%20%20%20%20%20for%20f%205%20%7B%0A%20%20%20%20%20%20%20%20if%20%28%28shape%20%26%20mask%29%20%21%3D%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20local%20%27i%27%20%28%27_neoPanel_indexForXY%27%20%28x%20%2B%20f%29%20%28y%20%2B%20c%29%29%0A%20%20%20%20%20%20%20%20%20%20if%20%28i%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20atPut%20i%20_np_pixels%20color%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20mask%20%3D%20%28mask%20%3C%3C%201%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20if%20_neoPanel_isHorizontal%20%7B%0A%20%20%20%20%20%20x0%20%2B%3D%205%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20y0%20%2B%3D%206%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20neoPanel_drawVerticalLine%20x%20color%20%7B%0A%20%20if%20%28and%20%28x%20%3E%200%29%20%28x%20%3C%3D%20_neoPanel_height%29%29%20%7B%0A%20%20%20%20if%20_neoPanel_isHorizontal%20%7B%0A%20%20%20%20%20%20local%20%27index%27%20x%0A%20%20%20%20%20%20repeat%20%28_neoPanel_width%20%2F%202%29%20%7B%0A%20%20%20%20%20%20%20%20atPut%20index%20_np_pixels%20color%0A%20%20%20%20%20%20%20%20index%20%2B%3D%20%28%28%28_neoPanel_height%20-%20x%29%20%2A%202%29%20%2B%201%29%0A%20%20%20%20%20%20%20%20atPut%20index%20_np_pixels%20color%0A%20%20%20%20%20%20%20%20index%20%2B%3D%20%28%28x%20%2A%202%29%20-%201%29%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20local%20%27index%27%20%28%28%28x%20-%201%29%20%2A%20_neoPanel_width%29%20%2B%201%29%0A%20%20%20%20%20%20atPut%20index%20_np_pixels%20color%0A%20%20%20%20%20%20repeat%20_neoPanel_width%20%7B%0A%20%20%20%20%20%20%20%20atPut%20index%20_np_pixels%20color%0A%20%20%20%20%20%20%20%20index%20%2B%3D%201%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20%27_NeoPixel_update%27%0A%20%20%7D%0A%7D%0A%0Ato%20neoPanel_fillRectangle%20x%20y%20width%20height%20color%20%7B%0A%20%20local%20%27column%27%20y%0A%20%20repeat%20height%20%7B%0A%20%20%20%20local%20%27row%27%20x%0A%20%20%20%20repeat%20width%20%7B%0A%20%20%20%20%20%20atPut%20%28%27_neoPanel_indexForXY%27%20row%20column%29%20_np_pixels%20color%0A%20%20%20%20%20%20row%20%2B%3D%201%0A%20%20%20%20%7D%0A%20%20%20%20column%20%2B%3D%201%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0A%0Amodule%20NeoPixel%20Output%0Aauthor%20MicroBlocks%0Aversion%201%205%20%0Adescription%20%27Control%20NeoPixel%20%28WS2812%29%20RGB%20LED%20strips%20and%20rings.%0A%27%0Avariables%20_np_pixels%20%0A%0A%20%20spec%20%27%20%27%20%27neoPixelAttach%27%20%27attach%20_%20LED%20NeoPixel%20strip%20to%20pin%20_%20%3A%20has%20white%20_%27%20%27num%20auto%20bool%27%2010%20%27%27%20false%0A%20%20spec%20%27%20%27%20%27setNeoPixelColors10%27%20%27set%20NeoPixels%20_%20_%20_%20_%20_%20_%20_%20_%20_%20_%27%20%27color%20color%20color%20color%20color%20color%20color%20color%20color%20color%27%0A%20%20spec%20%27%20%27%20%27clearNeoPixels%27%20%27clear%20NeoPixels%27%0A%20%20spec%20%27%20%27%20%27neoPixelSetAllToColor%27%20%27set%20all%20NeoPixels%20color%20_%27%20%27color%27%0A%20%20spec%20%27%20%27%20%27setNeoPixelColor%27%20%27set%20NeoPixel%20_%20color%20_%27%20%27num%20color%27%201%0A%20%20space%0A%20%20spec%20%27r%27%20%27colorFromRGB%27%20%27color%20r%20_%20g%20_%20b%20_%20%280-255%29%27%20%27num%20num%20num%27%200%20100%20100%0A%20%20spec%20%27r%27%20%27randomColor%27%20%27random%20color%27%0A%20%20space%0A%20%20spec%20%27%20%27%20%27rotateNeoPixelsBy%27%20%27rotate%20NeoPixels%20by%20_%27%20%27auto%27%201%0A%20%20spec%20%27%20%27%20%27NeoPixel_brighten%27%20%27brighten%20NeoPixel%20_%20by%20_%27%20%27num%20num%27%201%2010%0A%20%20spec%20%27%20%27%20%27NeoPixel_brighten_all%27%20%27brighten%20all%20NeoPixels%20by%20_%27%20%27num%27%2010%0A%20%20space%0A%20%20spec%20%27%20%27%20%27_NeoPixel_ensureInitialized%27%20%27_NeoPixel_ensureInitialized%27%0A%20%20spec%20%27%20%27%20%27_NeoPixel_increaseRGB%27%20%27_NeoPixel_increaseRGB%20of%20_%20by%20_%27%20%27num%20num%27%201%2010%0A%20%20spec%20%27%20%27%20%27_NeoPixel_rotate%27%20%27_NeoPixel_rotate_left%20_%27%20%27bool%27%20true%0A%20%20spec%20%27%20%27%20%27_NeoPixel_update%27%20%27_NeoPixel_update%27%0A%0Ato%20NeoPixel_brighten%20i%20delta%20%7B%0A%20%20%27_NeoPixel_increaseRGB%27%20i%20delta%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20NeoPixel_brighten_all%20delta%20%7B%0A%20%20for%20i%20%28size%20_np_pixels%29%20%7B%0A%20%20%20%20%27_NeoPixel_increaseRGB%27%20i%20delta%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20%27_NeoPixel_ensureInitialized%27%20%7B%0A%20%20if%20%28_np_pixels%20%3D%3D%200%29%20%7Bif%20%28%28boardType%29%20%3D%3D%20%27M5Atom-Matrix%27%29%20%7B%0A%20%20%20%20neoPixelAttach%2025%20%27%27%20false%0A%20%20%7D%20%28%28boardType%29%20%3D%3D%20%27D1-Mini%27%29%20%7B%0A%20%20%20%20comment%20%27D1%20mini%20kit%27%0A%20%20%20%20neoPixelAttach%207%2015%20false%0A%20%20%7D%20%28%28boardType%29%20%3D%3D%20%27Mbits%27%29%20%7B%0A%20%20%20%20neoPixelAttach%2025%20%27%27%20false%0A%20%20%7D%20else%20%7B%0A%20%20%20%20neoPixelAttach%2010%20%27%27%20false%0A%20%20%7D%7D%0A%7D%0A%0Ato%20%27_NeoPixel_increaseRGB%27%20i%20delta%20%7B%0A%20%20if%20%28or%20%28i%20%3C%201%29%20%28i%20%3E%20%28size%20_np_pixels%29%29%29%20%7Breturn%7D%0A%20%20local%20%27rgb%27%20%28at%20i%20_np_pixels%29%0A%20%20if%20%28rgb%20%21%3D%200%29%20%7B%0A%20%20%20%20local%20%27r%27%20%28%28rgb%20%3E%3E%2016%29%20%26%20255%29%0A%20%20%20%20local%20%27g%27%20%28%28rgb%20%3E%3E%208%29%20%26%20255%29%0A%20%20%20%20local%20%27b%27%20%28rgb%20%26%20255%29%0A%20%20%20%20r%20%3D%20%28maximum%200%20%28minimum%20%28r%20%2B%20delta%29%20255%29%29%0A%20%20%20%20g%20%3D%20%28maximum%200%20%28minimum%20%28g%20%2B%20delta%29%20255%29%29%0A%20%20%20%20b%20%3D%20%28maximum%200%20%28minimum%20%28b%20%2B%20delta%29%20255%29%29%0A%20%20%20%20atPut%20i%20_np_pixels%20%28colorFromRGB%20r%20g%20b%29%0A%20%20%7D%0A%7D%0A%0Ato%20%27_NeoPixel_rotate%27%20left%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20local%20%27length%27%20%28size%20_np_pixels%29%0A%20%20if%20left%20%7B%0A%20%20%20%20local%20%27first%27%20%28at%201%20_np_pixels%29%0A%20%20%20%20for%20i%20%28length%20-%201%29%20%7B%0A%20%20%20%20%20%20atPut%20i%20_np_pixels%20%28at%20%28i%20%2B%201%29%20_np_pixels%29%0A%20%20%20%20%7D%0A%20%20%20%20atPut%20length%20_np_pixels%20first%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27last%27%20%28at%20length%20_np_pixels%29%0A%20%20%20%20for%20i%20%28length%20-%201%29%20%7B%0A%20%20%20%20%20%20atPut%20%28%28length%20-%20i%29%20%2B%201%29%20_np_pixels%20%28at%20%28length%20-%20i%29%20_np_pixels%29%0A%20%20%20%20%7D%0A%20%20%20%20atPut%201%20_np_pixels%20last%0A%20%20%7D%0A%7D%0A%0Ato%20%27_NeoPixel_update%27%20%7B%0A%20%20%27%5Bdisplay%3AneoPixelSend%5D%27%20_np_pixels%0A%20%20waitMicros%20100%0A%7D%0A%0Ato%20clearNeoPixels%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20fillList%20_np_pixels%200%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20colorFromRGB%20r%20g%20b%20%7B%0A%20%20r%20%3D%20%28maximum%200%20%28minimum%20r%20255%29%29%0A%20%20g%20%3D%20%28maximum%200%20%28minimum%20g%20255%29%29%0A%20%20b%20%3D%20%28maximum%200%20%28minimum%20b%20255%29%29%0A%20%20return%20%28%28%28r%20%3C%3C%2016%29%20%7C%20%28g%20%3C%3C%208%29%29%20%7C%20b%29%0A%7D%0A%0Ato%20neoPixelAttach%20number%20pinNumber%20optionalHasWhite%20%7B%0A%20%20hasWhite%20%3D%20false%0A%20%20if%20%28%28pushArgCount%29%20%3E%202%29%20%7B%0A%20%20%20%20hasWhite%20%3D%20optionalHasWhite%0A%20%20%7D%0A%20%20if%20%28or%20%28_np_pixels%20%3D%3D%200%29%20%28number%20%21%3D%20%28size%20_np_pixels%29%29%29%20%7B%0A%20%20%20%20_np_pixels%20%3D%20%28newList%20number%29%0A%20%20%7D%0A%20%20fillList%20_np_pixels%200%0A%20%20%27%5Bdisplay%3AneoPixelSetPin%5D%27%20pinNumber%20hasWhite%0A%7D%0A%0Ato%20neoPixelSetAllToColor%20color%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20fillList%20_np_pixels%20color%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20rotateNeoPixelsBy%20n%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20repeat%20%28absoluteValue%20n%29%20%7B%0A%20%20%20%20%27_NeoPixel_rotate%27%20%28n%20%3E%200%29%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20setNeoPixelColor%20i%20color%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20if%20%28and%20%281%20%3C%3D%20i%29%20%28i%20%3C%3D%20%28size%20_np_pixels%29%29%29%20%7B%0A%20%20%20%20atPut%20i%20_np_pixels%20color%0A%20%20%7D%0A%7D%0A%0Ato%20setNeoPixelColors10%20c1%20c2%20c3%20c4%20c5%20c6%20c7%20c8%20c9%20c10%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%201%29%20%7B%0A%20%20%20%20atPut%201%20_np_pixels%20c1%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%202%29%20%7B%0A%20%20%20%20atPut%202%20_np_pixels%20c2%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%203%29%20%7B%0A%20%20%20%20atPut%203%20_np_pixels%20c3%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%204%29%20%7B%0A%20%20%20%20atPut%204%20_np_pixels%20c4%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%205%29%20%7B%0A%20%20%20%20atPut%205%20_np_pixels%20c5%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%206%29%20%7B%0A%20%20%20%20atPut%206%20_np_pixels%20c6%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%207%29%20%7B%0A%20%20%20%20atPut%207%20_np_pixels%20c7%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%208%29%20%7B%0A%20%20%20%20atPut%208%20_np_pixels%20c8%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%209%29%20%7B%0A%20%20%20%20atPut%209%20_np_pixels%20c9%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%2010%29%20%7B%0A%20%20%20%20atPut%2010%20_np_pixels%20c10%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0A%0Amodule%20TFT%20Output%0Aauthor%20MicroBlocks%0Aversion%201%205%20%0Adescription%20%27Draw%20graphics%20and%20write%20text%20on%20boards%20with%20a%20TFT%20display%2C%20such%20as%20the%20M5Stack%2C%20M5Stick%2C%20Citilab%20ED1%20or%20%28discontinued%29%20IoT-Bus.%27%0A%0A%20%20spec%20%27%20%27%20%27%5Bdisplay%3AmbDisplayOff%5D%27%20%27clear%20display%27%0A%20%20space%0A%20%20spec%20%27%20%27%20%27%5Btft%3Arect%5D%27%20%27draw%20rectangle%20on%20TFT%20at%20x%20_%20y%20_%20width%20_%20height%20_%20color%20_%20%3A%20filled%20_%27%20%27num%20num%20num%20num%20color%20bool%27%2010%2010%2040%2030%20nil%20true%0A%20%20spec%20%27%20%27%20%27%5Btft%3AroundedRect%5D%27%20%27draw%20rounded%20rectangle%20on%20TFT%20at%20x%20_%20y%20_%20width%20_%20height%20_%20radius%20_%20color%20_%20%3A%20filled%20_%27%20%27num%20num%20num%20num%20num%20color%20bool%27%2010%2010%2040%2030%208%20nil%20true%0A%20%20spec%20%27%20%27%20%27%5Btft%3Acircle%5D%27%20%27draw%20circle%20on%20TFT%20at%20x%20_%20y%20_%20radius%20_%20color%20_%20%3A%20filled%20_%27%20%27num%20num%20num%20color%20bool%27%2040%2040%2030%20nil%20true%0A%20%20spec%20%27%20%27%20%27%5Btft%3Atriangle%5D%27%20%27draw%20triangle%20on%20TFT%20at%20x%20_%20y%20_%20%2C%20x%20_%20y%20_%20%2C%20x%20_%20y%20_%20color%20_%20%3A%20filled%20_%27%20%27num%20num%20num%20num%20num%20num%20color%20bool%27%2020%2020%2030%2080%2060%205%20nil%20true%0A%20%20spec%20%27%20%27%20%27%5Btft%3Atext%5D%27%20%27write%20_%20on%20TFT%20at%20x%20_%20y%20_%20color%20_%20%3A%20scale%20_%20wrap%20_%27%20%27str%20num%20num%20color%20num%20bool%27%20%27Hello%20World%21%27%205%205%20nil%202%20true%0A%20%20spec%20%27%20%27%20%27%5Btft%3Aline%5D%27%20%27draw%20line%20on%20TFT%20from%20x%20_%20y%20_%20to%20x%20_%20y%20_%20color%20_%27%20%27num%20num%20num%20num%20color%27%2012%208%2025%2015%0A%20%20spec%20%27%20%27%20%27%5Btft%3AsetPixel%5D%27%20%27set%20TFT%20pixel%20x%20_%20y%20_%20to%20_%27%20%27num%20num%20color%27%2010%2010%0A%20%20space%0A%20%20spec%20%27r%27%20%27makeColor%27%20%27color%20r%20_%20g%20_%20b%20_%20%280-255%29%27%20%27num%20num%20num%27%200%20100%20100%0A%20%20spec%20%27r%27%20%27makeGray%27%20%27gray%20_%20%25%27%20%27num%27%2050%0A%20%20spec%20%27r%27%20%27randomColor%27%20%27random%20color%27%0A%20%20space%0A%20%20spec%20%27r%27%20%27%5Btft%3AgetWidth%5D%27%20%27TFT%20width%27%0A%20%20spec%20%27r%27%20%27%5Btft%3AgetHeight%5D%27%20%27TFT%20height%27%0A%20%20space%0A%20%20spec%20%27%20%27%20%27%5Btft%3AsetBacklight%5D%27%20%27set%20TFT%20backlight%20_%20%280-10%29%27%20%27num%27%2010%0A%20%20space%0A%20%20spec%20%27%20%27%20%27_deferMonochromeDisplayUpdates%27%20%27_defer%20monochrome%20display%20updates%27%0A%20%20spec%20%27%20%27%20%27_resumeMonochromeDisplayUpdates%27%20%27_resume%20monochrome%20display%20updates%27%0A%0Ato%20%27_deferMonochromeDisplayUpdates%27%20%7B%0A%20%20%27%5Btft%3AdeferUpdates%5D%27%0A%7D%0A%0Ato%20%27_resumeMonochromeDisplayUpdates%27%20%7B%0A%20%20%27%5Btft%3AresumeUpdates%5D%27%0A%7D%0A%0Ato%20makeColor%20r%20g%20b%20%7B%0A%20%20r%20%3D%20%28maximum%200%20%28minimum%20r%20255%29%29%0A%20%20g%20%3D%20%28maximum%200%20%28minimum%20g%20255%29%29%0A%20%20b%20%3D%20%28maximum%200%20%28minimum%20b%20255%29%29%0A%20%20return%20%28%28r%20%3C%3C%2016%29%20%7C%20%28%28g%20%3C%3C%208%29%20%7C%20b%29%29%0A%7D%0A%0Ato%20makeGray%20percent%20%7B%0A%20%20gray%20%3D%20%28%28percent%20%2A%20255%29%20%2F%20100%29%0A%20%20gray%20%3D%20%28maximum%200%20%28minimum%20gray%20255%29%29%0A%20%20return%20%28%28gray%20%3C%3C%2016%29%20%7C%20%28%28gray%20%3C%3C%208%29%20%7C%20gray%29%29%0A%7D%0A%0Ato%20randomColor%20%7B%0A%20%20local%20%27n1%27%20%28random%20100%20200%29%0A%20%20local%20%27n2%27%20%28random%200%20100%29%0A%20%20if%20%281%20%3D%3D%20%28random%201%203%29%29%20%7B%0A%20%20%20%20return%20%28%28n1%20%3C%3C%2016%29%20%7C%20%28n2%20%3C%3C%208%29%29%0A%20%20%7D%20%281%20%3D%3D%20%28random%201%202%29%29%20%7B%0A%20%20%20%20return%20%28%28n2%20%3C%3C%2016%29%20%7C%20n1%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20%28%28n1%20%3C%3C%208%29%20%7C%20n2%29%0A%20%20%7D%0A%7D%0A%0A">查看/编辑 程序</a></p>
<!--
### 方法 2: NeoPixel Matrix

![](/post/img/dotpack-snow-crash6.png)

[查看/编辑 程序](https://microblocksfun.cn/run/microblocks.html#project=projectName%20%27%27%0A%0Amodule%20main%0Aauthor%20unknown%0Aversion%201%200%20%0Adescription%20%27%27%0A%0A%09spec%20%27%20%27%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%0A%0Ato%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%7B%0A%20%20for%20i%2016%20%7B%0A%20%20%20%20for%20j%2016%20%7B%0A%20%20%20%20%20%20if%20%28%28random%201%202%29%20%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20set_pixel%20i%20j%20%28colorSwatch%20255%20255%20255%20255%29%20false%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20set_pixel%20i%20j%20%28colorSwatch%200%200%200%20255%29%20false%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%0A%7D%0A%0Ascript%2052%2034%20%7B%0Aforever%20%7B%0A%20%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%0A%20%20waitMillis%20100%0A%7D%0A%7D%0A%0Ascript%2047%20126%20%7B%0Ato%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%7B%7D%0A%7D%0A%0A%0Amodule%20NeoPixel%20Output%0Aauthor%20MicroBlocks%0Aversion%201%202%20%0Atags%20led%20strip%20rgb%20string%20ws2812%20%0Adescription%20%27Control%20NeoPixel%20%28WS2812%29%20RGB%20LED%20strips.%0A%27%0Avariables%20_np_pixels%20%0A%0A%09spec%20%27%20%27%20%27neoPixelAttach%27%20%27attach%20_%20LED%20NeoPixel%20strip%20to%20pin%20_%20%3A%20has%20white%20_%27%20%27num%20auto%20bool%27%2010%20%27%27%20false%0A%09spec%20%27%20%27%20%27setNeoPixelColors10%27%20%27set%20NeoPixels%20_%20_%20_%20_%20_%20_%20_%20_%20_%20_%27%20%27color%20color%20color%20color%20color%20color%20color%20color%20color%20color%27%0A%09spec%20%27%20%27%20%27clearNeoPixels%27%20%27clear%20NeoPixels%27%0A%09spec%20%27%20%27%20%27neoPixelSetAllToColor%27%20%27set%20all%20NeoPixels%20color%20_%27%20%27color%27%0A%09spec%20%27%20%27%20%27setNeoPixelColor%27%20%27set%20NeoPixel%20_%20color%20_%27%20%27num%20color%27%201%0A%09spec%20%27%20%27%20%27rotateNeoPixelsBy%27%20%27rotate%20NeoPixels%20by%20_%27%20%27auto%27%201%0A%09spec%20%27r%27%20%27colorFromRGB%27%20%27color%20r%20_%20g%20_%20b%20_%20%280-255%29%27%20%27num%20num%20num%27%200%20100%20100%0A%09spec%20%27r%27%20%27randomColor%27%20%27random%20color%27%0A%09spec%20%27%20%27%20%27_NeoPixel_ensureInitialized%27%20%27_NeoPixel_ensureInitialized%27%0A%09spec%20%27%20%27%20%27_NeoPixel_rotate%27%20%27_NeoPixel_rotate_left%20_%27%20%27bool%27%20true%0A%09spec%20%27%20%27%20%27_NeoPixel_update%27%20%27_NeoPixel_update%27%0A%0Ato%20%27_NeoPixel_ensureInitialized%27%20%7B%0A%20%20if%20%28_np_pixels%20%3D%3D%200%29%20%7Bif%20%28%28boardType%29%20%3D%3D%20%27M5Atom-Matrix%27%29%20%7B%0A%20%20%20%20neoPixelAttach%2025%20%27%27%20false%0A%20%20%7D%20%28%28boardType%29%20%3D%3D%20%27D1-Mini%27%29%20%7B%0A%20%20%20%20comment%20%27D1%20mini%20kit%27%0A%20%20%20%20neoPixelAttach%207%2015%20false%0A%20%20%7D%20else%20%7B%0A%20%20%20%20neoPixelAttach%2010%20%27%27%20false%0A%20%20%7D%7D%0A%7D%0A%0Ato%20%27_NeoPixel_rotate%27%20left%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20local%20%27length%27%20%28size%20_np_pixels%29%0A%20%20if%20left%20%7B%0A%20%20%20%20local%20%27first%27%20%28at%201%20_np_pixels%29%0A%20%20%20%20for%20i%20%28length%20-%201%29%20%7B%0A%20%20%20%20%20%20atPut%20i%20_np_pixels%20%28at%20%28i%20%2B%201%29%20_np_pixels%29%0A%20%20%20%20%7D%0A%20%20%20%20atPut%20length%20_np_pixels%20first%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27last%27%20%28at%20length%20_np_pixels%29%0A%20%20%20%20for%20i%20%28length%20-%201%29%20%7B%0A%20%20%20%20%20%20atPut%20%28%28length%20-%20i%29%20%2B%201%29%20_np_pixels%20%28at%20%28length%20-%20i%29%20_np_pixels%29%0A%20%20%20%20%7D%0A%20%20%20%20atPut%201%20_np_pixels%20last%0A%20%20%7D%0A%7D%0A%0Ato%20%27_NeoPixel_update%27%20%7B%0A%20%20%27%5Bdisplay%3AneoPixelSend%5D%27%20_np_pixels%0A%20%20waitMicros%20100%0A%7D%0A%0Ato%20clearNeoPixels%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20fillList%20_np_pixels%200%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20colorFromRGB%20r%20g%20b%20%7B%0A%20%20r%20%3D%20%28maximum%200%20%28minimum%20r%20255%29%29%0A%20%20g%20%3D%20%28maximum%200%20%28minimum%20g%20255%29%29%0A%20%20b%20%3D%20%28maximum%200%20%28minimum%20b%20255%29%29%0A%20%20return%20%28%28%28r%20%3C%3C%2016%29%20%7C%20%28g%20%3C%3C%208%29%29%20%7C%20b%29%0A%7D%0A%0Ato%20neoPixelAttach%20number%20pinNumber%20optionalHasWhite%20%7B%0A%20%20hasWhite%20%3D%20false%0A%20%20if%20%28%28pushArgCount%29%20%3E%202%29%20%7B%0A%20%20%20%20hasWhite%20%3D%20optionalHasWhite%0A%20%20%7D%0A%20%20if%20%28or%20%28_np_pixels%20%3D%3D%200%29%20%28number%20%21%3D%20%28size%20_np_pixels%29%29%29%20%7B%0A%20%20%20%20_np_pixels%20%3D%20%28newList%20number%29%0A%20%20%7D%0A%20%20fillList%20_np_pixels%200%0A%20%20%27%5Bdisplay%3AneoPixelSetPin%5D%27%20pinNumber%20hasWhite%0A%7D%0A%0Ato%20neoPixelSetAllToColor%20color%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20fillList%20_np_pixels%20color%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20randomColor%20%7B%0A%20%20local%20%27n1%27%20%28random%20100%20200%29%0A%20%20local%20%27n2%27%20%28random%200%20100%29%0A%20%20if%20%281%20%3D%3D%20%28random%201%203%29%29%20%7B%0A%20%20%20%20return%20%28%28n1%20%3C%3C%2016%29%20%7C%20%28n2%20%3C%3C%208%29%29%0A%20%20%7D%20%281%20%3D%3D%20%28random%201%202%29%29%20%7B%0A%20%20%20%20return%20%28%28n2%20%3C%3C%2016%29%20%7C%20n1%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20%28%28n1%20%3C%3C%208%29%20%7C%20n2%29%0A%20%20%7D%0A%7D%0A%0Ato%20rotateNeoPixelsBy%20n%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20repeat%20%28absoluteValue%20n%29%20%7B%0A%20%20%20%20%27_NeoPixel_rotate%27%20%28n%20%3E%200%29%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0Ato%20setNeoPixelColor%20i%20color%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20if%20%28and%20%281%20%3C%3D%20i%29%20%28i%20%3C%3D%20%28size%20_np_pixels%29%29%29%20%7B%0A%20%20%20%20atPut%20i%20_np_pixels%20color%0A%20%20%20%20%27_NeoPixel_update%27%0A%20%20%7D%0A%7D%0A%0Ato%20setNeoPixelColors10%20c1%20c2%20c3%20c4%20c5%20c6%20c7%20c8%20c9%20c10%20%7B%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%201%29%20%7B%0A%20%20%20%20atPut%201%20_np_pixels%20c1%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%202%29%20%7B%0A%20%20%20%20atPut%202%20_np_pixels%20c2%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%203%29%20%7B%0A%20%20%20%20atPut%203%20_np_pixels%20c3%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%204%29%20%7B%0A%20%20%20%20atPut%204%20_np_pixels%20c4%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%205%29%20%7B%0A%20%20%20%20atPut%205%20_np_pixels%20c5%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%206%29%20%7B%0A%20%20%20%20atPut%206%20_np_pixels%20c6%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%207%29%20%7B%0A%20%20%20%20atPut%207%20_np_pixels%20c7%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%208%29%20%7B%0A%20%20%20%20atPut%208%20_np_pixels%20c8%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%209%29%20%7B%0A%20%20%20%20atPut%209%20_np_pixels%20c9%0A%20%20%7D%0A%20%20if%20%28%28size%20_np_pixels%29%20%3E%3D%2010%29%20%7B%0A%20%20%20%20atPut%2010%20_np_pixels%20c10%0A%20%20%7D%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0A%0Amodule%20%27NeoPixel-Matrix%27%0Aauthor%20wwj718%0Aversion%201%200%20%0Adepends%20NeoPixel%20%0Adescription%20%27%22NeoPixel-Matrix%22%27%0Avariables%20%27_dotPack%20initialized%27%20%0A%0A%09spec%20%27%20%27%20%27_dotPack%20setup%27%20%27_dotPack%20setup%27%0A%09spec%20%27%20%27%20%27clear%27%20%27clear%27%0A%09spec%20%27%20%27%20%27set_background%27%20%27set_background%20_%27%20%27color%27%0A%09spec%20%27%20%27%20%27set_pixel%27%20%27set_pixel%20x%20_%20y%20_%20_%20update%20_%27%20%27auto%20auto%20color%20bool%27%201%201%0A%09spec%20%27%20%27%20%27update%27%20%27update%27%0A%0Ato%20%27_dotPack%20setup%27%20%7B%0A%20%20if%20%28%28v%20%27_dotPack%20initialized%27%29%20%3D%3D%200%29%20%7B%0A%20%20%20%20neoPixelAttach%20256%2012%0A%20%20%20%20%27_dotPack%20initialized%27%20%3D%201%0A%20%20%20%20clearNeoPixels%0A%20%20%7D%0A%7D%0A%0Ato%20clear%20%7B%0A%20%20%27_dotPack%20setup%27%0A%20%20clearNeoPixels%0A%7D%0A%0Ato%20set_background%20color%20%7B%0A%20%20%27_dotPack%20setup%27%0A%20%20neoPixelSetAllToColor%20color%0A%7D%0A%0Ato%20set_pixel%20x%20y%20color%20update%20%7B%0A%20%20%27_dotPack%20setup%27%0A%20%20if%20%28or%20%28x%20%3C%201%29%20%28or%20%28x%20%3E%2016%29%20%28or%20%28y%20%3C%201%29%20%28y%20%3E%2016%29%29%29%29%20%7B%0A%20%20%20%20sayIt%20%271%3C%3D%20x%20%3C%3D%2016%2C%20%201%3C%3D%20y%20%3C%3D16%27%0A%20%20%20%20return%200%0A%20%20%7D%0A%20%20local%20%27num%27%200%0A%20%20if%20%28%28y%20%25%202%29%20%3D%3D%201%29%20%7B%0A%20%20%20%20num%20%3D%20%28x%20%2B%20%28%28y%20-%201%29%20%2A%2016%29%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20num%20%3D%20%28%2817%20-%20x%29%20%2B%20%28%28y%20-%201%29%20%2A%2016%29%29%0A%20%20%7D%0A%20%20comment%20%27custom%20set%20NeoPixel%20color%27%0A%20%20local%20%27i%27%20num%0A%20%20%27_NeoPixel_ensureInitialized%27%0A%20%20if%20%28and%20%281%20%3C%3D%20i%29%20%28i%20%3C%3D%20%28size%20_np_pixels%29%29%29%20%7B%0A%20%20%20%20atPut%20i%20_np_pixels%20color%0A%20%20%7D%0A%20%20if%20update%20%7B%0A%20%20%20%20%27_NeoPixel_update%27%0A%20%20%7D%0A%7D%0A%0Ato%20update%20%7B%0A%20%20%27_dotPack%20setup%27%0A%20%20%27_NeoPixel_update%27%0A%7D%0A%0A)


### 方法 3:dotPack 库

首先打开 dotPack 库

![](/post/img/dotpack-snow-crash5.png)

开始编程:

![](https://wwj718.github.io/post/img/snow_crash.png)

[查看/编辑 程序](https://microblocksfun.cn/run/microblocks.html#project=projectName%20%27snow_crash%27%0A%0Amodule%20main%0Aauthor%20unknown%0Aversion%201%200%20%0Adescription%20%27%27%0A%0A%09spec%20%27%20%27%20%27%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%27%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%0A%0Ato%20%27%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%7B%0A%20%20for%20i%2016%20%7B%0A%20%20%20%20for%20j%2016%20%7B%0A%20%20%20%20%20%20if%20%28%28random%201%202%29%20%3D%3D%201%29%20%7B%0A%20%20%20%20%20%20%20%20setPixel%20i%20j%20%28colorSwatch%20255%20255%20255%20255%29%20false%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20setPixel%20i%20j%20%28colorSwatch%200%200%200%20255%29%20false%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20update%0A%7D%0A%0Ascript%20129%2038%20%7B%0Aforever%20%7B%0A%20%20%27%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%0A%20%20waitMillis%2050%0A%7D%0A%7D%0A%0Ascript%20124%20146%20%7B%0Ato%20%27%E7%94%9F%E6%88%90%E4%B8%80%E5%B8%A7%27%20%7B%7D%0A%7D%0A%0A%0Amodule%20BMP4dotPack%20Output%0Aauthor%20%27Jos%C3%A9%20Garc%C3%ADa%20Yeste%27%0Aversion%201%203%20%0Adescription%20%27Display%20BMP%20files%20on%20a%20dotPack%20screen.%0A%0AFiles%20can%20be%20uploaded%20to%20the%20board%20using%20a%20variety%20of%20tools%2C%20including%20esptool%2C%20the%20Arduino%20IDE%20or%20PlatformIO.%20Search%20the%20web%20for%20%22SPIFFS%20file%20upload%22%20for%20details.%0A%0AIf%20you%20want%20to%20stay%20100%25%20inside%20MicroBlocks%2C%20you%20can%20even%20set%20up%20a%20web%20server%20in%20MicroBlocks%20itself%20and%2C%20for%20example%2C%20send%20the%20file%20to%20the%20board%20with%20a%20multipart%20POST%20request.%0A%0AThis%20library%20works%20with%2016%2C%2024%20and%2032%20bpp%20BMP%20files%0A%27%0A%0A%09spec%20%27%20%27%20%27drawBMPfile%27%20%27display%20BMP%20file%20_%27%20%27auto%27%20%27%27%0A%09spec%20%27r%27%20%27_checkBMP%27%20%27_check%20BMP%20signature%20of%20file%20_%27%20%27auto%27%20%27%27%0A%09spec%20%27%20%27%20%27_drawBMP%20from%27%20%27_draw%20BMP%20of%20file%20_%20width%20_%20height%20_%20bpp%20_%27%20%27auto%20auto%20auto%20auto%27%20%27%27%200%200%2024%0A%09spec%20%27r%27%20%27_readLineBMP%27%20%27_read%20BMPline%20of%20file%20_%20width%20_%20bpp%20_%27%20%27auto%20auto%20auto%27%20%27%27%200%2024%0A%09spec%20%27%20%27%20%27_ignoreBMP%27%20%27_ignore%20_%20bytes%20of%20file%20_%27%20%27auto%20auto%27%200%20%27%27%0A%09spec%20%27r%27%20%27_read%20int16%20of%20BMP%20file%27%20%27_read%20int16%20of%20file%20_%27%20%27auto%27%20%27%27%0A%09spec%20%27r%27%20%27_read%20int32%20of%20BMP%20file%27%20%27_read%20int32%20of%20file%20_%27%20%27auto%27%20%27%27%0A%0Ato%20%27_checkBMP%27%20filename%20%7B%0A%20%20local%20%27signature%27%20%27%27%0A%20%20local%20%27data%27%20%28%27%5Bfile%3AreadBytes%5D%27%202%20filename%29%0A%20%20for%20i%20%28size%20data%29%20%7B%0A%20%20%20%20signature%20%3D%20%28%27%5Bdata%3Ajoin%5D%27%20signature%20%28%27%5Bdata%3AunicodeString%5D%27%20%28at%20i%20data%29%29%29%0A%20%20%7D%0A%20%20return%20%28signature%20%3D%3D%20%27BM%27%29%0A%7D%0A%0Ato%20%27_drawBMP%20from%27%20filename%20width%20height%20bpp%20%7B%0A%20%20local%20%27y%27%20%28height%20-%201%29%0A%20%20repeatUntil%20%28y%20%3C%200%29%20%7B%0A%20%20%20%20local%20%27line%27%20%28%27_readLineBMP%27%20filename%20width%20bpp%29%0A%20%20%20%20for%20x%20%28size%20line%29%20%7B%0A%20%20%20%20%20%20setPixel%20x%20%28y%20%2B%201%29%20%28at%20x%20line%29%20false%0A%20%20%20%20%7D%0A%20%20%20%20y%20%2B%3D%20-1%0A%20%20%7D%0A%20%20update%0A%7D%0A%0Ato%20%27_ignoreBMP%27%20bytes%20filename%20%7B%0A%20%20local%20%27buf%27%200%0A%20%20repeatUntil%20%28bytes%20%3D%3D%200%29%20%7B%0A%20%20%20%20if%20%28bytes%20%3E%20800%29%20%7B%0A%20%20%20%20%20%20buf%20%3D%20%28%27%5Bfile%3AreadBytes%5D%27%20800%20filename%29%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20buf%20%3D%20%28%27%5Bfile%3AreadBytes%5D%27%20bytes%20filename%29%0A%20%20%20%20%7D%0A%20%20%20%20bytes%20%3D%20%28bytes%20-%20%28size%20buf%29%29%0A%20%20%7D%0A%7D%0A%0Ato%20%27_read%20int16%20of%20BMP%20file%27%20filename%20%7B%0A%20%20local%20%27data%27%20%28%27%5Bfile%3AreadBytes%5D%27%202%20filename%29%0A%20%20return%20%28%28%28at%202%20data%29%20%3C%3C%208%29%20%7C%20%28at%201%20data%29%29%0A%7D%0A%0Ato%20%27_read%20int32%20of%20BMP%20file%27%20filename%20%7B%0A%20%20local%20%27data%27%20%28%27%5Bfile%3AreadBytes%5D%27%204%20filename%29%0A%20%20return%20%28%28%28%28at%204%20data%29%20%3C%3C%2024%29%20%7C%20%28%28at%203%20data%29%20%3C%3C%2016%29%29%20%7C%20%28%28%28at%202%20data%29%20%3C%3C%208%29%20%7C%20%28at%201%20data%29%29%29%0A%7D%0A%0Ato%20%27_readLineBMP%27%20filename%20width%20bpp%20%7B%0A%20%20local%20%27result%27%20%28%27%5Bdata%3AmakeList%5D%27%29%0A%20%20local%20%27i%27%20%28width%20%2A%20%28bpp%20%2F%208%29%29%0A%20%20local%20%27data%27%20%28%27%5Bdata%3AnewByteArray%5D%27%200%29%0A%20%20repeatUntil%20%28i%20%3C%3D%200%29%20%7B%0A%20%20%20%20data%20%3D%20%28%27%5Bdata%3Ajoin%5D%27%20data%20%28%27%5Bfile%3AreadBytes%5D%27%20%28minimum%20768%20i%29%20filename%29%29%0A%20%20%20%20i%20%2B%3D%20%280%20-%20%28minimum%20768%20i%29%29%0A%20%20%7D%0A%20%20i%20%3D%201%0A%20%20repeatUntil%20%28i%20%3E%3D%20%28size%20data%29%29%20%7B%0A%20%20%20%20if%20%28bpp%20%3D%3D%2016%29%20%7B%0A%20%20%20%20%20%20%27%5Bdata%3AaddLast%5D%27%20%28%28%28%28%28at%20%28i%20%2B%201%29%20data%29%20%26%20124%29%20%3C%3C%2017%29%20%7C%20%28%28%28%28%28at%20%28i%20%2B%201%29%20data%29%20%26%203%29%20%3C%3C%203%29%20%7C%20%28%28at%20i%20data%29%20%3E%3E%205%29%29%20%3C%3C%2011%29%29%20%7C%20%28%28%28at%20i%20data%29%20%26%2031%29%20%3C%3C%203%29%29%20result%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%27%5Bdata%3AaddLast%5D%27%20%28%28%28%28at%20%28i%20%2B%202%29%20data%29%20%3C%3C%2016%29%20%7C%20%28%28at%20%28i%20%2B%201%29%20data%29%20%3C%3C%208%29%29%20%7C%20%28at%20i%20data%29%29%20result%0A%20%20%20%20%7D%0A%20%20%20%20i%20%2B%3D%20%28bpp%20%2F%208%29%0A%20%20%7D%0A%20%20local%20%27mod4%27%20%28%28size%20data%29%20%25%204%29%0A%20%20if%20%28mod4%20%21%3D%200%29%20%7B%0A%20%20%20%20%27_ignoreBMP%27%20%284%20-%20mod4%29%20filename%0A%20%20%7D%0A%20%20return%20result%0A%7D%0A%0Ato%20drawBMPfile%20filename%20%7B%0A%20%20%27%5Bfile%3Aopen%5D%27%20filename%0A%20%20if%20%28%27_checkBMP%27%20filename%29%20%7B%0A%20%20%20%20%27_ignoreBMP%27%208%20filename%0A%20%20%20%20local%20%27start%27%20%28%27_read%20int32%20of%20BMP%20file%27%20filename%29%0A%20%20%20%20%27_ignoreBMP%27%204%20filename%0A%20%20%20%20local%20%27width%27%20%28%27_read%20int32%20of%20BMP%20file%27%20filename%29%0A%20%20%20%20local%20%27height%27%20%28%27_read%20int32%20of%20BMP%20file%27%20filename%29%0A%20%20%20%20%27_ignoreBMP%27%202%20filename%0A%20%20%20%20local%20%27bpp%27%20%28%27_read%20int16%20of%20BMP%20file%27%20filename%29%0A%20%20%20%20%27_ignoreBMP%27%20%28start%20-%2030%29%20filename%0A%20%20%20%20%27_drawBMP%20from%27%20filename%20width%20height%20bpp%0A%20%20%7D%0A%20%20%27%5Bfile%3Aclose%5D%27%20filename%0A%7D%0A%0A%0Amodule%20dotPack%20Output%0Aauthor%20%27%E8%8B%B1%E8%8D%94%E6%95%99%E8%82%B2%27%0Aversion%201%200%20%0Adepends%20BMP4dotPack%20%0Achoices%20size%20big%20small%20%0Adescription%20%27dotpack%20%28%20Eliteu%20Programable%20led%20matrix%20bag%20%29%27%0Avariables%20_stop_scrolling_text%20%27_dotPack%20initialized%27%20%0A%0A%09spec%20%27%20%27%20%27_displayText%27%20%27_display%20text%20_%20_%20_%20_%20_%20_%27%20%27auto%20auto%20auto%20auto%20auto%20auto%27%20%27hi%27%200%200%2065280%200%201%0A%09spec%20%27%20%27%20%27_dotPackSetup%27%20%27_dotPack%20setup%27%0A%09spec%20%27%20%27%20%27clearDisplay%27%20%27clear%20display%27%0A%09spec%20%27%20%27%20%27setBrightness%27%20%27set%20brightness%20_%27%20%27auto%27%20%2710%27%0A%09spec%20%27%20%27%20%27setPixel%27%20%27set%20pixel%20x%20_%20y%20_%20color%20_%20%3A%20update%20_%27%20%27auto%20auto%20color%20bool%27%201%201%20nil%20true%0A%09spec%20%27%20%27%20%27update%27%20%27update%27%0A%09spec%20%27%20%27%20%27setBackground%27%20%27set%20background%20color%20_%27%20%27color%27%0A%09spec%20%27%20%27%20%27displayChar%27%20%27display%20character%20_%20color%20_%20%3A%20size%20_%27%20%27str%20color%20menu.size%27%20%27A%27%20nil%20%27big%27%0A%09spec%20%27%20%27%20%27dotPackScrollText%27%20%27scroll%20text%20_%20color%20_%20%3A%20pausing%20_%20ms%20size%20_%27%20%27str%20color%20auto%20menu.size%27%20%27hello%27%20nil%20100%20%27big%27%0A%09spec%20%27%20%27%20%27stopScrolling%27%20%27stop%20scrolling%27%0A%09spec%20%27%20%27%20%27drawLine%27%20%27draw%20line%20x0%20_%20y0%20_%20x1%20_%20y1%20_%20color%20_%27%20%27auto%20auto%20auto%20auto%20color%27%201%201%208%208%0A%09spec%20%27%20%27%20%27drawTriangle%27%20%27draw%20triangle%20x0%20_%20y0%20_%20x1%20_%20y1%20_%20x2%20_%20y2%20_%20color%20_%20%3A%20fill%20_%27%20%27auto%20auto%20auto%20auto%20auto%20auto%20color%20bool%27%201%201%208%201%208%208%20nil%20false%0A%09spec%20%27%20%27%20%27drawRect%27%20%27draw%20rectangle%20x0%20_%20y0%20_%20w%20_%20h%20_%20color%20_%20%3A%20fill%20_%27%20%27auto%20auto%20auto%20auto%20color%20bool%27%201%201%208%204%20nil%20false%0A%09spec%20%27%20%27%20%27drawCircle%27%20%27draw%20circle%20x0%20_%20y0%20_%20r%20_%20color%20_%20%3A%20fill%20_%27%20%27auto%20auto%20auto%20color%20bool%27%208%208%204%20nil%20false%0A%09spec%20%27r%27%20%27randomColor%27%20%27random%20color%27%0A%09spec%20%27r%27%20%27color_rgb%27%20%27color%20r%20_%20g%20_%20b%20_%27%20%27auto%20auto%20auto%27%20255%200%200%0A%0Ato%20%27_displayText%27%20text%20x0%20y0%20text_color%20bg_color%20size%20%7B%0A%20%20comment%20%27lock%27%0A%20%20callCustomCommand%20%27%5Bdisplay%3AdotPackDisplay%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%20text%20x0%20y0%20text_color%20bg_color%20size%29%0A%20%20update%0A%7D%0A%0Ato%20%27_dotPackSetup%27%20%7B%0A%20%20if%20%28%28v%20%27_dotPack%20initialized%27%29%20%3D%3D%200%29%20%7B%0A%20%20%20%20%27_dotPack%20initialized%27%20%3D%201%0A%20%20%20%20_stop_scrolling_text%20%3D%20%28booleanConstant%20true%29%0A%20%20%20%20setBrightness%2020%0A%20%20%7D%0A%7D%0A%0Ato%20clearDisplay%20%7B%0A%20%20setBackground%20%28colorSwatch%200%200%200%20255%29%0A%7D%0A%0Ato%20color_rgb%20r%20g%20b%20%7B%0A%20%20comment%20%27%20%28blue%20%3C%3C%2016%29%20%7C%20%28green%20%3C%3C%208%29%20%7C%20red%3B%27%0A%20%20if%20%28or%20%28or%20%28r%20%3C%200%29%20%28r%20%3E%20255%29%29%20%28or%20%28or%20%28g%20%3C%200%29%20%28g%20%3E%20255%29%29%20%28or%20%28b%20%3C%200%29%20%28b%20%3E%20255%29%29%29%29%20%7B%0A%20%20%20%20sayIt%20%27r%2C%20g%2C%20b%20%3A%200-255%27%0A%20%20%20%20return%200%0A%20%20%7D%0A%20%20return%20%28%28%28r%20%3C%3C%2016%29%20%7C%20%28g%20%3C%3C%208%29%29%20%7C%20b%29%0A%7D%0A%0Ato%20displayChar%20s%20color%20size%20%7B%0A%20%20local%20%27x0%27%200%0A%20%20local%20%27y0%27%200%0A%20%20local%20%27bg_color%27%200%0A%20%20if%20%28%28pushArgCount%29%20%3C%203%29%20%7B%0A%20%20%20%20local%20%27_size%27%20%27big%27%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27_size%27%20size%0A%20%20%7D%0A%20%20if%20%28_size%20%3D%3D%20%27big%27%29%20%7B%0A%20%20%20%20x0%20%3D%203%0A%20%20%20%20y0%20%3D%201%0A%20%20%20%20_size%20%3D%202%0A%20%20%7D%0A%20%20if%20%28_size%20%3D%3D%20%27small%27%29%20%7B%0A%20%20%20%20x0%20%3D%205%0A%20%20%20%20y0%20%3D%204%0A%20%20%20%20_size%20%3D%201%0A%20%20%7D%0A%20%20if%20%28%28size%20s%29%20%3D%3D%200%29%20%7B%0A%20%20%20%20comment%20%27clean%27%0A%20%20%20%20clearDisplay%0A%20%20%7D%20else%20%7B%0A%20%20%20%20%27_displayText%27%20%28at%201%20s%29%20x0%20y0%20color%20bg_color%20_size%0A%20%20%7D%0A%7D%0A%0Ato%20dotPackScrollText%20text%20color%20pausing%20size%20%7B%0A%20%20%27_dotPackSetup%27%0A%20%20if%20%28%28pushArgCount%29%20%3C%204%29%20%7B%0A%20%20%20%20local%20%27_pausing%27%20100%0A%20%20%20%20local%20%27_size%27%20%27big%27%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27_pausing%27%20pausing%0A%20%20%20%20local%20%27_size%27%20size%0A%20%20%7D%0A%20%20local%20%27rows%27%2016%0A%20%20local%20%27column%27%2016%0A%20%20local%20%27size_pixels%27%200%0A%20%20local%20%27bg_color%27%200%0A%20%20local%20%27y0%27%200%0A%20%20if%20%28_size%20%3D%3D%20%27small%27%29%20%7B%0A%20%20%20%20_size%20%3D%201%0A%20%20%20%20y0%20%3D%204%0A%20%20%20%20size_pixels%20%3D%20%285%20%2B%201%29%0A%20%20%7D%0A%20%20if%20%28_size%20%3D%3D%20%27big%27%29%20%7B%0A%20%20%20%20_size%20%3D%202%0A%20%20%20%20y0%20%3D%201%0A%20%20%20%20size_pixels%20%3D%20%2810%20%2B%203%29%0A%20%20%7D%0A%20%20local%20%27i%27%20rows%0A%20%20_stop_scrolling_text%20%3D%20%28booleanConstant%20false%29%0A%20%20repeat%20%28%28%28size%20text%29%20%2A%20size_pixels%29%20%2B%20rows%29%20%7B%0A%20%20%20%20if%20%28_stop_scrolling_text%20%3D%3D%20%28booleanConstant%20true%29%29%20%7Breturn%200%7D%0A%20%20%20%20%27_displayText%27%20text%20i%20y0%20color%20bg_color%20_size%0A%20%20%20%20i%20%2B%3D%20-1%0A%20%20%20%20waitMillis%20_pausing%0A%20%20%7D%0A%7D%0A%0Ato%20drawCircle%20x0%20y0%20r%20color%20fill%20%7B%0A%20%20%27_dotPackSetup%27%0A%20%20for%20i%20%28%27%5Bdata%3AmakeList%5D%27%20x0%20y0%29%20%7B%0A%20%20%20%20if%20%28or%20%28i%20%3E%2016%29%20%28i%20%3C%201%29%29%20%7B%0A%20%20%20%20%20%20sayIt%20%27x%2Cy%20%E7%9A%84%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4%E4%B8%BA%201-16%27%0A%20%20%20%20%20%20return%200%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20%28%28pushArgCount%29%20%3C%205%29%20%7B%0A%20%20%20%20local%20%27_fill%27%20%28booleanConstant%20false%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27_fill%27%20fill%0A%20%20%7D%0A%20%20if%20_fill%20%7B%0A%20%20%20%20_fill%20%3D%201%0A%20%20%7D%20else%20%7B%0A%20%20%20%20_fill%20%3D%200%0A%20%20%7D%0A%20%20callCustomCommand%20%27%5Bdisplay%3AdotPackDrawCircle%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%20%28x0%20-%201%29%20%28y0%20-%201%29%20r%20color%20_fill%29%0A%20%20update%0A%7D%0A%0Ato%20drawLine%20x0%20y0%20x1%20y1%20color%20%7B%0A%20%20%27_dotPackSetup%27%0A%20%20for%20i%20%28%27%5Bdata%3AmakeList%5D%27%20x0%20y0%20x1%20y1%29%20%7B%0A%20%20%20%20if%20%28or%20%28i%20%3E%2016%29%20%28i%20%3C%201%29%29%20%7B%0A%20%20%20%20%20%20sayIt%20%27x%2Cy%20%E7%9A%84%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4%E4%B8%BA%201-16%27%0A%20%20%20%20%20%20return%200%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20callCustomCommand%20%27%5Bdisplay%3AdotPackDrawLine%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%20%28x0%20-%201%29%20%28y0%20-%201%29%20%28x1%20-%201%29%20%28y1%20-%201%29%20color%29%0A%20%20update%0A%7D%0A%0Ato%20drawRect%20x0%20y0%20w%20h%20color%20fill%20%7B%0A%20%20%27_dotPackSetup%27%0A%20%20for%20i%20%28%27%5Bdata%3AmakeList%5D%27%20x0%20y0%29%20%7B%0A%20%20%20%20if%20%28or%20%28i%20%3E%2016%29%20%28i%20%3C%201%29%29%20%7B%0A%20%20%20%20%20%20sayIt%20%27x%2Cy%20%E7%9A%84%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4%E4%B8%BA%201-16%27%0A%20%20%20%20%20%20return%200%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20%28%28pushArgCount%29%20%3C%206%29%20%7B%0A%20%20%20%20local%20%27_fill%27%20%28booleanConstant%20false%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27_fill%27%20fill%0A%20%20%7D%0A%20%20if%20_fill%20%7B%0A%20%20%20%20_fill%20%3D%201%0A%20%20%7D%20else%20%7B%0A%20%20%20%20_fill%20%3D%200%0A%20%20%7D%0A%20%20callCustomCommand%20%27%5Bdisplay%3AdotPackDrawRect%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%20%28x0%20-%201%29%20%28y0%20-%201%29%20w%20h%20color%20_fill%29%0A%20%20update%0A%7D%0A%0Ato%20drawTriangle%20x0%20y0%20x1%20y1%20x2%20y2%20color%20fill%20%7B%0A%20%20%27_dotPackSetup%27%0A%20%20for%20i%20%28%27%5Bdata%3AmakeList%5D%27%20x0%20y0%20x1%20y1%20x2%20y2%29%20%7B%0A%20%20%20%20if%20%28or%20%28i%20%3E%2016%29%20%28i%20%3C%201%29%29%20%7B%0A%20%20%20%20%20%20sayIt%20%27x%2Cy%20%E7%9A%84%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4%E4%B8%BA%201-16%27%0A%20%20%20%20%20%20return%200%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20%28%28pushArgCount%29%20%3C%206%29%20%7B%0A%20%20%20%20local%20%27_fill%27%20%28booleanConstant%20false%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27_fill%27%20fill%0A%20%20%7D%0A%20%20if%20_fill%20%7B%0A%20%20%20%20_fill%20%3D%201%0A%20%20%7D%20else%20%7B%0A%20%20%20%20_fill%20%3D%200%0A%20%20%7D%0A%20%20callCustomCommand%20%27%5Bdisplay%3AdotPackDrawTriangle%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%20%28x0%20-%201%29%20%28y0%20-%201%29%20%28x1%20-%201%29%20%28y1%20-%201%29%20%28x2%20-%201%29%20%28y2%20-%201%29%20color%20_fill%29%0A%20%20update%0A%7D%0A%0Ato%20randomColor%20%7B%0A%20%20local%20%27n1%27%20%28random%20100%20200%29%0A%20%20local%20%27n2%27%20%28random%200%20100%29%0A%20%20if%20%281%20%3D%3D%20%28random%201%203%29%29%20%7B%0A%20%20%20%20return%20%28%28n1%20%3C%3C%2016%29%20%7C%20%28n2%20%3C%3C%208%29%29%0A%20%20%7D%20%281%20%3D%3D%20%28random%201%202%29%29%20%7B%0A%20%20%20%20return%20%28%28n2%20%3C%3C%2016%29%20%7C%20n1%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20return%20%28%28n1%20%3C%3C%208%29%20%7C%20n2%29%0A%20%20%7D%0A%7D%0A%0Ato%20setBackground%20color%20%7B%0A%20%20%27_dotPackSetup%27%0A%20%20callCustomCommand%20%27%5Bdisplay%3AdotPackFillScreen%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%20color%29%0A%20%20update%0A%7D%0A%0Ato%20setBrightness%20brightness%20%7B%0A%20%20comment%20%27%E6%89%80%E6%9C%89%E7%81%AF%E6%89%93%E5%BC%80%E5%88%B0%E6%9C%80%E4%BA%AE%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%AF%BC%E8%87%B4%E9%87%8D%E5%90%AF%EF%BC%8C%E8%BF%9E%E6%8E%A5%E6%96%AD%E5%BC%80%0A%0A%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E6%97%B6%E5%80%99%E4%BC%9A%E8%AE%BE%E7%BD%AE%E5%88%9D%E5%A7%8B%E4%BA%AE%E5%BA%A6%EF%BC%8C%E8%A2%ABsetup%E6%8E%89%E7%94%A8%27%0A%20%20if%20%28brightness%20%3E%2020%29%20%7B%0A%20%20%20%20sayIt%20%27%E4%BA%AE%E5%BA%A6%E5%BA%94%E5%BD%93%20%3C%3D%2020%27%0A%20%20%20%20return%200%0A%20%20%7D%0A%20%20callCustomCommand%20%27%5Bdisplay%3AdotPackSetBrightness%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%20brightness%29%0A%20%20update%0A%7D%0A%0Ato%20setPixel%20x%20y%20color%20update%20%7B%0A%20%20%27_dotPackSetup%27%0A%20%20for%20i%20%28%27%5Bdata%3AmakeList%5D%27%20x%20y%29%20%7B%0A%20%20%20%20if%20%28or%20%28i%20%3E%2016%29%20%28i%20%3C%201%29%29%20%7B%0A%20%20%20%20%20%20sayIt%20%27x%2Cy%20%E7%9A%84%E5%8F%96%E5%80%BC%E8%8C%83%E5%9B%B4%E4%B8%BA%201-16%27%0A%20%20%20%20%20%20return%200%0A%20%20%20%20%7D%0A%20%20%7D%0A%20%20if%20%28%28pushArgCount%29%20%3C%204%29%20%7B%0A%20%20%20%20local%20%27_update%27%20%28booleanConstant%20true%29%0A%20%20%7D%20else%20%7B%0A%20%20%20%20local%20%27_update%27%20update%0A%20%20%7D%0A%20%20callCustomCommand%20%27%5Bdisplay%3AdotPackDrawPixel%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%20%28x%20-%201%29%20%28y%20-%201%29%20color%29%0A%20%20if%20_update%20%7B%0A%20%20%20%20update%0A%20%20%7D%0A%7D%0A%0Ato%20stopScrolling%20%7B%0A%20%20_stop_scrolling_text%20%3D%20%28booleanConstant%20true%29%0A%20%20waitMillis%2010%0A%20%20comment%20%27clean%27%0A%7D%0A%0Ato%20update%20%7B%0A%20%20callCustomCommand%20%27%5Bdisplay%3AdotPackShow%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%29%0A%7D%0A%0A)
-->
<h2 id="方法-3-ccarduino">方法 3: C/C++/Arduino</h2>
<p>接下来让我们采用 Arduino 平台制造&quot;雪崩&quot;. 我选择 <a href="https://platformio.org/">PlatformIO</a> 编程环境。</p>
<p>这可能是硬件编程领域最主流的做法。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;Adafruit_GFX.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;Adafruit_NeoMatrix.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;Adafruit_NeoPixel.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#define PackPIN 12
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// https://learn.adafruit.com/adafruit-neopixel-uberguide/neomatrix-library
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Adafruit_NeoMatrix</span> <span class="n">matrix</span> <span class="o">=</span> <span class="n">Adafruit_NeoMatrix</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="n">PackPIN</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                               <span class="n">NEO_MATRIX_TOP</span> <span class="o">+</span> <span class="n">NEO_MATRIX_LEFT</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                                                   <span class="n">NEO_MATRIX_COLUMNS</span> <span class="o">+</span> <span class="n">NEO_MATRIX_ZIGZAG</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                               <span class="n">NEO_GRB</span> <span class="o">+</span> <span class="n">NEO_KHZ800</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// put your setup code here, to run once:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">matrix</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">matrix</span><span class="p">.</span><span class="n">setBrightness</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// put your main code here, to run repeatedly:
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">matrix</span><span class="p">.</span><span class="n">drawPixel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">matrix</span><span class="p">.</span><span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="k">else</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">matrix</span><span class="p">.</span><span class="n">drawPixel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">matrix</span><span class="p">.</span><span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">matrix</span><span class="p">.</span><span class="n">show</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>项目源码已经放到 Github: <a href="https://github.com/wwj718/dotPack-Arduino">dotPack-Arduino</a></p>
<p>如果你选择 Arduino IDE 作为 Arduino 编程环境, 可参考<a href="https://randomnerdtutorials.com/installing-esp32-arduino-ide-2-0/">Installing ESP32 Board in Arduino IDE 2.0</a></p>
<h2 id="方法-4-micropython">方法 4: MicroPython</h2>
<p>在此使用 <a href="https://thonny.org/">Thonny</a> 编辑器。</p>
<p>为了使用 MicroPython 对 dotPack 编程，首先需要往 dotPack 刷入 MicroPython 固件。在 Thonny 编辑器中刷入固件的方法是:</p>
<ul>
<li>打开 <code>运行 &gt; 配置解释器</code></li>
<li>点击右下角的 <code>安装或升级固件</code></li>
<li>下载最新<a href="https://micropython.org/download/esp32/">MicroPython ESP32 固件</a>，并选择它</li>
</ul>
<p><img src="/post/img/dotpack-snow-crash7.png" alt=""></p>
<p>点击安装，等待完成。</p>
<p>之后就可以在 Thonny 里使用 MicroPython 对 dotPack 编程了。</p>
<p><img src="/post/img/dotpack-snow-crash8.png" alt=""></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># https://docs.micropython.org/en/latest/esp32/quickref.html#neopixel-and-apa106-driver</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">machine</span> <span class="kn">import</span> <span class="n">Pin</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">neopixel</span> <span class="kn">import</span> <span class="n">NeoPixel</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pin</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>   <span class="c1"># set GPIO12 to output to drive NeoPixels</span>
</span></span><span class="line"><span class="cl"><span class="n">np</span> <span class="o">=</span> <span class="n">NeoPixel</span><span class="p">(</span><span class="n">pin</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>   <span class="c1"># create NeoPixel driver on GPIO12 for 256 pixels</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">np</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="o">//</span><span class="mi">5</span><span class="p">,</span> <span class="mi">255</span><span class="o">//</span><span class="mi">5</span><span class="p">,</span> <span class="mi">255</span><span class="o">//</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># set the first pixel to white</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">np</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># set the first pixel to black</span>
</span></span><span class="line"><span class="cl">    <span class="n">np</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>              <span class="c1"># write data to all pixels</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>值得注意的是，如果将 LED 开得过亮，过大的功耗会导致 ESP32 停机(出于保护目的)。这行代码用于调整亮度（最大亮度的 1/5）: <code>np[i] = (255//5, 255//5, 255//5)</code></p>
<h2 id="方法-5-microblocks-固件--python-客户端">方法 5: MicroBlocks 固件 + Python 客户端</h2>
<p>首先需要在 MicroBlocks 中往 dotPack 刷入 <a href="https://wwj718.github.io/post/img/dotPack.ubp">MicroBlocks 固件</a> (这个固件的 dotPack 驱动是早期版本，可能已经失效)。在 MicroBlocks 中配置好 WIFI 之后，你可以看到 dotPack 的 IP，之后我们在 Python 客户端中通过这个 IP 连接 dotPack，并对其编程。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">dotpack</span> <span class="kn">import</span> <span class="n">DotPack</span><span class="p">,</span> <span class="n">Animation</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pack</span> <span class="o">=</span> <span class="n">DotPack</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 在 microblocks 里查看 IP</span>
</span></span><span class="line"><span class="cl"><span class="n">address</span> <span class="o">=</span> <span class="s1">&#39;172.20.10.2&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">pack</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="c1"># 输入书包 address 可连接到书包</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 创建动画对象</span>
</span></span><span class="line"><span class="cl"><span class="n">animation</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 生成10张雪崩图像</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 创建一张雪崩图像</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">                <span class="n">pack</span><span class="o">.</span><span class="n">set_pixel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">pack</span><span class="o">.</span><span class="n">set_pixel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 将雪崩图像添加到动画</span>
</span></span><span class="line"><span class="cl">    <span class="n">animation</span><span class="o">.</span><span class="n">add_frame</span><span class="p">(</span><span class="n">pack</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 在 JupyterLab 编辑器中预览动画</span>
</span></span><span class="line"><span class="cl"><span class="n">animation</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 将动画上传到 dotPack (默认开机启动它)</span>
</span></span><span class="line"><span class="cl"><span class="n">animation</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">to_pack</span><span class="o">=</span><span class="n">pack</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="方法-5-官方固件--python-客户端">方法 5: 官方固件 + Python 客户端</h2>
<p>如果你之前将固件刷为了第三方固件(如MicroBlocks/MicroPython)，需要将固件重新刷回官方固件, 方法如下:</p>
<ol>
<li>下载 <a href="https://e-course.oss-cn-shenzhen.aliyuncs.com/%E4%BA%A7%E5%93%81%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3/%E7%A1%AC%E4%BB%B6%E4%BA%A7%E5%93%81%E8%AF%B4%E6%98%8E/Dotpack-V1.36.2023.0605.bin">dotPack-V1.36固件</a></li>
<li>断开 dotPack 与任何编程环境的连接</li>
<li>使用<a href="https://adafruit.github.io/Adafruit_WebSerial_ESPTool/">固件烧录工具</a> 刷入前边下载的固件(按 Program 开始刷入)。</li>
</ol>
<p><img src="/post/img/dotpack-snow-ESPTool.png" alt=""></p>
<p>烧录的过程不要离开当前页面。完成之后断开连接，<strong>重新插拔板子 USB 接口</strong>。</p>
<p>如果一切正常，你应该能够在板子上看到滚动显示的 &ldquo;dotPack&rdquo;。</p>
<p>接下来我们就可以使用 Python 客户端对其进行编程了。</p>
<p>推荐使用 <a href="https://github.com/jupyterlab/jupyterlab-desktop">JupyterLab</a> 作为编程环境。</p>
<p>开始之前，需要先在 JupyterLab 中安装 <a href="https://github.com/longan-link/dotpack_pyclient">dotpack 库</a>: <code>!pip install dotpack</code></p>
<p>为了对 dotPack 进行编程，首先需要知道它的蓝牙地址, 书包里有一个铭牌写了书包地址. 也可以通过以下脚本发现书包的蓝牙地址:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">asyncio</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">bleak</span> <span class="kn">import</span> <span class="n">BleakScanner</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">devices</span> <span class="o">=</span> <span class="k">await</span> <span class="n">BleakScanner</span><span class="o">.</span><span class="n">discover</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">await</span> <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>有了书包地址，就可以开始对它进行编程了(开机3分钟之内允许被发现和连接)。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">dotpack</span> <span class="kn">import</span> <span class="n">DotPack</span><span class="p">,</span> <span class="n">Animation</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pack</span> <span class="o">=</span> <span class="n">DotPack</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 在 microblocks 里查看 IP</span>
</span></span><span class="line"><span class="cl"><span class="n">address</span> <span class="o">=</span> <span class="s1">&#39;B57A50BE-9FD3-1979-9185-770EA27665F6&#39;</span> <span class="c1"># 书包里有一个铭牌写了书包地址</span>
</span></span><span class="line"><span class="cl"><span class="n">pack</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="c1"># 输入书包 address 可连接到书包</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 创建动画对象</span>
</span></span><span class="line"><span class="cl"><span class="n">animation</span> <span class="o">=</span> <span class="n">Animation</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 生成10张雪崩图像</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 创建一张雪崩图像</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]):</span>
</span></span><span class="line"><span class="cl">                <span class="n">pack</span><span class="o">.</span><span class="n">set_pixel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">pack</span><span class="o">.</span><span class="n">set_pixel</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 将雪崩图像添加到动画</span>
</span></span><span class="line"><span class="cl">    <span class="n">animation</span><span class="o">.</span><span class="n">add_frame</span><span class="p">(</span><span class="n">pack</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 在 JupyterLab 编辑器中预览动画</span>
</span></span><span class="line"><span class="cl"><span class="c1"># animation.show()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 将动画上传到 dotPack (默认开机启动它)</span>
</span></span><span class="line"><span class="cl"><span class="n">animation</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">to_pack</span><span class="o">=</span><span class="n">pack</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>由于官方主推使用 Python 对 dotPack 进行编程, dotPack <a href="https://dotpack.fun/">主页</a>和<a href="https://help.dotpack.fun/">文档</a> 对此有更多介绍。</p>
<hr>
<p>todo&hellip;</p>
<h3 id="toit">Toit</h3>
<ul>
<li><a href="https://github.com/toitware/toit-pixel-strip">toit-pixel-strip</a></li>
<li><a href="https://www.electromaker.io/project/view/led-strip-with-ble-device-using-esp32-and-toit">Led Strip With Ble Device Using Esp32 And Toit</a></li>
</ul>
<h3 id="lispulisp">LISP(ulisp)</h3>
<p><a href="http://www.ulisp.com/show?3JJQ">AVR NeoPixel driver using assembler</a></p>
<h3 id="javascript">JavaScript</h3>
<p>我们使用 <a href="https://www.espruino.com/ESP32">espruino ESP32</a>。</p>
<p>下载固件:<a href="https://www.espruino.com/binaries/espruino_2v13_esp32/">espruino_2v13_esp32</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">esptool.py    \
</span></span><span class="line"><span class="cl">        --chip esp32                                \
</span></span><span class="line"><span class="cl">        --port /dev/ttyUSB0                         \
</span></span><span class="line"><span class="cl">        --baud 921600                               \
</span></span><span class="line"><span class="cl">        --after hard_reset write_flash              \
</span></span><span class="line"><span class="cl">        -z                                          \
</span></span><span class="line"><span class="cl">        --flash_mode dio                            \
</span></span><span class="line"><span class="cl">        --flash_freq 40m                            \
</span></span><span class="line"><span class="cl">        --flash_size detect                         \
</span></span><span class="line"><span class="cl">        0x1000 bootloader.bin                       \
</span></span><span class="line"><span class="cl">        0x8000 partitions_espruino.bin              \
</span></span><span class="line"><span class="cl">        0x10000 espruino_esp32.bin
</span></span></code></pre></td></tr></table>
</div>
</div><p>在 <a href="https://www.espruino.com/ide/">espruino IDE</a> 里开始编程.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// todo: espruino 在 ESP32 下 bug 很多 :-(
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">require</span><span class="p">(</span><span class="s2">&#34;neopixel&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="devicescript">DeviceScript</h3>
<p><a href="https://microsoft.github.io/devicescript/intro">DeviceScript</a>: TypeScript for Tiny IoT Devices (ESP32, RP2040, &hellip;)</p>
<h3 id="ruby">Ruby</h3>
<p><a href="https://github.com/mruby-esp32/mruby-esp32">mruby-esp32</a></p>
<h3 id="lua">Lua</h3>
<ul>
<li><a href="https://nodemcu.readthedocs.io/en/release/getting-started/">nodemcu</a></li>
<li><a href="https://nodemcu.readthedocs.io/en/release/modules/ws2812/">ws2812</a></li>
</ul>
<h3 id="forth">Forth</h3>
<p><a href="https://esp32forth.appspot.com/ESP32forth.html">ESP32forth</a></p>
<h3 id="prolog">Prolog</h3>
<p><a href="https://github.com/sammhicks/prolog-esp32">prolog-esp32</a></p>
<h3 id="rust">Rust</h3>
<p><a href="https://github.com/espressif/rust-esp32-example">rust-esp32-example</a></p>
<h3 id="nim">Nim</h3>
<p><a href="https://github.com/elcritch/nesper">nesper</a></p>
<hr>
<p>waiting&hellip;</p>
<h1 id="参考">参考</h1>
<ul>
<li><a href="https://dotpack.fun/">dotPack</a></li>
<li><a href="https://nabucasa.github.io/esp-web-flasher/">esp-web-flasher</a></li>
</ul>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">种瓜</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2022-05-28
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/microblocks/">MicroBlocks</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E7%BC%96%E7%A8%8B/scratch-dotpack-simulator/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Scratch 中的 dotPack 模拟器</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/%E7%BC%96%E7%A8%8B/microblocks-dotpack/">
            <span class="next-text nav-default">MicroBlocks 编程案例: dotPack</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:wuwenjie718@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="mailto:wuwenjie718@gmail.com" class="iconfont icon-out-me" title="out-me"></a>
      <a href="https://github.com/wwj718" class="iconfont icon-github" title="github"></a>
  <a href="http://wwj718.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  
  <span><a target="_blank" href="https://cn.bing.com/search?q=site%3Awwj718.github.io%20%20codelab-adapter">搜索本站</a></span>
  <span class="division">|</span>
  <span><a target="_blank" href="/index.xml">RSS订阅</a></span>
  <span class="division">|</span>
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2013 - 
    2024<span class="heart"><i class="iconfont icon-heart"></i></span><span>种瓜</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="/post/img/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="/post/img/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="/post/img/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js"></script>

<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?18db4b662c04fbd6cc2851d246c51b3f";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>






</body>
</html>
