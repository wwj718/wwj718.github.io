/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/openai@4.47.1/core.mjs
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import*as t from"/post/img/openai-4-47-1/runtime.js";import{APIError as e}from"/post/img/openai-4-47-1/error.js";var r="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},n=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s=!1;function a(){s=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0;e<64;++e)n[e]=t[e],o[t.charCodeAt(e)]=e;o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63}function u(t,e,r){for(var o,i,s=[],a=e;a<r;a+=3)o=(t[a]<<16)+(t[a+1]<<8)+t[a+2],s.push(n[(i=o)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return s.join("")}function f(t){var e;s||a();for(var r=t.length,o=r%3,i="",f=[],h=16383,c=0,l=r-o;c<l;c+=h)f.push(u(t,c,c+h>l?l:c+h));return 1===o?(e=t[r-1],i+=n[e>>2],i+=n[e<<4&63],i+="=="):2===o&&(e=(t[r-2]<<8)+t[r-1],i+=n[e>>10],i+=n[e>>4&63],i+=n[e<<2&63],i+="="),f.push(i),f.join("")}function h(t,e,r,n,o){var i,s,a=8*o-n-1,u=(1<<a)-1,f=u>>1,h=-7,c=r?o-1:0,l=r?-1:1,p=t[e+c];for(c+=l,i=p&(1<<-h)-1,p>>=-h,h+=a;h>0;i=256*i+t[e+c],c+=l,h-=8);for(s=i&(1<<-h)-1,i>>=-h,h+=n;h>0;s=256*s+t[e+c],c+=l,h-=8);if(0===i)i=1-f;else{if(i===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),i-=f}return(p?-1:1)*s*Math.pow(2,i-n)}function c(t,e,r,n,o,i){var s,a,u,f=8*i-o-1,h=(1<<f)-1,c=h>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,d=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+c>=1?l/u:l*Math.pow(2,1-c))*u>=2&&(s++,u/=2),s+c>=h?(a=0,s=h):s+c>=1?(a=(e*u-1)*Math.pow(2,o),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,o),s=0));o>=8;t[r+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,f+=o;f>0;t[r+p]=255&s,p+=d,s/=256,f-=8);t[r+p-d]|=128*y}var l={}.toString,p=Array.isArray||function(t){return"[object Array]"==l.call(t)};function d(){return g.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function y(t,e){if(d()<e)throw new RangeError("Invalid typed array length");return g.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=g.prototype:(null===t&&(t=new g(e)),t.length=e),t}function g(t,e,r){if(!(g.TYPED_ARRAY_SUPPORT||this instanceof g))return new g(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return b(this,t)}return w(this,t,e,r)}function w(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);g.TYPED_ARRAY_SUPPORT?(t=e).__proto__=g.prototype:t=v(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!g.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|A(e,r);t=y(t,n);var o=t.write(e,r);o!==n&&(t=t.slice(0,o));return t}(t,e,r):function(t,e){if(E(e)){var r=0|R(e.length);return 0===(t=y(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?y(t,0):v(t,e);if("Buffer"===e.type&&p(e.data))return v(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function m(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function b(t,e){if(m(e),t=y(t,e<0?0:0|R(e)),!g.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function v(t,e){var r=e.length<0?0:0|R(e.length);t=y(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function R(t){if(t>=d())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d().toString(16)+" bytes");return 0|t}function E(t){return!(null==t||!t._isBuffer)}function A(t,e){if(E(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return K(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(t).length;default:if(n)return K(t).length;e=(""+e).toLowerCase(),n=!0}}function S(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return j(this,e,r);case"utf8":case"utf-8":return B(this,e,r);case"ascii":return N(this,e,r);case"latin1":case"binary":return M(this,e,r);case"base64":return O(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function x(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function P(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=g.from(e,n)),E(e))return 0===e.length?-1:T(t,e,r,n,o);if("number"==typeof e)return e&=255,g.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):T(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function T(t,e,r,n,o){var i,s=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,r/=2}function f(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var h=-1;for(i=r;i<a;i++)if(f(t,i)===f(e,-1===h?0:i-h)){if(-1===h&&(h=i),i-h+1===u)return h*s}else-1!==h&&(i-=i-h),h=-1}else for(r+u>a&&(r=a-u),i=r;i>=0;i--){for(var c=!0,l=0;l<u;l++)if(f(t,i+l)!==f(e,l)){c=!1;break}if(c)return i}return-1}function _(t,e,r,n){r=Number(r)||0;var o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[r+s]=a}return s}function U(t,e,r,n){return Q(K(e,t.length-r),t,r,n)}function C(t,e,r,n){return Q(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function I(t,e,r,n){return C(t,e,r,n)}function L(t,e,r,n){return Q(G(e),t,r,n)}function k(t,e,r,n){return Q(function(t,e){for(var r,n,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,o=r%256,i.push(o),i.push(n);return i}(e,t.length-r),t,r,n)}function O(t,e,r){return 0===e&&r===t.length?f(t):f(t.slice(e,r))}function B(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;o<r;){var i,s,a,u,f=t[o],h=null,c=f>239?4:f>223?3:f>191?2:1;if(o+c<=r)switch(c){case 1:f<128&&(h=f);break;case 2:128==(192&(i=t[o+1]))&&(u=(31&f)<<6|63&i)>127&&(h=u);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(u=(15&f)<<12|(63&i)<<6|63&s)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:i=t[o+1],s=t[o+2],a=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(u=(15&f)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(h=u)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),o+=c}return function(t){var e=t.length;if(e<=D)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=D));return r}(n)}g.TYPED_ARRAY_SUPPORT=void 0===r.TYPED_ARRAY_SUPPORT||r.TYPED_ARRAY_SUPPORT,d(),g.poolSize=8192,g._augment=function(t){return t.__proto__=g.prototype,t},g.from=function(t,e,r){return w(null,t,e,r)},g.TYPED_ARRAY_SUPPORT&&(g.prototype.__proto__=Uint8Array.prototype,g.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&g[Symbol.species]),g.alloc=function(t,e,r){return function(t,e,r,n){return m(e),e<=0?y(t,e):void 0!==r?"string"==typeof n?y(t,e).fill(r,n):y(t,e).fill(r):y(t,e)}(null,t,e,r)},g.allocUnsafe=function(t){return b(null,t)},g.allocUnsafeSlow=function(t){return b(null,t)},g.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Z(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Z(t.slice(0,0))}(t))},g.compare=function(t,e){if(!E(t)||!E(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},g.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(t,e){if(!p(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return g.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=g.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var i=t[r];if(!E(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},g.byteLength=A,g.prototype._isBuffer=!0,g.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)x(this,e,e+1);return this},g.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)x(this,e,e+3),x(this,e+1,e+2);return this},g.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)x(this,e,e+7),x(this,e+1,e+6),x(this,e+2,e+5),x(this,e+3,e+4);return this},g.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?B(this,0,t):S.apply(this,arguments)},g.prototype.equals=function(t){if(!E(t))throw new TypeError("Argument must be a Buffer");return this===t||0===g.compare(this,t)},g.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},g.prototype.compare=function(t,e,r,n,o){if(!E(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0),a=Math.min(i,s),u=this.slice(n,o),f=t.slice(e,r),h=0;h<a;++h)if(u[h]!==f[h]){i=u[h],s=f[h];break}return i<s?-1:s<i?1:0},g.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},g.prototype.indexOf=function(t,e,r){return P(this,t,e,r,!0)},g.prototype.lastIndexOf=function(t,e,r){return P(this,t,e,r,!1)},g.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return _(this,t,e,r);case"utf8":case"utf-8":return U(this,t,e,r);case"ascii":return C(this,t,e,r);case"latin1":case"binary":return I(this,t,e,r);case"base64":return L(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,e,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var D=4096;function N(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}function M(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function j(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=e;i<r;++i)o+=z(t[i]);return o}function $(t,e,r){for(var n=t.slice(e,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function q(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function Y(t,e,r,n,o,i){if(!E(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function X(t,e,r,n){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-r,2);o<i;++o)t[r+o]=(e&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function W(t,e,r,n){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-r,4);o<i;++o)t[r+o]=e>>>8*(n?o:3-o)&255}function F(t,e,r,n,o,i){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function H(t,e,r,n,o){return o||F(t,0,r,4),c(t,e,r,n,23,4),r+4}function V(t,e,r,n,o){return o||F(t,0,r,8),c(t,e,r,n,52,8),r+8}g.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),g.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=g.prototype;else{var o=e-t;r=new g(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+t]}return r},g.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||q(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n},g.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||q(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},g.prototype.readUInt8=function(t,e){return e||q(t,1,this.length),this[t]},g.prototype.readUInt16LE=function(t,e){return e||q(t,2,this.length),this[t]|this[t+1]<<8},g.prototype.readUInt16BE=function(t,e){return e||q(t,2,this.length),this[t]<<8|this[t+1]},g.prototype.readUInt32LE=function(t,e){return e||q(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},g.prototype.readUInt32BE=function(t,e){return e||q(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},g.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||q(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},g.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||q(t,e,this.length);for(var n=e,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},g.prototype.readInt8=function(t,e){return e||q(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},g.prototype.readInt16LE=function(t,e){e||q(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},g.prototype.readInt16BE=function(t,e){e||q(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},g.prototype.readInt32LE=function(t,e){return e||q(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},g.prototype.readInt32BE=function(t,e){return e||q(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},g.prototype.readFloatLE=function(t,e){return e||q(t,4,this.length),h(this,t,!0,23,4)},g.prototype.readFloatBE=function(t,e){return e||q(t,4,this.length),h(this,t,!1,23,4)},g.prototype.readDoubleLE=function(t,e){return e||q(t,8,this.length),h(this,t,!0,52,8)},g.prototype.readDoubleBE=function(t,e){return e||q(t,8,this.length),h(this,t,!1,52,8)},g.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||Y(this,t,e,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[e]=255&t;++i<r&&(o*=256);)this[e+i]=t/o&255;return e+r},g.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||Y(this,t,e,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+r},g.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,1,255,0),g.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},g.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):X(this,t,e,!0),e+2},g.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):X(this,t,e,!1),e+2},g.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):W(this,t,e,!0),e+4},g.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):W(this,t,e,!1),e+4},g.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*r-1);Y(this,t,e,r,o-1,-o)}var i=0,s=1,a=0;for(this[e]=255&t;++i<r&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+r},g.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*r-1);Y(this,t,e,r,o-1,-o)}var i=r-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+r},g.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,1,127,-128),g.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},g.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):X(this,t,e,!0),e+2},g.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):X(this,t,e,!1),e+2},g.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,4,2147483647,-2147483648),g.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):W(this,t,e,!0),e+4},g.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||Y(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),g.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):W(this,t,e,!1),e+4},g.prototype.writeFloatLE=function(t,e,r){return H(this,t,e,!0,r)},g.prototype.writeFloatBE=function(t,e,r){return H(this,t,e,!1,r)},g.prototype.writeDoubleLE=function(t,e,r){return V(this,t,e,!0,r)},g.prototype.writeDoubleBE=function(t,e,r){return V(this,t,e,!1,r)},g.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var o,i=n-r;if(this===t&&r<e&&e<n)for(o=i-1;o>=0;--o)t[o+e]=this[o+r];else if(i<1e3||!g.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},g.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!g.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var s=E(t)?t:K(new g(t,n).toString()),a=s.length;for(i=0;i<r-e;++i)this[i+e]=s[i%a]}return this};var J=/[^+\/0-9A-Za-z-_]/g;function z(t){return t<16?"0"+t.toString(16):t.toString(16)}function K(t,e){var r;e=e||1/0;for(var n=t.length,o=null,i=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function G(t){return function(t){var e,r,n,u,f,h;s||a();var c=t.length;if(c%4>0)throw new Error("Invalid string. Length must be a multiple of 4");f="="===t[c-2]?2:"="===t[c-1]?1:0,h=new i(3*c/4-f),n=f>0?c-4:c;var l=0;for(e=0,r=0;e<n;e+=4,r+=3)u=o[t.charCodeAt(e)]<<18|o[t.charCodeAt(e+1)]<<12|o[t.charCodeAt(e+2)]<<6|o[t.charCodeAt(e+3)],h[l++]=u>>16&255,h[l++]=u>>8&255,h[l++]=255&u;return 2===f?(u=o[t.charCodeAt(e)]<<2|o[t.charCodeAt(e+1)]>>4,h[l++]=255&u):1===f&&(u=o[t.charCodeAt(e)]<<10|o[t.charCodeAt(e+1)]<<4|o[t.charCodeAt(e+2)]>>2,h[l++]=u>>8&255,h[l++]=255&u),h}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(J,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Q(t,e,r,n){for(var o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function Z(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function tt(){throw new Error("setTimeout has not been defined")}function et(){throw new Error("clearTimeout has not been defined")}var rt=tt,nt=et;function ot(t){if(rt===setTimeout)return setTimeout(t,0);if((rt===tt||!rt)&&setTimeout)return rt=setTimeout,setTimeout(t,0);try{return rt(t,0)}catch(e){try{return rt.call(null,t,0)}catch(e){return rt.call(this,t,0)}}}"function"==typeof r.setTimeout&&(rt=setTimeout),"function"==typeof r.clearTimeout&&(nt=clearTimeout);var it,st=[],at=!1,ut=-1;function ft(){at&&it&&(at=!1,it.length?st=it.concat(st):ut=-1,st.length&&ht())}function ht(){if(!at){var t=ot(ft);at=!0;for(var e=st.length;e;){for(it=st,st=[];++ut<e;)it&&it[ut].run();ut=-1,e=st.length}it=null,at=!1,function(t){if(nt===clearTimeout)return clearTimeout(t);if((nt===et||!nt)&&clearTimeout)return nt=clearTimeout,clearTimeout(t);try{return nt(t)}catch(e){try{return nt.call(null,t)}catch(e){return nt.call(this,t)}}}(t)}}function ct(t,e){this.fun=t,this.array=e}ct.prototype.run=function(){this.fun.apply(null,this.array)};function lt(){}var pt=lt,dt=lt,yt=lt,gt=lt,wt=lt,mt=lt,bt=lt;var vt=r.performance||{},Rt=vt.now||vt.mozNow||vt.msNow||vt.oNow||vt.webkitNow||function(){return(new Date).getTime()};var Et=new Date;var At={nextTick:function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];st.push(new ct(t,e)),1!==st.length||at||ot(ht)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:pt,addListener:dt,once:yt,off:gt,removeListener:wt,removeAllListeners:mt,emit:bt,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*Rt.call(vt),r=Math.floor(e),n=Math.floor(e%1*1e9);return t&&(r-=t[0],(n-=t[1])<0&&(r--,n+=1e9)),[r,n]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Et)/1e3}};const St="4.47.1";let xt,Pt,Tt,_t,Ut,Ct,It,Lt,kt=!1;xt||function(t,e={auto:!1}){if(kt)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(xt)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${xt}'\``);kt=e.auto,xt=t.kind,Pt=t.fetch,t.Request,t.Response,t.Headers,Tt=t.FormData,t.Blob,_t=t.File,Ut=t.ReadableStream,Ct=t.getMultipartRequestOptions,It=t.getDefaultAgent,t.fileFromPath,Lt=t.isFsReadStream}(t.getRuntime(),{auto:!0});class Ot extends Error{}class Bt extends Ot{constructor(t,e,r,n){super(`${Bt.makeMessage(t,e,r)}`),this.status=t,this.headers=n,this.request_id=n?.["x-request-id"];const o=e;this.error=o,this.code=o?.code,this.param=o?.param,this.type=o?.type}static makeMessage(t,e,r){const n=e?.message?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):r;return t&&n?`${t} ${n}`:t?`${t} status code (no body)`:n||"(no status code or body)"}static generate(t,e,r,n){if(!t)return new Nt({cause:Le(e)});const o=e?.error;return 400===t?new jt(t,o,r,n):401===t?new $t(t,o,r,n):403===t?new qt(t,o,r,n):404===t?new Yt(t,o,r,n):409===t?new Xt(t,o,r,n):422===t?new Wt(t,o,r,n):429===t?new Ft(t,o,r,n):t>=500?new Ht(t,o,r,n):new Bt(t,o,r,n)}}class Dt extends Bt{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class Nt extends Bt{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,e&&(this.cause=e)}}class Mt extends Nt{constructor({message:t}={}){super({message:t??"Request timed out."})}}class jt extends Bt{constructor(){super(...arguments),this.status=400}}class $t extends Bt{constructor(){super(...arguments),this.status=401}}class qt extends Bt{constructor(){super(...arguments),this.status=403}}class Yt extends Bt{constructor(){super(...arguments),this.status=404}}class Xt extends Bt{constructor(){super(...arguments),this.status=409}}class Wt extends Bt{constructor(){super(...arguments),this.status=422}}class Ft extends Bt{constructor(){super(...arguments),this.status=429}}class Ht extends Bt{}class Vt{constructor(t,e){this.iterator=t,this.controller=e}static fromSSEResponse(t,r){let n=!1;return new Vt((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{for await(const n of async function*(t,e){if(!t.body)throw e.abort(),new Ot("Attempted to iterate over a response with no body");const r=new zt,n=new Kt,o=Gt(t.body);for await(const t of async function*(t){let e=new Uint8Array;for await(const r of t){if(null==r)continue;const t=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?(new TextEncoder).encode(r):r;let n,o=new Uint8Array(e.length+t.length);for(o.set(e),o.set(t,e.length),e=o;-1!==(n=Jt(e));)yield e.slice(0,n),e=e.slice(n)}e.length>0&&(yield e)}(o))for(const e of n.decode(t)){const t=r.decode(e);t&&(yield t)}for(const t of n.flush()){const e=r.decode(t);e&&(yield e)}}(t,r))if(!o)if(n.data.startsWith("[DONE]"))o=!0;else if(null===n.event){let t;try{t=JSON.parse(n.data)}catch(t){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),t}if(t&&t.error)throw new e(void 0,t.error,void 0,void 0);yield t}else{let t;try{t=JSON.parse(n.data)}catch(t){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),t}if("error"==n.event)throw new e(void 0,t.error,t.message,void 0);yield{event:n.event,data:t}}o=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{o||r.abort()}}),r)}static fromReadableStream(t,e){let r=!1;return new Vt((async function*(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let n=!1;try{for await(const e of async function*(){const e=new Kt,r=Gt(t);for await(const t of r)for(const r of e.decode(t))yield r;for(const t of e.flush())yield t}())n||e&&(yield JSON.parse(e));n=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{n||e.abort()}}),e)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],e=[],r=this.iterator(),n=n=>({next:()=>{if(0===n.length){const n=r.next();t.push(n),e.push(n)}return n.shift()}});return[new Vt((()=>n(t)),this.controller),new Vt((()=>n(e)),this.controller)]}toReadableStream(){const t=this;let e;const r=new TextEncoder;return new Ut({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{const{value:n,done:o}=await e.next();if(o)return t.close();const i=r.encode(JSON.stringify(n)+"\n");t.enqueue(i)}catch(e){t.error(e)}},async cancel(){await(e.return?.())}})}}function Jt(t){for(let e=0;e<t.length-2;e++){if(10===t[e]&&10===t[e+1])return e+2;if(13===t[e]&&13===t[e+1])return e+2;if(13===t[e]&&10===t[e+1]&&e+3<t.length&&13===t[e+2]&&10===t[e+3])return e+4}return-1}class zt{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const t={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],t}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,r,n]=function(t,e){const r=t.indexOf(e);if(-1!==r)return[t.substring(0,r),e,t.substring(r+e.length)];return[t,"",""]}(t,":");return n.startsWith(" ")&&(n=n.substring(1)),"event"===e?this.event=n:"data"===e&&this.data.push(n),null}}class Kt{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let e=this.decodeText(t);if(this.trailingCR&&(e="\r"+e,this.trailingCR=!1),e.endsWith("\r")&&(this.trailingCR=!0,e=e.slice(0,-1)),!e)return[];const r=Kt.NEWLINE_CHARS.has(e[e.length-1]||"");let n=e.split(Kt.NEWLINE_REGEXP);return r&&n.pop(),1!==n.length||r?(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),r||(this.buffer=[n.pop()||""]),n):(this.buffer.push(n[0]),[])}decodeText(t){if(null==t)return"";if("string"==typeof t)return t;if(void 0!==g){if(t instanceof g)return t.toString();if(t instanceof Uint8Array)return g.from(t).toString();throw new Ot(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new Ot(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new Ot("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}function Gt(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}Kt.NEWLINE_CHARS=new Set(["\n","\r"]),Kt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const Qt=t=>null!=t&&"object"==typeof t&&"string"==typeof t.url&&"function"==typeof t.blob,Zt=t=>null!=t&&"object"==typeof t&&"string"==typeof t.name&&"number"==typeof t.lastModified&&te(t),te=t=>null!=t&&"object"==typeof t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.text&&"function"==typeof t.slice&&"function"==typeof t.arrayBuffer,ee=t=>Zt(t)||Qt(t)||Lt(t);async function re(t,e,r){if(t=await t,r??(r=Zt(t)?{lastModified:t.lastModified,type:t.type}:{}),Qt(t)){const n=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new _t([n],e,r)}const n=await async function(t){let e=[];if("string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(te(t))e.push(await t.arrayBuffer());else{if(!oe(t))throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${function(t){const e=Object.getOwnPropertyNames(t);return`[${e.map((t=>`"${t}"`)).join(", ")}]`}(t)}`);for await(const r of t)e.push(r)}return e}(t);if(e||(e=function(t){return ne(t.name)||ne(t.filename)||ne(t.path)?.split(/[\\/]/).pop()}(t)??"unknown_file"),!r.type){const t=n[0]?.type;"string"==typeof t&&(r={...r,type:t})}return new _t(n,e,r)}const ne=t=>"string"==typeof t?t:void 0!==g&&t instanceof g?String(t):void 0,oe=t=>null!=t&&"object"==typeof t&&"function"==typeof t[Symbol.asyncIterator],ie=t=>t&&"object"==typeof t&&t.body&&"MultipartBody"===t[Symbol.toStringTag],se=async t=>{if(!fe(t.body))return t;const e=await ue(t.body);return Ct(e,t)},ae=async t=>{const e=await ue(t.body);return Ct(e,t)},ue=async t=>{const e=new Tt;return await Promise.all(Object.entries(t||{}).map((([t,r])=>he(e,t,r)))),e},fe=t=>{if(ee(t))return!0;if(Array.isArray(t))return t.some(fe);if(t&&"object"==typeof t)for(const e in t)if(fe(t[e]))return!0;return!1},he=async(t,e,r)=>{if(void 0!==r){if(null==r)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)t.append(e,String(r));else if(ee(r)){const n=await re(r);t.append(e,n)}else if(Array.isArray(r))await Promise.all(r.map((r=>he(t,e+"[]",r))));else{if("object"!=typeof r)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`);await Promise.all(Object.entries(r).map((([r,n])=>he(t,`${e}[${r}]`,n))))}}};var ce,le=function(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r},pe=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};async function de(t){const{response:e}=t;if(t.options.stream)return We("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Vt.fromSSEResponse(e,t.controller);if(204===e.status)return null;if(t.options.__binaryResponse)return e;const r=e.headers.get("content-type");if(r?.includes("application/json")||r?.includes("application/vnd.api+json")){const t=await e.json();return We("response",e.status,e.url,e.headers,t),t}const n=await e.text();return We("response",e.status,e.url,e.headers,n),n}class ye extends Promise{constructor(t,e=de){super((t=>{t(null)})),this.responsePromise=t,this.parseResponse=e}_thenUnwrap(t){return new ye(this.responsePromise,(async e=>t(await this.parseResponse(e))))}asResponse(){return this.responsePromise.then((t=>t.response))}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class ge{constructor({baseURL:t,maxRetries:e=2,timeout:r=6e5,httpAgent:n,fetch:o}){this.baseURL=t,this.maxRetries=Ie("maxRetries",e),this.timeout=Ie("timeout",r),this.httpAgent=n,this.fetch=o??Pt}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Pe(),...this.authHeaders(t)}}validateHeaders(t,e){}defaultIdempotencyKey(){return`stainless-node-retry-${Fe()}`}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,r){return this.request(Promise.resolve(r).then((r=>({method:t,path:e,...r}))))}getAPIList(t,e,r){return this.requestAPIList(e,{method:"get",path:t,...r})}calculateContentLength(t){if("string"==typeof t){if(void 0!==g)return g.byteLength(t,"utf8").toString();if("undefined"!=typeof TextEncoder){return(new TextEncoder).encode(t).length.toString()}}return null}buildRequest(t){const{method:e,path:r,query:n,headers:o={}}=t,i=ie(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,s=this.calculateContentLength(i),a=this.buildURL(r,n);"timeout"in t&&Ie("timeout",t.timeout);const u=t.timeout??this.timeout,f=t.httpAgent??this.httpAgent??It(a),h=u+1e3;"number"==typeof f?.options?.timeout&&h>(f.options.timeout??0)&&(f.options.timeout=h),this.idempotencyHeader&&"get"!==e&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);return{req:{method:e,...i&&{body:i},headers:this.buildHeaders({options:t,headers:o,contentLength:s}),...f&&{agent:f},signal:t.signal??null},url:a,timeout:u}}buildHeaders({options:t,headers:e,contentLength:r}){const n={};r&&(n["content-length"]=r);return Xe(n,this.defaultHeaders(t)),Xe(n,e),ie(t.body)&&"node"!==xt&&delete n["content-type"],this.validateHeaders(n,e),n}async prepareOptions(t){}async prepareRequest(t,{url:e,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map((t=>[...t]))):{...t}:{}}makeStatusError(t,e,r,n){return Bt.generate(t,e,r,n)}request(t,e=null){return new ye(this.makeRequest(t,e))}async makeRequest(t,e){const r=await t;null==e&&(e=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:n,url:o,timeout:i}=this.buildRequest(r);if(await this.prepareRequest(n,{url:o,options:r}),We("request",o,r,n.headers),r.signal?.aborted)throw new Dt;const s=new AbortController,a=await this.fetchWithTimeout(o,n,i,s).catch(Le);if(a instanceof Error){if(r.signal?.aborted)throw new Dt;if(e)return this.retryRequest(r,e);if("AbortError"===a.name)throw new Mt;throw new Nt({cause:a})}const u=be(a.headers);if(!a.ok){if(e&&this.shouldRetry(a)){return We(`response (error; ${`retrying, ${e} attempts remaining`})`,a.status,o,u),this.retryRequest(r,e,u)}const t=await a.text().catch((t=>Le(t).message)),n=Te(t),i=n?void 0:t;We(`response (error; ${e?"(error; no more retries left)":"(error; not retryable)"})`,a.status,o,u,i);throw this.makeStatusError(a.status,n,i,u)}return{response:a,options:r,controller:s}}requestAPIList(t,e){const r=this.makeRequest(e,null);return new me(this,r,t)}buildURL(t,e){const r=Ue(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),n=this.defaultQuery();return qe(n)||(e={...n,...e}),"object"==typeof e&&e&&!Array.isArray(e)&&(r.search=this.stringifyQuery(e)),r.toString()}stringifyQuery(t){return Object.entries(t).filter((([t,e])=>void 0!==e)).map((([t,e])=>{if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return`${encodeURIComponent(t)}=${encodeURIComponent(e)}`;if(null===e)return`${encodeURIComponent(t)}=`;throw new Ot(`Cannot stringify type ${typeof e}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(t,e,r,n){const{signal:o,...i}=e||{};o&&o.addEventListener("abort",(()=>n.abort()));const s=setTimeout((()=>n.abort()),r);return this.getRequestClient().fetch.call(void 0,t,{signal:n.signal,...i}).finally((()=>{clearTimeout(s)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const e=t.headers.get("x-should-retry");return"true"===e||"false"!==e&&(408===t.status||(409===t.status||(429===t.status||t.status>=500)))}async retryRequest(t,e,r){let n;const o=r?.["retry-after-ms"];if(o){const t=parseFloat(o);Number.isNaN(t)||(n=t)}const i=r?.["retry-after"];if(i&&!n){const t=parseFloat(i);n=Number.isNaN(t)?Date.parse(i)-Date.now():1e3*t}if(!(n&&0<=n&&n<6e4)){const r=t.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(e,r)}return await Ce(n),this.makeRequest(t,e-1)}calculateDefaultRetryTimeoutMillis(t,e){const r=e-t;return Math.min(.5*Math.pow(2,r),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${St}`}}class we{constructor(t,e,r,n){ce.set(this,void 0),le(this,ce,t,"f"),this.options=n,this.response=e,this.body=r}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new Ot("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const e={...this.options};if("params"in t&&"object"==typeof e.query)e.query={...e.query,...t.params};else if("url"in t){const r=[...Object.entries(e.query||{}),...t.url.searchParams.entries()];for(const[e,n]of r)t.url.searchParams.set(e,n);e.query=void 0,e.path=t.url.toString()}return await pe(this,ce,"f").requestAPIList(this.constructor,e)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(ce=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const e of t.getPaginatedItems())yield e}}class me extends ye{constructor(t,e,r){super(e,(async e=>new r(t,e.response,await de(e),e.options)))}async*[Symbol.asyncIterator](){const t=await(this);for await(const e of t)yield e}}const be=t=>new Proxy(Object.fromEntries(t.entries()),{get(t,e){const r=e.toString();return t[r.toLowerCase()]||t[r]}}),ve={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryResponse:!0,__streamClass:!0},Re=t=>"object"==typeof t&&null!==t&&!qe(t)&&Object.keys(t).every((t=>Ye(ve,t))),Ee=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":Se(Deno.build.os),"X-Stainless-Arch":Ae(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":At.version};if("[object process]"===Object.prototype.toString.call(void 0!==At?At:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":Se(At.platform),"X-Stainless-Arch":Ae(At.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":At.version};const t=function(){if("undefined"==typeof navigator||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const t=r.exec(navigator.userAgent);if(t){return{browser:e,version:`${t[1]||0}.${t[2]||0}.${t[3]||0}`}}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":St,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const Ae=t=>"x32"===t?"x32":"x86_64"===t||"x64"===t?"x64":"arm"===t?"arm":"aarch64"===t||"arm64"===t?"arm64":t?`other:${t}`:"unknown",Se=t=>(t=t.toLowerCase()).includes("ios")?"iOS":"android"===t?"Android":"darwin"===t?"MacOS":"win32"===t?"Windows":"freebsd"===t?"FreeBSD":"openbsd"===t?"OpenBSD":"linux"===t?"Linux":t?`Other:${t}`:"Unknown";let xe;const Pe=()=>xe??(xe=Ee()),Te=t=>{try{return JSON.parse(t)}catch(t){return}},_e=new RegExp("^(?:[a-z]+:)?//","i"),Ue=t=>_e.test(t),Ce=t=>new Promise((e=>setTimeout(e,t))),Ie=(t,e)=>{if("number"!=typeof e||!Number.isInteger(e))throw new Ot(`${t} must be an integer`);if(e<0)throw new Ot(`${t} must be a positive integer`);return e},Le=t=>t instanceof Error?t:new Error(t),ke=t=>{if(null==t)throw new Ot(`Expected a value to be given but received ${t} instead.`);return t},Oe=t=>void 0!==At?At.env?.[t]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(t)?.trim():void 0,Be=t=>{if("number"==typeof t)return Math.round(t);if("string"==typeof t)return parseInt(t,10);throw new Ot(`Could not coerce ${t} (type: ${typeof t}) into a number`)},De=t=>{if("number"==typeof t)return t;if("string"==typeof t)return parseFloat(t);throw new Ot(`Could not coerce ${t} (type: ${typeof t}) into a number`)},Ne=t=>"boolean"==typeof t?t:"string"==typeof t?"true"===t:Boolean(t),Me=t=>{if(void 0!==t)return Be(t)},je=t=>{if(void 0!==t)return De(t)},$e=t=>{if(void 0!==t)return Ne(t)};function qe(t){if(!t)return!0;for(const e in t)return!1;return!0}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Xe(t,e){for(const r in e){if(!Ye(e,r))continue;const n=r.toLowerCase();if(!n)continue;const o=e[r];null===o?delete t[n]:void 0!==o&&(t[n]=o)}}function We(t,...e){void 0!==At&&"true"===At?.env?.DEBUG&&console.log(`OpenAI:DEBUG:${t}`,...e)}const Fe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),He=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator,Ve=t=>"function"==typeof t?.get,Je=(t,e)=>{const r=e.toLowerCase();if(Ve(t)){const n=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,((t,e,r)=>e+r.toUpperCase()));for(const o of[e,r,e.toUpperCase(),n]){const e=t.get(o);if(e)return e}}for(const[n,o]of Object.entries(t))if(n.toLowerCase()===r)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${e} header, using the first entry.`),o[0]):o;throw new Error(`Could not find ${e} header`)},ze=t=>{if(!t)return"";if(void 0!==g)return g.from(t).toString("base64");if("undefined"!=typeof btoa)return btoa(t);throw new Ot("Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined")};function Ke(t){return null!=t&&"object"==typeof t&&!Array.isArray(t)}export{ge as APIClient,ye as APIPromise,we as AbstractPage,me as PagePromise,Le as castToError,Ne as coerceBoolean,De as coerceFloat,Be as coerceInteger,ue as createForm,be as createResponseHeaders,We as debug,ke as ensurePresent,Je as getRequiredHeader,Ye as hasOwn,qe as isEmptyObj,Ve as isHeadersProtocol,Ke as isObj,Re as isRequestOptions,He as isRunningInBrowser,$e as maybeCoerceBoolean,je as maybeCoerceFloat,Me as maybeCoerceInteger,se as maybeMultipartFormRequestOptions,ae as multipartFormRequestOptions,Oe as readEnv,Te as safeJSON,Ce as sleep,ze as toBase64};export default null;
//# sourceMappingURL=/sm/49e084785b35097bf83069e980bc4dcc58906b0901a2a791a9e73f29229a8acc.map